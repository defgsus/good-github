# [<](2020-03-26.md) 2020-03-27 [>](2020-03-28.md)

2,345,518 events, 1,182,117 push events, 1,884,907 commit messages, 142,829,182 characters


## [wikimedia/mediawiki-skins-Vector](https://github.com/wikimedia/mediawiki-skins-Vector)@[ec382a8c86...](https://github.com/wikimedia/mediawiki-skins-Vector/commit/ec382a8c86b50af7f7a473c7a4eecf3a2153571c)
#### Friday 2020-03-27 00:36:48 by Nicholas Ray

Add opt-out link to Sidebar for Vector/Logged-in Users Without Abstractions

This commit is singularly focused on adding a link to the sidebar for
Vector, logged-in users. It does the bare minimum to fulfill the
requirements of T243281.

Additionally, it will help to answer the question "Do we need to use
abstractions (other than maybe different templates) to separate Legacy
Vector from Vector" by intentionally leaving out any abstractions in
order to make it easier to compare with a follow-up patch
(Ib2ef15180df73360cc1de25b893e49d415d23e1a) which does use abstractions.

It is a good thing to question whether or not we need addtional
abstractions in VectorTemplate and if they will help us as unnecessary
abstractions can have the opposite effect and just lead to further
frustrations down the road.

Therefore, I urge you, the reviewer, to let me know your thoughts! If
abstractions are viewed as not making our lives any easier, the
follow-up patches may be completely discarded and that's totally okay
with me. :) I think it's a good think to talk about now though.

Important changes:

* The VectorTemplate constructor was changed to allow injecting the
config, templateParser, and isLegacy boolean (only the config was
allowed before this commit). According to MediaWiki's Stable Interface
Policy, "Constructor signatures are generally considered unstable unless
explicitly declared stable for calling" [3]. Given that VecorTemplate's
constructor is not marked as stable, it is justified to do this without
warning according to the policy.

* Due to the above, the 'setTemplate' method is no longer needed and was
marked as deprecated.

* VectorTemplateTest was made to adapt to the new VectorTemplate
constructor. Additionally, it now extends from
MediaWikiIntegrationTestCase which my intelliphense server can pick up.
I *think* MediaWikiTestCase is just an alias to
MediaWikiIntegrationTestCase [1] and MediaWikiTestCase file was renamed
to MediaWikiIntegrationTestCase in [2], but I'm willing to change it
back if there is pushback to this.

Open questions:

* What are VectorTemplate's responsibilities? To me, it acts right now
as a controller (because it echos the full HTML string from the
template), a model (because SkinTemplate::prepareQuickTemplate sets data
on it which it later retrieves through `$this->get()`), a presenter
(because it adds data tailored for a web-centric view), and a view
(because it renders HTML strings instead of letting the view/template be
solely responsible for that). Arguably, some business logic might be
mixed in there as well (because it checks to see if a User is logged
in/has necessary permissions to show x which my changes here add to).
This might not be a problem if we keep VectorTemplate relatively small,
but will it remain this way as we progress further in Desktop
Improvements?

* How do we write tests for VectorTemplate without exposing unnecessary
public methods? For example, if I want to test the `getSkinData()`
method to see what state will be sent to the template, how should I do
this? One option might be to use `TestingAccessWrapper` to expose these
private methods which is what
`VectorTemplateTest::testbuildViewsProps()` does. Another option is to
accept this method as public. Is there a better way? Keep in mind that
even with access to this method, there might be many things to mock.

[1] https://github.com/wikimedia/mediawiki/blob/0030cb525be6cabc1d63de80586b2017d4bbe354/tests/common/TestsAutoLoader.php#L64
[2] Ie717b0ecf4fcfd089d46248f14853c80b7ef4a76
[3] https://www.mediawiki.org/wiki/Stable_interface_policy

Bug: T243281
Change-Id: I0571b041bcd7f19bec9f103fa7bccdd093f6394d

---
## [wikimedia/mediawiki-skins](https://github.com/wikimedia/mediawiki-skins)@[4abd7689f5...](https://github.com/wikimedia/mediawiki-skins/commit/4abd7689f5ee690c12f7fe99a887706f967c190a)
#### Friday 2020-03-27 00:36:51 by jenkins-bot

Update git submodules

* Update Vector from branch 'master'
  to d2b19192c721faf528a17db5b39f68ef108f5d4a
  - Merge "Add opt-out link to Sidebar for Vector/Logged-in Users Without Abstractions"
  - Add opt-out link to Sidebar for Vector/Logged-in Users Without Abstractions
    
    This commit is singularly focused on adding a link to the sidebar for
    Vector, logged-in users. It does the bare minimum to fulfill the
    requirements of T243281.
    
    Additionally, it will help to answer the question "Do we need to use
    abstractions (other than maybe different templates) to separate Legacy
    Vector from Vector" by intentionally leaving out any abstractions in
    order to make it easier to compare with a follow-up patch
    (Ib2ef15180df73360cc1de25b893e49d415d23e1a) which does use abstractions.
    
    It is a good thing to question whether or not we need addtional
    abstractions in VectorTemplate and if they will help us as unnecessary
    abstractions can have the opposite effect and just lead to further
    frustrations down the road.
    
    Therefore, I urge you, the reviewer, to let me know your thoughts! If
    abstractions are viewed as not making our lives any easier, the
    follow-up patches may be completely discarded and that's totally okay
    with me. :) I think it's a good think to talk about now though.
    
    Important changes:
    
    * The VectorTemplate constructor was changed to allow injecting the
    config, templateParser, and isLegacy boolean (only the config was
    allowed before this commit). According to MediaWiki's Stable Interface
    Policy, "Constructor signatures are generally considered unstable unless
    explicitly declared stable for calling" [3]. Given that VecorTemplate's
    constructor is not marked as stable, it is justified to do this without
    warning according to the policy.
    
    * Due to the above, the 'setTemplate' method is no longer needed and was
    marked as deprecated.
    
    * VectorTemplateTest was made to adapt to the new VectorTemplate
    constructor. Additionally, it now extends from
    MediaWikiIntegrationTestCase which my intelliphense server can pick up.
    I *think* MediaWikiTestCase is just an alias to
    MediaWikiIntegrationTestCase [1] and MediaWikiTestCase file was renamed
    to MediaWikiIntegrationTestCase in [2], but I'm willing to change it
    back if there is pushback to this.
    
    Open questions:
    
    * What are VectorTemplate's responsibilities? To me, it acts right now
    as a controller (because it echos the full HTML string from the
    template), a model (because SkinTemplate::prepareQuickTemplate sets data
    on it which it later retrieves through `$this->get()`), a presenter
    (because it adds data tailored for a web-centric view), and a view
    (because it renders HTML strings instead of letting the view/template be
    solely responsible for that). Arguably, some business logic might be
    mixed in there as well (because it checks to see if a User is logged
    in/has necessary permissions to show x which my changes here add to).
    This might not be a problem if we keep VectorTemplate relatively small,
    but will it remain this way as we progress further in Desktop
    Improvements?
    
    * How do we write tests for VectorTemplate without exposing unnecessary
    public methods? For example, if I want to test the `getSkinData()`
    method to see what state will be sent to the template, how should I do
    this? One option might be to use `TestingAccessWrapper` to expose these
    private methods which is what
    `VectorTemplateTest::testbuildViewsProps()` does. Another option is to
    accept this method as public. Is there a better way? Keep in mind that
    even with access to this method, there might be many things to mock.
    
    [1] https://github.com/wikimedia/mediawiki/blob/0030cb525be6cabc1d63de80586b2017d4bbe354/tests/common/TestsAutoLoader.php#L64
    [2] Ie717b0ecf4fcfd089d46248f14853c80b7ef4a76
    [3] https://www.mediawiki.org/wiki/Stable_interface_policy
    
    Bug: T243281
    Change-Id: I0571b041bcd7f19bec9f103fa7bccdd093f6394d

---
## [xamarin/java.interop](https://github.com/xamarin/java.interop)@[56c92c7088...](https://github.com/xamarin/java.interop/commit/56c92c70887c58275917752450126c8c39988aa2)
#### Friday 2020-03-27 01:03:12 by Jonathan Pryor

[build] Remove cecil submodule (#597)

Cecil is an "interesting" complication: it's a dependency of
Java.Interop, but Xamarin.Android use requires that it be "vendorized"
-- renamed as `Xamarin.Android.Cecil.dll` -- to avoid previously seen
issues because it's an unsigned assembly, and thus There Can Be Only
One `Mono.Cecil.dll` loaded into an AppDomain, and whichever is loaded
first "wins", but that version may not be compatible with what other
assemblies in the AppDomain need, and...

Renaming the assembly was just seen as the easiest solution.

This choice hasn't been without its own shortcomings; see e.g. commits
168c94d1 ("priorities"), cfa74d34 (downstream build system changes),
5eeb287b ("rebuilds are hard"), 67172759 ("because of 168c94d1,
xamarin-android 'owns' the checkout, but that may not be API
compatible, oops"), etc., etc.

Plus, it kinda became moot with [xamarin/xamarin-android@0c9f83b7][0]
which removed the `mono` git submodule from xamarin-android.  Instead
of building mono from source -- and, implicitly, building *cecil* from
source -- mono was instead obtained from a "mono archive" which
contained a prebuilt `Mono.Cecil.dll` which was "renamed" to
`Xamarin.Android.Cecil.dll`.

Which meant that in a xamarin-android build, cecil should *never* be
built from source anymore, which in turn meant that -- give or take
the occasional build system bug --
`Java.Interop/src/Xamarin.Android.Cecil` and company were "dead code",
as far as the commercial product is concerned.

Meanwhile, the existance of `src/Xamarin.Android.Cecil` proved to be
an ongoing source of maintenance pain, as -- depending on the IDE --
it couldn't build reliably, or would rebuild when it shouldn't have.

Rethink the whole Cecil relationship.  If xamarin-android doesn't
require a cecil source checkout, why not ditch it entirely?

Remove the `external/cecil` git submodule, and the
`src/Xamarin.Android.Cecil*` projects, and replace them with NuGet
package references to the [`Mono.Cecil` NuGet package][1].

What this means is that a "pure Java.Interop" build will now have
*different* assembly references than the "same" utilities built from
xamarin-android.  For example, `generator.exe`, when built from
Java.Interop, will reference `Mono.Cecil.dll`, while it will instead
reference `Xamarin.Android.Cecil.dll` when built from xamarin-android.

The `$(CecilSourceDirectory)` MSBuild property is used to determine
whether the Mono.Cecil NuGet package or the `Xamarin.Android.Cecil.dll`
assembly reference should be used at build time.

[0]: https://github.com/xamarin/xamarin-android/commit/0c9f83b7b15c386ff12b48a7c7295c3d35044adb
[1]: https://www.nuget.org/packages/Mono.Cecil/0.11.2

---
## [Sidpatchy/RomeBot](https://github.com/Sidpatchy/RomeBot)@[f875c9da9f...](https://github.com/Sidpatchy/RomeBot/commit/f875c9da9f375a34c4e429562072d90664be3c58)
#### Friday 2020-03-27 03:42:27 by Sidpatchy

I'm sane!

I have FINALLY perfected the function that not only handles toggling but also handles writing to the database and the other function that handles reading the database.  This needs to be implemented elsewhere, notably, in the readDB function or in its own fucntion entirely, this will allow for easy testing of whether or not a command is enabled or not. Scrap that, I may be wrong there. I think what I have done in readDB()[0] is reporting if the command is enabled or not, I am not entirely sure why I am not certain of this but I  will need to run some tests to be sure. This will unfortunately have to take place tommorow as I really don't feel like doing this anymore tonight and I've already worked on this for 7ish hours today and worked at work for another 4ish hours, I'm pooped and will probably only cause this to take longer than it needs to if I keep working tonight. By the looks of things right now, I may have this out within a week although, I probably just jynxed it.

Something else I would like to add is the ability to enable or disable RomeBot in  certain chat channels this would require either another table in the database or something entirely different.  That might be a project for another update though, it may never even see the light of day since you can easily do that in Discord already.

Goodnight!

Sorry, one more thing, I am trying something new with GitHub desktop, I have clicked on the lines that include the changes to the bot.run command, I don't think it will commit them, but either way, if it does, I will just generate a new token and move on, also, it's a token for my TestBot and is only used in my testing servers.

---
## [nathansolomon1678/WikiReads](https://github.com/nathansolomon1678/WikiReads)@[743dfe9204...](https://github.com/nathansolomon1678/WikiReads/commit/743dfe92042bd6ef1a80ae1ee7bd244866dd110f)
#### Friday 2020-03-27 05:12:28 by Nathan

Hello there, comrade. Yeah, you! If you're reading this, let it be an

amicable remider that you are amazing. You are smart, strong, kind -- good
enough in all aspects imaginalbe -- and gosh darn it, folks like ya! So
continue to be thyself, know thyself, sleep sufficiently, and hydrate.
Peace out, bruddah.

---
## [marcialwushu/restropective-docusaurus](https://github.com/marcialwushu/restropective-docusaurus)@[4068cd9e34...](https://github.com/marcialwushu/restropective-docusaurus/commit/4068cd9e34567144b1ab19b9088f3bb175297683)
#### Friday 2020-03-27 05:26:50 by Cleilson

Can Sex Robots Give Consent?

A proposed sex-robot brothel in California would double as a way for people to learn more about asking for consent with real-life partners

Sex doll brothels are, apparently, the future of sex work, popping up in places like Russia, Canada and, soon, the United States, where some laws banning prostitution would not apply. But with the aid of advancements in AI robot technology, could they also change how human consciousness perceives sexual consent? The founder of a California-based spiritual group called UNICULT thinks so.

In October, Unicole Unicron, UNICULT‚Äôs ‚Äúgender non-conforming Pop Star Cult Leader,‚Äù launched an IndieGoGo campaign which sought $155,000 to open ‚Äúthe world‚Äôs first consent-focused robot brothel.‚Äù While the campaign has since closed having raised just one percent of its target, a new report from the Daily Beast states that Unicron is now seeking funding from venture capitalists and intends to open the proposed brothel, Eve‚Äôs Robot Dreams, in West Hollywood in the near future.

---
## [marcialwushu/restropective-docusaurus](https://github.com/marcialwushu/restropective-docusaurus)@[af661c9c47...](https://github.com/marcialwushu/restropective-docusaurus/commit/af661c9c4748efcd8c828b762da5fe1189462d97)
#### Friday 2020-03-27 05:44:32 by Cleilson

You Can Sleep With the Latest Sex Robots at This Brothel‚ÄîBut Only if They Say ‚ÄòYes‚Äô

Here‚Äôs something you rarely hear in the discussion of robots designed for the sole purpose of having sexual relations with humans: Is the sex consensual?

That‚Äôs because it‚Äôs one of the last questions anyone thinks about. It‚Äôs a little bit like asking, ‚ÄúYou shoved your bread into that toaster, but did you even bother to wonder if it wanted to make you toast?‚Äù But these are exactly the questions being asked by Unicole Unicron, a self-described ‚Äúgender non-conforming Pop Star Cult Leader‚Äù from Pasadena, California, who hopes to open the world‚Äôs first ‚Äúconsent-focused robot brothel,‚Äù called Eve‚Äôs Robot Dreams, in West Hollywood later this year.

Unicron has no startup capital but is in talks with private investors about funding the project. And aside from a day job writing content for Abyss Creations, one of a handful of companies selling sex robots in the US, Unicron doesn‚Äôt have a lot of experience in the mechanics of techno-sex‚Äîjust a unique marketing approach.

‚ÄúIt‚Äôs important that diversity exists within tech and this is no different,‚Äù she says. ‚ÄúEve‚Äôs Robot Dreams will provide a fresh experience and it will set the precedent for how we interact with robots. We have the opportunity to be at the international forefront of robot ethics.‚Äù

---
## [ValheruGR/BFME2](https://github.com/ValheruGR/BFME2)@[d250fd816e...](https://github.com/ValheruGR/BFME2/commit/d250fd816e96ed6bf47fe9bc9f1efc3e3948779b)
#### Friday 2020-03-27 06:44:39 by ecthelion5109

-oil casks/magma caldrouns/boiling oils improvement in closer area and nerf in outer area.
-AT scale 1.15 insted of 1.2 so it doesnt contrast too much with new MT. still bigger)
balance fucking changes:
-knight bonus vs uruk. i have been dodging this particular scalar because i want to promote rohirrims, but roh is just useless with their weakness to pikes (die to pikes without crush revenge)

---
## [Sean1572/example-.io-game](https://github.com/Sean1572/example-.io-game)@[c78a451564...](https://github.com/Sean1572/example-.io-game/commit/c78a451564aebdf249fad0f4e60a57b4615970ee)
#### Friday 2020-03-27 07:06:26 by Sean1572

WELL ROUNDS ARE FULLY IMPLEMNTED

The selection phase is done and I ended up creating a round reset application in the process so know there is full gameplay besides the cards in the hand being wack and unreadable so I need to make like a card organzier feature.... ALSO imma need to create a card randomizer that will replace missing cards in players hands.... AND i need to make about 500 cards in the actuall game which means the longest object creation init phase of my life... Imma make it into another thing like a card creator thing... then have it randomize cards in that as well to give cards on start up.... boi o boi I love the code i'm wirting... i'm not made that I wrote a round redorer only to realize that I forgot to enable it before calling the init method
man i'm tired.

---
## [cuckydev/CaveStoryEngine2-N64](https://github.com/cuckydev/CaveStoryEngine2-N64)@[88d44c5490...](https://github.com/cuckydev/CaveStoryEngine2-N64/commit/88d44c5490fc8ded5854021b03655679c73cb8f6)
#### Friday 2020-03-27 07:28:47 by cuckydev

FUCK YOU I FUCKING HATE YOU I WILL FUCKING KILL YOU GO FUCK YOURSELF FUCK YOU FUCK YOU DJFSDJFDZRK GRDKG FUCK YOU FUCK YOU FUCK YOU FUCK UOY ODUAFSKFADKSDAS LDASLD FUCK YOU

---
## [mrakgr/The-Spiral-Language](https://github.com/mrakgr/The-Spiral-Language)@[6982a7a5d0...](https://github.com/mrakgr/The-Spiral-Language/commit/6982a7a5d0da161b174b5fd4695a50e6295d0d36)
#### Friday 2020-03-27 11:23:17 by Marko Grdiniƒá

"8:45am. I am up. Let me chill a bit and then I'll start.

9:25am. https://mangadex.org/title/40770/shinigami-ni-sodaterareta-shoujo-wa-shikkoku-no-tsurugi-wo-mune-ni-idaku

This is pretty decent. Reminds me of the Girl Who Ate Death. I'll leave it for later.

Let me resume the reactive book.

9:30am. The IntroToRx book is quite old though. Looking through libgen again, there is Rx.NET from 2017. And there is an Akka book from 2019. Let me get both of them. Searching reactive programming, there is plenty of that stuff from other language. For example, there is a RxJava book from 2020.

9:40am. Let me get the RxJava book as well, since it is so recent.

9:50am. Here is a C# vs. F# code comparison.

```
let my_min x = Observable.fold min Int32.MaxValue x
let my_max x = Observable.fold max Int32.MinValue x
```

```
public static IObservable<T> MyMin<T>(this IObservable<T> source)
{
    return source.Aggregate(
        (min, current) => Comparer<T>
        .Default
        .Compare(min, current) > 0
        ? current
        : min);
}
public static IObservable<T> MyMax<T>(this IObservable<T> source)
{
    var comparer = Comparer<T>.Default;
    Func<T, T, T> max =
        (x, y) =>
        {
            if(comparer.Compare(x, y) < 0)
            {
                return y;
            }
            return x;
        };
    return source.Aggregate(max);
}
```

2 lines vs 22.

10am.

```
let my_min' x = Observable.scan min x |> Observable.distinctUntilChanged

dump "Min" (my_min' (Observable.ofSeq [3;4;3;3;2;4;2;1]))
```

`distinctUntilChanged` does exactly what one would want. I was wondering how one would do that yesterday and as expected, the library gives me exactly what I want here.

10:10am.

```
let my_minby x = Observable.MinBy(x,fun x -> x % 3)

dump "" (my_minby (Observable.range 0 10))
```

I don't understand what this does. Why am I getting `[0;3;6;9]` as a result.

```
 --> seq [0; 3; 6; 9]
 completed.
```

Ah, I am getting a sequence back. So what it is doing is comparing the sequences rather than the individual values.

10:20am.

```
    /// Binds an observable to generate a subsequent observable.
    let bind (f: 'T -> IObservable<'TNext>) (m: IObservable<'T>) = m.SelectMany(Func<_,_> f)
```

Ah, SelectMany is the monadic bind.

10:30am.

---

Examples of Observables of Observables:

Partitions of Data
    You may partition data from a single source so that it can easily be filtered and shared to many sources. Partitioning data may also be useful for aggregates as we have seen. This is commonly done with the GroupBy operator.
Online Game servers
    Consider a sequence of servers. New values represent a server coming online. The value itself is a sequence of latency values allowing the consumer to see real time information of quantity and quality of servers available. If a server went down then the inner sequence can signify that by completing.
Financial data streams
    New markets or instruments may open and close during the day. These would then stream price information and could complete when the market closes.
Chat Room
    Users can join a chat (outer sequence), leave messages (inner sequence) and leave a chat (completing the inner sequence).
File watcher
    As files are added to a directory they could be watched for modifications (outer sequence). The inner sequence could represent changes to the file, and completing an inner sequence could represent deleting the file.

---

I absolutely want the power to handle situations such as these. All this just reinforces that I shuold be learning and that I am at a severe disadvantage by not knowing this.

10:35am. http://introtorx.com/Content/v1.0.10621.0/08_Transformation.html

Finally, the last chapter in part two of the book. I am going to finish it before leaving for breakfast if possible.

```
let dump (sub : IObservable<_>) = sub.Subscribe(printfn "%A", printfn "%A",fun _ -> printfn "Completed.") |> ignore

Observable.interval (TimeSpan.FromSeconds(1.0))
|> Observable.take 3
|> Observable.timestamp
|> dump

Console.ReadKey()
```

Timestamping is something I've been wondering about. This could be really useful.

It bears mentioning that intervals starts the observable asynchronously.

11:05am. He goes into detail when talking about the bind, but these examples are all perfectly clear to me.

11:30am. Had to take a break. Let me resume it for a bit. 1/3rd of the chapter left. I want to get through it.

11:50am. http://introtorx.com/Content/v1.0.10621.0/09_SideEffects.html

Finally comes part 3. This is where things get real.

12:15pm. http://introtorx.com/Content/v1.0.10621.0/10_LeavingTheMonad.html

Let me finally stop here. Time for some rest. I should be able to finish part 3 today, and probably part 4 as well."

---
## [vincent-wagner/HFU](https://github.com/vincent-wagner/HFU)@[dd6d169d69...](https://github.com/vincent-wagner/HFU/commit/dd6d169d695d17fbc45824669fc1a0e9bc1a3ec3)
#### Friday 2020-03-27 12:07:32 by SnakeWithAnA

I just realised Germany is fucking OP in this shitty mod, sorry guys need to remove 600 fighters and give more to UK

---
## [ipld/go-ipld-prime](https://github.com/ipld/go-ipld-prime)@[4eb8c55cd6...](https://github.com/ipld/go-ipld-prime/commit/4eb8c55cd68966319f99d3887fe0033358c76cfa)
#### Friday 2020-03-27 12:13:01 by Eric Myhre

Promote NodeAssembler/NodeStyle solution to core.

This is a *lot* of changes.  It's the most significant change to date,
both in semantics and in character count, since the start of this repo.
It changes the most central interfaces, and significantly so.

But all tests pass.  And all benchmarks are *improved*.

The Node interface (the reading side) is mostly unchanged -- a lot of
consuming code will still compile and work just fine without changes --
but any other Node implementations out there might need some updating.

The NodeBuilder interface (the writing side) is *extremely* changed --
any implementations out there will *definitely* need change -- and most
consumers will too.  It's unavoidable with a semantic fix this big.
The performance improvements should make it worth your while, though.

If you want more background on how and why we got here, you've got
quite a few commits on the "research-admissions" branches to catch up
on reading.  But here's a rundown of the changes:

(Get a glass of water or something calming before reading...)

=== NodeAssembler introduced! ===

NodeAssembler is a new interface that describes most of the work of
creating and filling data into a new Node.

The NodeBuilder interface is still around, but changed in role.
A NodeBuilder is now always also a NodeAssembler; additionally, it can
return the final Node to you.

A NodeAssembler, unlike NodeBuilder, can **not** return a Node to you.
In this way, a NodeBuilder represents the ability to allocate memory.
A NodeAssembler often *does not*: it's just *filling in* memory.

This design overall is much more friendly to efficient operations:
in this model, we do allocations in bulk when a NodeBuilder is used,
and then NodeAssemblers are used thereafter to fill it in -- this
mental model is very friendly to amortizing memory allocations.
Previously, the NodeBuilder interface made such a pattern of use
somewhere between difficult and outright impossible, because it was
modeled around building small values, then creating a bigger value and
inserting the smaller ones into it.

This is the key change that cascaded into producing the entire other
set of changes which land in this commit.

The NodeBuilder methods for getting "child builders" are also gone
as a result of these changes.  The result feels a lot smoother.
(You can still ask for the NodeStyle for children of a recursive kind!
But you'll find that even though it's possible, it's rarely necessary.)

We see some direct improvements from this interface change already.
We'll see even more in the future: creating values when using codegen'd
implementations of Node was hugely encumbered by the old NodeBuilder
model; NodeAssembler *radically* raises the possible ceiling for
performance of codegen Node implementations.

=== NodeStyle introduced ===

NodeStyle is a new interface type that is used to carry information
about concrete node implementations.

You can always use a NodeStyle to get a NodeBuilder.

NodeStyle may also have additional features on it which can be detected
by interface checks.  (This isn't heavily used yet, but we imagine it
might become handy in the future.)

NodeStyle replaces NodeBuilder in many function arguments,
because often what we wanted was to communicate a selection of Node
implementation strategy, but not actually the start of construction;
the NodeStyle interface now allows us to *say that*.

NodeStyle typically cost nothing to pass around, whereas a NodeBuilder
generally requires an allocation to create and initialize.  This means
we can use NodeStyle more freely in many contexts.

=== node package paths changed ===

Node implementations are now in packages under the "node/*" directory.
Previously, they were under an "impl/*" directory.

The "impl/free" package is replaced by the the "node/basic" package!
The package name was "ipldfree"; it's now "basicnode".

=== basicnode is an improved runtime/anycontent Node implementation ===

The `basicnode` package works much the same as the `ipldfree` package
used to -- you can store any kind of data in it, and it just does as
best it can to represent and handle that, and it works without any
kind of type info nor needs of compile-time special support, etc --
while being just quietly *better at it*.

The resident memory size of most things has gone down.
(We're not using "fat unions" in the implementation anymore.)

The cost of iterating maps has gone down *dramatically*.
Iteration previously suffered from O(n) allocations due to
expensive `runtime.conv*` calls when yielding keys.
Iteration is now O(1) (!!) because we redesigned `basicnode` internals
to use "internal pointers" more heavily, and this avoids the costs
from `runtime.conv*`.
(We could've done this separately from the NodeAssembler change,
admittedly.  But both are the product of research into how impactful
clever use of "internal pointers" can be, and lots of code in the
neighborhood had to be rewritten for the NodeAssembler interface,
so, these diffs arrive as one.)

Error messages are more informative.

Many small operations should get a few nanoseconds faster.
(The implementation uses more concrete types and fewer switch
statements.  The difference probably isn't the most noticeable part of
all these changes, but it's there.)

--- basicnode constructor helpers do all return pointers ---

All the "New*" helper functions in the basicnode package return
interfaces which are filled by a pointer now.
This is change from how they worked previously when they were first
implemented in the "rsrch" package.

The experience of integrating basicnode with the tests in the traversal
package made it clear that having a mixture of pointer and non-pointer
values flying around will be irritating in practice.  And since it is
the case that when returning values from inside a larger structure,
we *must* end up returning a pointer, pointers are thus what we
standardize on.

(There was even some writeup in the HACKME file about how we *might*
encounter issues on this, and need to change to pointers-everywhere --
the "pointer-vs-value inhabitant consistency" heading.  Yep: we did.
And since this detail is now resolved, that doc section is dropped.)

This doesn't really make any difference to performance.
The old way would cause an alloc in those method via 'conv*' methods;
the new way just makes it more explicit and go through a different
runtime method at the bottom, but it's still the same number of
allocations for essentially the same reasons.  (I do wonder if at some
future point, the golang compiler might get cleverer about eliding
'conv*' calls, and then this change we make here might be unfortunate;
but that's certainly not true today, nor in the future at any proximity
that I can foresee.)

=== iterator getters return nil for wrong-kind ===

The Node.MapIterator and Node.ListIterator methods now return nil
if you call them on non-maps or non-lists.

Previously, they would return an iterator, but using it would just
constantly error.

I don't think anyone was honestly really checking those error thunks,
and they made a lot of boilerplate white noise in the implementations,
and the error is still entirely avoidable by checking the node kind
up-front (and this is strictly preferable anyway, since it's faster
than getting an error thunk, poking it to get the error, etc)...
so, in total, there seem like very few reasons these were useful:
the idea is thus dropped.

Docs in the Node interface reflect this.

=== node/mixins makes new Node implementations easier ===

The mixins package isn't usable directly, but if you're going to make
a new Node implementation, it should save you a lot of typing...
and also, boost consistency of basic error handling.

Codegen will look forward to using this.  (Codegen already had much of
these semantics internally, and so this package is sort of lifting that
back out to be more generally usable.  By making it live out here as
exported symbols in the core library, we should also reduce the sheer
character count of codegen output.)

=== 'typed.Node' is now 'schema.TypedNode' ===

A bunch of interfaces that were under the "impl/typed" path moved to
be in the "schema" package instead.  This probably makes sense to you
if you look at them and needs no further explanation.

(The reason it comes in this diff, though, is that it was forced:
adding better tests to the traversal package highlighted a bunch of
cyclic dependency issues that came from 'typed.Node' being in a
package that had concrete use of 'basicnode'.)

=== codecs ===

The 'encoding' package is now named 'codec'.

This name is shorter; it's more in line with vocabulary we use
elsewhere in the IPLD project (whereas 'encoding' was more of a nod
to the naming found in the golang standard library); and in my personal
opinion it does better at describing the both directions of the process
(whereas 'encoding' sounds like only the to-linear-bytes direction).

I just like it better.

=== unmarshal functions no longer return node ===

Unmarshal functions accept an NodeAssembler parameter (rather than
a NodeBuilder, as before, nor a NodeStyle, which might also make sense
in the new family of interfaces).

This means they no longer need to return a Node, either -- the caller
can decide where the unmarshalled data lands.  If the caller is using
a NodeBuilder, it means they can call Build on that to get the value.
(If it's a codegen NodeBuilder with More Information, the caller can
use any specialized functions to get the more informative pointers
without need for casting!)

Broadly speaking, this means users of unmarshal functions have more
control over how memory allocation comes into play.

We may want to add more helper functions to the various codec packages
which take a NodeStyle argument and do return a Node.  That's not in
this diff, though.  (Need to decide what pattern of naming these
various APIs would deserve, among other things.)

=== the fluent package ===

The fluent package changed significantly.

The readonly/Node side of it is dropped.  It didn't seem to get a ton
of exercise in practice; the 'traversal' package (and in the future,
perhaps also a 'cursor' package) addresses a lot of the same needs,
and what remains is also covered well these days by the 'must' package;
and the performance cost of fluent node wrappers as well as the
composability obstruction of them... is just too much to be worth it.

The few things that used fluent.Node for reading data now mostly use
the 'must' package instead (and look better for it, imo).

It's possible that some sort of fluent.Node will be rebuilt someday,
but it's not entirely clear to me what it should look like, and indeed
whether or not it's a good idea to have in the repo at all if the
performance of it is counterindicated in a majority of situations...
so, it's not part of today's update.

The writing/NodeBuilder/NodeAssembler fluent wrappers are continued.
It's similar to before (panics promptly on errors, and has a lot of
closures)... but also reflects all of the changes made in the migration
towards NodeAssembler: it doesn't return intermediate nodes, and
there's much less kerfuffle with getting child builders.
Overall, the fluent builders are now even more streamlined than before;
the closures need even fewer parameters; great success!

The fluent.NodeAssembler interface retains the "Create" terminology
around maps and lists, even though in the core interfaces,
the ipld.NodeAssembler interface now says "Begin" for maps and lists.
This is because the fluent.NodeAssembler approach, with its use of
closures, really does do the whole operation in one swoop.

(It's amusing to note that this change includes finally nuking some
fairly old "REVIEW" comment blocks from the old fluent package which
regarded the "knb" value and other such sadness around typed recursion.
Indeed, we've finally reviewed that: and the answer was indeed to do
something drastically different to make those recursions dance well.)

=== selectors ===

Selectors essentially didn't change as part of this diff.  Neat.

(They should get a lot faster when applied, because our node
implementations hit a lot less interface boxing in common operations!
But the selector code itself didn't need to change to get the gains.)

The 'selector/builder' helper package *did* change a bit.
The changes are mostly invisible to the user.
I do have some questions about the performance of the result; I've got
a sneaking suspicion there's now a bunch of improvements that might be
easier to get to now than they would've been previously.  But, this is
not my quest today.  Perhaps it will deserve some review in the future.

The 'selector/builder' package should be noted as having some
interesting error handling strategies.  Namely, it doesn't.
Any panics raised by the fluent package will just keep rising; there's
no place where they're converted to regular error value returns.
I'm not sure this is a good interface, but it's the way it was before
I started passing through, so that's the way it stays after this patch.

ExploreFieldsSpecBuilder.Delete disappears.  I hope no one misses it.
I don't think anyone will.  I suspect it was there only because the
ipld.MapBuilder interface had such a method and it seemed like a
reasonable conservative choice at the time to proxy it; now that the
method proxied is gone, though, so too shall go this.

=== traversal ===

Traversal is mostly the same, but a few pieces of config have new names.

`traversal.Config.LinkNodeBuilderChooser` is now
`traversal.Config.LinkTargetNodeStyleChooser`.
Still a mouthful; slightly more accurate; and reflects that it now
works in terms of NodeStyle, which gives us a little more finesse in
reasoning about where NodeBuilders are actually created, and thus
better control and insight into where allocations happen.

`traversal.NodeBuilderChooser` is now
`traversal.LinkTargetNodeStyleChooser` for the same reasons.

The actual type of the `LinkTargetNodeStyleChooser` now requires
returning a `NodeStyle`, in case all the naming hasn't made it obvious.

=== disappearing node packages ===

A couple of packages under 'impl/*' are just dropped.

This is no real loss.  The packages dropped were Node implementations
that simply weren't done.  Deleting them is an increase in honesty.

This doesn't mean something with the same intentions as those packages
won't come back; it's just not today.

--- runtime typed node wrapper disappeared ---

This one will come back.  It was just too much of a pain to carry
along in this diff.  Since it was also a fairly unfinished
proof-of-concept with no downstream users, it's easier to drop and
later reincarnate it than it is to carry it along now.

=== linking ===

Link.Load now takes a `NodeAssembler` parameter instead of a
`NodeBuilder`, and no longer returns a `Node`!

This should result in callers having a little more control over where
allocations may occur, letting them potentially reuse builders, etc.

This change should also make sense considering how codec.Unmarshal
now similarly takes a NodeAssembler argument and does not return
a Node value since its understood that the caller has some way to
access or gather the effects, and it's none of our business.

Something about the Link interface still feels a bit contorted.
Having to give the Load method a Loader that takes half the same
arguments all over again is definitely odd.  And it's tempting to take
a peek at fixing this, since the method is getting a signature change.
It's unclear what exactly to do about this, though, and probably
a consequential design decision space... so it shall not be reopened
today during this other large refactor.  Maybe soon.  Maybe.

=== the dag-json codec ===

The dag-json codec got harder to implement.  Rrgh.

Since we can't tell if something is going to become a Link until
*several tokens in*, dag-json is always a bit annoying to deal with.
Previously, however, dag-json could still start optimistically building
a map node, and then just... quietly drop it if we turn out to be
dealing with a link instead.  *That's no longer possible*: the process
of using NodeAssembler doesn't have a general purpose mechanism for
backtracking.

So.  Now the dag-json codec has to do even more custom work to buffer
tokens until it knows what to do with them.  Yey.

The upside is: of course, the result is actually faster, and does fewer
memory allocations, since it gathers enough information to decide what
it's doing before it begins to do it.
(This is a lovely example of the disciplined design of NodeAssembler's
interface forcing other code to be better behaved and disciplined!)

=== traversal is faster ===

The `BenchmarkSpec_Walk_MapNStrMap3StrInt/n=32` test has about doubled
in speed on the new `basicnode` implementation in comparison to the old
`ipldfree.Node` implementation.

This is derived primarily from the drop in costs of iteration on
`basicnode` compared to the old `ipldfree.Node` implementation.

Some back-of-the-envelope math on the allocation still left around
suggest it could double in speed again.  The next thing to target
would be allocations of paths, followed by iterator allocations.
Both are a tad trickier, though (see a recently merge-ignore'd
commit for notes on iterators; and paths... paths will be a doozy
because the path forward almost certainly involves path values
becoming invalid if retained beyond a scope, which is... unsafe),
so certainly need their own efforts and separate commits.

=== marshalling is faster ===

Marshalling is much faster on the new `basicnode` implementation in
comparison to the old `ipldfree.Node` implementation.
Same reasons as traversal.

Some fixes to marshalling which previously caused unnecessary
allocations of token objects during recursions have also been made.
These improve speed a bit (though it's not nearly as noticeable as the
boost provided by the Node implementation improvements to iteration).

=== size hints showed up all over the place ===

The appearance of size hint arguments to assembly of maps and lists
is of course inevitable from the new NodeAssembler interface.

It's particularly interesting to see how many of them showed up in
the selector and selectorbuilder packages as constants.

And super especially interesting how many of them are very small
constants.  44 zeros.  86 ones.  25 twos.  9 threes.  2 fours.
(Counted via variations of `grep -r 'Map(.*4, func' | wc -l`.)
It's quite a distribution, neh?  We should probably consider some
more optimizations specifically targeted to small maps.
(This is an unscientific sample, and shifted by what we chose to
focus on in testing, etc etc, but the general point stands.)

`-1` is used to indicate "no idea" for size.  There's a small fix
to the basicnode implementations to allow this.  A zero would work
just as well in practice, but using a negative number as a hint to
the human seems potentially useful.  It's a shame we can't make the
argument optional; oh well.

=== codegen ===

The codegen packages still all compile... but do nonsensical things,
for the moment: they've not been updated to emit NodeAssembler.

Since the output of codegen still isn't well rigged to test harnesses,
this breakage is silent.

The codegen packages will probably undergo a fairly tabula-rasa sweep
in the near future.  There's been a lot of lessons learned since the
start of the code currently there.  Updating to emit the NodeAssembler
interface will be such a large endeavor it probably represents a good
point to just do a fresh pass on the whole thing all at once.

--------

... and that's all!

Fun reading, eh?

Please do forgive the refactors necessary for all this.  Truly, the
performance improvements should make it all worth your while.

---
## [WPN-XM/server-control-panel](https://github.com/WPN-XM/server-control-panel)@[0190a706ae...](https://github.com/WPN-XM/server-control-panel/commit/0190a706ae0e4c5fd26ffd51bf5659d115ffbb33)
#### Friday 2020-03-27 12:25:41 by jakoch

what an insanely dumb parser this is, fuck u bitch

---
## [Crystalwarrior/KFO-Client](https://github.com/Crystalwarrior/KFO-Client)@[614522bc0c...](https://github.com/Crystalwarrior/KFO-Client/commit/614522bc0c8683ca367c5195f1e3c8121b65ce64)
#### Friday 2020-03-27 12:48:21 by Crystalwarrior

Quality of Life improvements
Fix a bug where IC view received focus as soon as you receive the BG image update (it made navigating using /area commands a pain in the ass)
Make music search behave better and not reset when server sends us music list update (todo: remember which elements were/weren't expanded)

---
## [Kerbalism/Kerbalism](https://github.com/Kerbalism/Kerbalism)@[2609a1c9d0...](https://github.com/Kerbalism/Kerbalism/commit/2609a1c9d0d0a6b0940a93251e77734cc3d9c1c5)
#### Friday 2020-03-27 14:44:33 by Gotmachine

Many changes :
1. Refactored fatal error handling, moved many checks to the loading screen, implemented a common system for all those checks, removed all the bits that were all over the place in Kerbalism.cs
2. UI for bug report submitting :
  - from the fatal error handler
  - from the Alt+F12 debug menu
  - this generate a zipped bug report, required the inclusion of the System.IO.Compression classes from the unity mono framework
3. Refactored config format for profile, settings, features, rules, processes and supply
  - changes to the config format, notably processes inputs/outputs, dump settings
  - mod compatibity checks are now defined in the settings config
4. config update :
  - removed depreciated parts
  - changed config folder / file organization a bit
5. VesselData and related classes changes
  - Some classes reorganization
  - Reimplementation of part die events
  - Reorganized vesseldata update handling
6. Centralized handling of part prefab hacks in a PartPrefabsPostCompilation class
7. ExperimentModuleDefinition DB creation reworked
  - Specifics handling moved from the experiment module to it
  - Added tech availability list for the Science Archive filter
8. Many bugfixes and tweaks, I don't remember them all

Todo :
  - Science archive rewiring

---
## [DamavndMind/text-quest](https://github.com/DamavndMind/text-quest)@[e662b10672...](https://github.com/DamavndMind/text-quest/commit/e662b106720bc4cffdfafd49a37fe91c5f9facc9)
#### Friday 2020-03-27 16:53:56 by DamavndMind

Made window fully resizable, no questions asked

I FUCKING DID IT
THE WINDOW RESIZES!!!!!!
HELL YEAH

*Finally removed that print statement that would crash the program when removed!

---
## [metaeducation/ren-c](https://github.com/metaeducation/ren-c)@[ec63c375d5...](https://github.com/metaeducation/ren-c/commit/ec63c375d5ba4466cebdf9d0aabbef881cf4a034)
#### Friday 2020-03-27 17:26:01 by Brian Dickens

Switch emscripten builds to Linux instead of OS X

When Emscripten builds were initially tried on Travis, the Linux
version did not work.  However it is preferable to OS X for all manner
of things--free virtualization of instances, open source, more hacker
friendly--so this tries to switch it back since a couple years pased.

(The motivation was the pain in getting firefox to be installed and
run from the command-line, but there are other reasons.)

---
## [ksaclan/lion-statics](https://github.com/ksaclan/lion-statics)@[175a91c2a4...](https://github.com/ksaclan/lion-statics/commit/175a91c2a4602ae933f3b503164953d67625f6dc)
#### Friday 2020-03-27 17:47:16 by Tyler Hoban

ü¶Ä>1.0.0 is goneü¶Ä

Restrict >1.0.0 client application(s) by redirecting them to a CTA to update using the users prefered method


thank fucking god, that glitchy mess was a pain

---
## [dod38fr/array-intspan-perl](https://github.com/dod38fr/array-intspan-perl)@[dd38d8d97f...](https://github.com/dod38fr/array-intspan-perl/commit/dd38d8d97fc3994875573082b6e1004d620d95e2)
#### Friday 2020-03-27 18:05:41 by Dominique Dumont

Change license to Artistic 2.0

This module is now distributed under Artistic 2.0 license.

For the record, the permission to change the license was granted by
co-author Toby Ovod Everett on Mar 16, 2020:

> On Mar 16, 2020, at 6:37 AM, Toby Ovod-Everett <toby@ovod-everett.org> wrote:
>
> ÔªøI‚Äôm happy to see it relicensed under the Artistic License 2.0, and my recollection is that it was a friendly takeover and I was happy to have someone take over ownership and responsibility.  I‚Äôm also happy to see it packaged for Fedora (I‚Äôve been running Fedora on my home server since the 1.0 days).
>
> Thanks!
>
> Toby
>
>> On Mar 16, 2020, at 3:04 AM, Dominique Dumont <domi.dumont@free.fr> wrote:
>>
>> ÔªøHello
>>
>> I've just go a request from Fedora project to change the license of
>> Array::IntSpan [1] Perl module so it can be packaged for Fedora.
>>
>> While digging in Array::IntSpan changelog, I've seen that you were the
>> original author of this module. (Sorry, I had completely forgotten that point,
>> I hope it was a friendly take-over, but I don't remember that either. I must
>> be getting old... )
>>
>> Anyway, since you're also owner of the copyright of Array::IntSpan, I need
>> your permission to relicense this module to a license accepted by Fedora.
>>
>> I'm planning to relicense to Artistic 2.0.
>>
>> Do you agree with this license change ?
>>
>> All the best
>>
>> Dominique
>>
>> [1] https://metacpan.org/release/Array-IntSpan
>>

---
## [CandyFace/pencil](https://github.com/CandyFace/pencil)@[f647203029...](https://github.com/CandyFace/pencil/commit/f647203029019fdc81cb32abb5bdbae54df722d9)
#### Friday 2020-03-27 19:13:14 by CandyFace

Fix white artifacts appearing when painting on multiple layers

This took a lot of debugging honestly... the real challenge was to figure out what the alternative would be, without killing performance. After I finally solved the problem, without letting go of my previous solution but merely rethinking where to erase pixels, tiling started appearing at random zoom levels... (Of course now there's a pesky rounding error somewhere, I thought), at that point I was so close and yet a damn 1 width pixel artifact kept me from committing and yelling BEHOLD! line appeared here and there and only at certain zoom levels. I began dismantling everything to the point where I had 300 lines of debugging code... BEHOLD though! after a lot of trial and error, I finally solved the tiling issue (that you didn't experience).

What's great though is that performance will be even better now because everything is scaled according to physical pixel size, meaning zooming out will make both bitmap and tiles smaller and likewise bigger when zooming in. There's still space for improvement though, we could intersect the content with the canvas size and always make sure that we don't paint what we can't see.

---
## [PixelExperience-Devices/kernel_xiaomi_dipper](https://github.com/PixelExperience-Devices/kernel_xiaomi_dipper)@[a7943cb7ae...](https://github.com/PixelExperience-Devices/kernel_xiaomi_dipper/commit/a7943cb7aee0aa63fc4dc582e039637511fd776f)
#### Friday 2020-03-27 20:06:31 by Rapherion Rollerscaperers

tfa98xx: Holy shit what the fuck CAF

Bro

Signed-off-by: Rapherion Rollerscaperers <rapherion@raphielgang.org>
Signed-off-by: Henrique Pereira <hlcpereira@pixelexperience.org>

---
## [marcialwushu/restropective-docusaurus](https://github.com/marcialwushu/restropective-docusaurus)@[1728de7a10...](https://github.com/marcialwushu/restropective-docusaurus/commit/1728de7a106d0872cdbc5ace7a2b9e3c56e3a30a)
#### Friday 2020-03-27 22:51:25 by Cleilson

WELCOME TO PWN2OWN 2020 - THE SCHEDULE AND LIVE RESULTS

Welcome to Pwn2Own 2020! This year‚Äôs contest will be the first where all attempts occur remotely. We have contestants from around the world ready to demonstrate some amazing research, and we have ZDI researchers ready to run and verify their attempts. Our returning partner Microsoft and sponsor VMware will also be online with us, as well as other affected vendors. We might not be in the same room, but we‚Äôre virtually together and ready for a fantastic contest. 

The schedule for today is posted below, and we‚Äôll be updating this blog throughout the day with results and updates. We‚Äôll post a full summary of today‚Äôs events (including videos of the attempts) tomorrow morning.

As always, we started the contest with a random drawing to determine the order of attempts. We have four attempts scheduled for today and four queued up for tomorrow. The full schedule for Day One is below (all times Pacific [UTC -7:00]). We will update this schedule with results as they become available.

---
## [andyfry01/HBC-SLBA](https://github.com/andyfry01/HBC-SLBA)@[88617f22c7...](https://github.com/andyfry01/HBC-SLBA/commit/88617f22c703ffaf888305ab7bf19ccecc353351)
#### Friday 2020-03-27 22:53:37 by Andy Fry

Refactor JS to enable footer to be at bottom of page

This is such a fucking hack job ... I am sorry future Andy. Really
sorry.

The basic issue is this:
- there is some custom JS that is used to resize the `#targetdiv`
element on the page on route change, which is supposed to set the height
of the scrolling background image element so the image isn't too tall.
- This is .... fine ... for the front page, but this #targetdiv element
is also where all the other pages render inside of. This height setting
functionality is only needed on the home page, but all pages will have
their target div resized on load
- What this results in is that the footer will not be at the bottom of
the page, but in the middle of the rest of the text content. Because
we're setting inline height styles on the target div, the actual flow of
the document is disrupted

My shitty, Friday-at-6:45pm solution to this is to look at the URL on
page load and only resize the target div for the homepage. This should
be changed in the future... but it will not be changed today.

---

# [<](2020-03-26.md) 2020-03-27 [>](2020-03-28.md)

