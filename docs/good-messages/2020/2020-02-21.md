# [<](2020-02-20.md) 2020-02-21 [>](2020-02-22.md)

2,077,073 events, 1,066,832 push events, 1,690,189 commit messages, 122,931,363 characters


## [TacticalBFG/HelicityScripts@a58be9eacc...](https://github.com/TacticalBFG/HelicityScripts/commit/a58be9eaccc80d5b9d68c16c377e056e0718e04e)
##### 2020-02-21 04:15:44 by Marco

Add files via upload

Did I really just forget that melody?
Naw, na, na, banana-na-na
Alright, da, da da-da-da-da
When I popped off, then your girl gave me just a little bit of lockjaw
Baby so cold, he from the north, he from the Canada
Bankroll so low, I got nothing else that I can withdraw
Ran out the door
I shine my wrist, it go like shashasha, shashasha
I got your bitch singing, "Lalalala, lalala"
I shine my wrist, it go like shashasha, shashasha
I got your bitch singing, "Lalalala, lalala"
How I stride like that?
Amex, no cap, eight hundred score
They wonder how, how I guap like that
I rap my lyrics when I perform
They wonder how, how I stride like that
Married to the grind, I brought my ring
I'm corny but your girly want the dick
Modest with my jewels but check the bank
Finally got the money, say my thanks
When I popped off, then your girl gave me just a little bit of lockjaw
Baby so cold, he from the north, he from the Canada
Bankroll so low, I got nothing else that I can withdraw
Ran out the door
I shine my wrist, it go like shashasha, shashasha
I got your bitch singing, "Lalalala, lalala"
I shine my wrist, it go like shashasha, shashasha
I got your bitch singing, "Lalalala, lalala"
How I stride like that?
Ha-ha, I'm at the bank again
They wonder how, how I guap like that
Pink whip with flames all on the side
They wonder how, how I stride like that
Got that Gucci on my body, now she tryna pipe me, woo
Popped a Lucy loosey goosey, sussy boy, I keep you cool
Got the paper, went to school, be careful who you callin' a fool
Ayy, ha, ayy
When I popped off, then your girl gave me just a little bit of lockjaw
Baby so cold, he from the north, he from the Canada
Bankroll so low, I got nothing else that I can withdraw
Ran out the door
I shine my wrist, it go like shashasha, shashasha
I got your bitch singing, "Lalalala, lalala"
I shine my wrist, it go like shashasha, shashasha
I got your bitch singing, "Lalalala, lalala"
How I stride like that?

---
## [danjiangqyy/duke-uni@27417be943...](https://github.com/danjiangqyy/duke-uni/commit/27417be94339fc4cb34d02afffeb0257140f970b)
##### 2020-02-21 04:37:51 by danjiangqyy

Create coursera2 week2 freqinword

Assignment 2: Words in Files
Write a program to determine which words occur in the greatest number of files, and for each
word, which files they occur in.
For example, consider you are given the four files: brief1.txt, brief2.txt, brief3.txt, and
brief4.txt.
brief1.txtis:
cats are funny and cute
brief2.txtis:
dogs are silly
brief3.txtis:
love animals cats and dogs
brief4.txtis:
love birds and cats
The greatest number of files a word appears in is three, and there are two such words: ‚Äúcats‚Äù
and ‚Äúand‚Äù.
‚Äúcats‚Äù appears in the files: brief1.txt, brief3,txt, brief4.txt
‚Äúand‚Äù appears in the files: brief1.txt, brief3.txt, brief4.txt
To solve this problem, you will create a map of words to the names of files they are in. That is,
you will map a String to an ArrayList of Strings. Then you can determine which ArrayList value is
the largest (has the most filenames) and its key is thus, a word that is in the most number of
files.
Specifically, you should do the following:
‚óè Create a new class called WordsInFiles. Put all the remaining listed items in this class.
‚óè Create a private variable to store a HashMap that maps a word to an ArrayList of
filenames.
‚óè Write a constructor to initialize the HashMap variable.
Java Programming: Arrays, Lists, and Structured Data
‚óè Write a private void method named addWordsFromFilethat has one parameter fof
type File. This method should add all the words from finto the map. If a word is not in
the map, then you must create a new ArrayList of type String with this word, and have
the word map to this ArrayList. If a word is already in the map, then add the current
filename to its ArrayList, unless the filename is already in the ArrayList.
‚óè Write a void method named buildWordFileMapthat has no parameters. This method
first clears the map, and then uses a DirectoryResource to select a group of files. For
each file, it puts all of its words into the map by calling the method addWordsFromFile.
The remaining methods to write all assume that the HashMap has been built.
‚óè Write the method maxNumberthat has no parameters. This method returns the
maximum number of files any word appears in, considering all words from a group of
files. In the example above, there are four files considered. No word appears in all four
files. Two words appear in three of the files, so maxNumberon those four files would
return 3. This method assumes that the HashMap has already been constructed.
‚óè Write the method wordsInNumFilesthat has one integer parameter called number.
This method returns an ArrayList of words that appear in exactly numberfiles. In the
example above, the call wordsInNumFiles(3)would return an ArrayList with the
words ‚Äúcats‚Äù and ‚Äúand‚Äù, and the call wordsInNumFiles(2)would return an ArrayList
with the words ‚Äúlove‚Äù, ‚Äúare‚Äù, and ‚Äúdogs‚Äù, all the words that appear in exactly two files.
‚óè Write the void method printFilesInthat has one String parameter named word. This
method prints the names of the files this word appears in, one filename per line. For
example, in the example above, the call printFilesIn(‚Äúcats‚Äù)would print the
three filenames: brief1.txt, brief3.txt, and brief4.txt, each on a separate line.
‚óè Write the void method testerthat has no parameters. This method should
‚óã call buildWordFileMap()to select a group of files and build a HashMap of words,
with each word mapped to an ArrayList of the filenames this word appears in.
‚óã determine the maximum number of files any word is in, considering all words.
‚óã determine all the words that are in the maximum number of files and for each
such word, print the filenames of the files it is in.
Java Programming: Arrays, Lists, and Structured Data
‚óã (optional) If the map is not too big, then you might want to print out the complete
map, all the keys, and for each key its ArrayList. This might be helpful to make
sure the map was built correctly

---
## [expo/expo@c596d6cd40...](https://github.com/expo/expo/commit/c596d6cd40320ed4d28c8c12621c36b4038b814e)
##### 2020-02-21 08:27:08 by Tomasz Sapeta

[android][home] ü§ñ Add DevMenu on Android (#6829)

# Why

Fixes #6521 

# How

- Created unversioned `DevMenuManager` class which mostly just delegates calls to versioned `DevMenuModule` modules specific for SDK version. These modules are responsible for providing initial props, dev menu options and actions to run when these options are selected. The manager creates a new `ReactRootView` that bases on kernel's (home's) React instance manager and starts `HomeMenu` app which is registered as a second entry point in `home` and then, manager adds this root view to the currently used activity (it must implement `ExperienceActivity`). As I needed to know which experience activity is the current one, I've added `sCurrentActivity` static member to that class and just track it using activity's lifecycle methods.
- Backported `DevMenuModule` to all SDK versions included in the client. Including some changes between them - for example hot and fast reloading.
- Added support for back button and Android's menu press (which can be simulated by `adb shell input keyevent 82`).
- Removed some unused code related to `Nux` and replaced it with new onboarding screen (see #6793).
- Created new `ShakeDetector` which works more like on iOS. The one provided by React Native is annoying in most cases as it actually requires two shakes.
- Updated `ReactAndroidCodeTransformer` to turn off showing React Native dev menu in non-standalone apps.
- **To do after merging:** Rebuild versioned expoviews.

# Test Plan

- [x] Test on experience in debug mode
- [x] Test on experience in production mode
- [x] Test on snacks
- [x] Test on older SDKs
- [x] Test on simulators
- [x] Test that onboarding shows up once you open the experience for the first time or you didn't accept it yet (clicked `Got it` button).
- [x] Test that using dev menu still works once we kill home's activity.

---
## [mrakgr/The-Spiral-Language@e9715c9afe...](https://github.com/mrakgr/The-Spiral-Language/commit/e9715c9afecb097793fa60320feaae77544257ff)
##### 2020-02-21 09:21:20 by Marko Grdiniƒá

"8:35am. Got up 20m ago. Yesterday fatigue really hit me like a truck, so I did not even manage to read more than 2 chapters of the Toji novel. I'll take the opportunity provided by this early awakening to indulge myself. I'll study the ASP.NET book after that.

Also, I did some planning. I've decided. I think it really is unrealistic to aim for low 6-figure remote job at Intel, but I should be able to use that in order to pivot and get the guy to send me a sample. Having that neurochip would be the catalyst to actually doing the RL agent properly. If I could have it, I am not sure how things would go from there, but I am certain that I could at least create the poker agent. That would matter a lot.

If I get an offer for a 5 figure remote job, it could also serve as a backup if any disasters strike even if I have no intention of taking it. I'll be killing many birds in with one stone this way. The salary money does not really matter, all the big stuff in the lead up to the Singularity will be through RL anyway.

9:25am. https://news.ycombinator.com/item?id=22381129
"Location: Remote
Vathys is hiring a machine learning compiler engineer to build the core compiler to a system that will be a step function improvement in ML capability.

The ideal candidate:

1. Has a good understanding of the fundamentals of deep learning algorithms. Less "I can use Keras" and more "I can write a CNN from scratch in numpy".

2. Has used a NN compiler framework or IR framework in the past such as TVM, MMdnn, MLIR, Glow, Tensor Comprehensions, etc.

3. Has experience with compilers, especially optimizing compilers and compilers for high performance code.

4. Has experience writing kernels for deep learning applications.

5. Has at least passing familiarity with the concept of polyhedral optimizations

Generous compensation will be provided to the right candidates.

Please contact tapabrata_ghosh[at]vathys[dot]ai if you're interested"

They forgot to put a link to their site, http://vathys.ai/.

It seems this is one of the startups, but damn it, it is just too early for me. I really do need to finish Spiral before I apply to anywhere, but on the other hand if I wait too long the opportunities will go away.

Nonetheless, times like these are a test of character. I always need to be in the frame of mind of abundance.

There will be more of these in the future. Plus, I am not making Spiral for any specific piece of hardware. There is no point in committing myself anything until I know that I can use it for my own purposes. I need to keep in mind that most of these startups are here to drain investor money and capitalize on the hype. There isn't room for 100 different neurochips on the market.

10:20am. Done with chapter 4 of the Toji novel. That was really good. I enjoyed this morning.

Now let me study the ASP.NET book."

---
## [roonil-wazlib/FlatOrganiser@11aef67141...](https://github.com/roonil-wazlib/FlatOrganiser/commit/11aef67141713945e0d95239f19fc512e0b13346)
##### 2020-02-21 12:42:09 by roonil-wazlib

Really shitty, half broken, barely readable, not remotely functional recycler view implemented for dinner plan activity. Days of the week don't even appear in order for Christ's sake. This is why you're not supposed to code at 2am in the god damn morning. Go tf to sleep.

---
## [mrakgr/The-Spiral-Language@4097762ff4...](https://github.com/mrakgr/The-Spiral-Language/commit/4097762ff4bf07df242fa295f2b777a258061f39)
##### 2020-02-21 14:34:36 by Marko Grdiniƒá

"10:40pm. "Changes such as these have inevitably effected other changes in a ripple effect, for example,
in the forced removal of **runtime compilation**"

I wonder what is meant by **runtime compilation**. Egh, I really do not know much about how JITed languages work under the hood. Does that mean that ASP apps are AOT compiled? Probably not.

11:35am. https://docs.microsoft.com/en-us/dotnet/standard/memory-and-spans/memory-t-usage-guidelines
".NET Core includes a number of types that represent an arbitrary contiguous region of memory. .NET Core 2.0 introduced Span<T> and ReadOnlySpan<T>, which are lightweight memory buffers that can be backed by managed or unmanaged memory. Because these types can only be stored on the stack"

I am looking at some HN threads on ASP.NET and these got mentioned. Interesting they've got types stored on the stack now.

"Well it has always been performant. The whole Stackexchange is built with ASP.net, and it render things 10x faster than Ruby Rails while requiring 10x less hardware resources."

I am just checking out what people say about this since the book made performance claims. I do not see them being contested.

2:05pm. Done with breakfast, chores, bath. Let rest for a bit and then I will resume. Rather than reading the book, I started looking at threads midway, but I'll get back to it.

3pm. By 'get back to it,' I obviously meant 'rant on /sci/'. No seriously me, read the damn ASP.NET book!

3:10pm. 62/558. This overly long chapter on just setting up the environment that I apparently don't have the brain to skip is putting me to sleep. I really need to start skimming this. Yesterday I really started having fun with the TS book, but now this is really bringing me down.

3:15pm. Focus me, start skimming this. Hopefully chapter 3 will be something where I actually learn new things and that will pick me up.

3:30pm. Finally at chapter 3. It is asking me to get a free Azure DevOps subscription. I have no idea what that is, but I'll do it.

Maybe I made a mistake going with this book. Yesterday I was quite into it, but so far this book has been a snoozefest.

Let me commit here."

---
## [eworm-de/mpv@0b35b4c917...](https://github.com/eworm-de/mpv/commit/0b35b4c91796fb020e13d955efd450021eb5eedb)
##### 2020-02-21 14:56:12 by wm4

sub: make filter_sdh a "proper" filter, allow runtime changes

Until now, filter_sdh was simply a function that was called by sd_ass
directly (if enabled).

I want to add another filter, so it's time to turn this into a somewhat
more general subtitle filtering infrastructure.

I pondered whether to reuse the audio/video filtering stuff - but better
not. Also, since subtitles are horrible and tend to refuse proper
abstraction, it's still messed into sd_ass, instead of working on the
dec_sub.c level. Actually mpv used to have subtitle "filters" and even
made subtitle converters part of it, but it was fairly horrible, so
don't do that again.

In addition, make runtime changes possible. Since this was supposed to
be a quick hack, I just decided to put all subtitle filter options into
a separate option group (=> simpler change notification), to manually
push the change through the playloop (like it was sort of before for OSD
options), and to recreate the sub filter chain completely in every
change. Should be good enough.

One strangeness is that due to prefetching and such, most subtitle
packets (or those some time ahead) are actually done filtering when we
change, so the user still needs to manually seek to actually refresh
everything. And since subtitle data is usually cached in ASS_Track (for
other terrible but user-friendly reasons), we also must clear the
subtitle data, but of course only on seek, since otherwise all subtitles
would just disappear. What a fucking mess, but such is life. We could
trigger a "refresh seek" to make this more automatic, but I don't feel
like it currently.

This is slightly inefficient (lots of allocations and copying), but I
decided that it doesn't matter. Could matter slightly for crazy ASS
subtitles that render with thousands of events.

Not very well tested. Still seems to work, but I didn't have many test
cases.

---
## [eworm-de/mpv@7d11eda72e...](https://github.com/eworm-de/mpv/commit/7d11eda72e90d7aa9df25127bd810aa7b191029c)
##### 2020-02-21 14:56:12 by wm4

Remove remains of Libav compatibility

Libav seems rather dead: no release for 2 years, no new git commits in
master for almost a year (with one exception ~6 months ago). From what I
can tell, some developers resigned themselves to the horrifying idea to
post patches to ffmpeg-devel instead, while the rest of the developers
went on to greener pastures.

Libav was a better project than FFmpeg. Unfortunately, FFmpeg won,
because it managed to keep the name and website. Libav was pushed more
and more into obscurity: while there was initially a big push for Libav,
FFmpeg just remained "in place" and visible for most people. FFmpeg was
slowly draining all manpower and energy from Libav. A big part of this
was that FFmpeg stole code from Libav (regular merges of the entire
Libav git tree), making it some sort of Frankenstein mirror of Libav,
think decaying zombie with additional legs ("features") nailed to it.
"Stealing" surely is the wrong word; I'm just aping the language that
some of the FFmpeg members used to use. All that is in the past now, I'm
probably the only person left who is annoyed by this, and with this
commit I'm putting this decade long problem finally to an end. I just
thought I'd express my annoyance about this fucking shitshow one last
time.

The most intrusive change in this commit is the resample filter, which
originally used libavresample. Since the FFmpeg developer refused to
enable libavresample by default for drama reasons, and the API was
slightly different, so the filter used some big preprocessor mess to
make it compatible to libswresample. All that falls away now. The
simplification to the build system is also significant.

---
## [newstools/2020-the-guardian-uk@24a25d9880...](https://github.com/newstools/2020-the-guardian-uk/commit/24a25d98804f9ea39209023629d69c27291c3d2d)
##### 2020-02-21 16:30:38 by NewsTools

Created Text For URL [www.theguardian.com/lifeandstyle/2020/feb/21/my-friend-disappears-every-time-she-gets-a-new-boyfriend]

---
## [agustinvalencia/CompStatsLabs@1f9ee6ce0c...](https://github.com/agustinvalencia/CompStatsLabs/commit/1f9ee6ce0c12e4ede740335c1a27db52a2380f4a)
##### 2020-02-21 17:42:00 by agustin

redoing shit bc I'm an asshole and I hate my life. what was I thinking gimme my life back god

---
## [ThunderStorms21th/S7-Linux-3.18.140@14ad9cb418...](https://github.com/ThunderStorms21th/S7-Linux-3.18.140/commit/14ad9cb418ec4939be47d6fd73c77f3b06115b03)
##### 2020-02-21 17:55:51 by googyanas

fs/sync: Make sync() satisfy many requests with one invocation

Dave Jones reported RCU stalls, overly long hrtimer interrupts, and
amazingly long NMI handlers from a trinity-induced workload involving
lots of concurrent sync() calls (https://lkml.org/lkml/2013/7/23/369).
There are any number of things that one might do to make sync() behave
better under high levels of contention, but it is also the case that
multiple concurrent sync() system calls can be satisfied by a single
sys_sync() invocation.

Given that this situation is reminiscent of rcu_barrier(), this commit
applies the rcu_barrier() approach to sys_sync().  This approach uses
a global mutex and a sequence counter.  The mutex is held across the
sync() operation, which eliminates contention between concurrent sync()
operations.  The counter is incremented at the beginning and end of
each sync() operation, so that it is odd while a sync() operation is in
progress and even otherwise, just like sequence locks.

The code that used to be in sys_sync() is now in do_sync(), and
sys_sync()
now handles the concurrency.  The sys_sync() function first takes a
snapshot of the counter, then acquires the mutex, and then takes another
snapshot of the counter.  If the values of the two snapshots indicate
that
a full do_sync() executed during the mutex acquisition, the sys_sync()
function releases the mutex and returns ("Our work is done!").
Otherwise,
sys_sync() increments the counter, invokes do_sync(), and increments
the counter again.

This approach allows a single call to do_sync() to satisfy an
arbitrarily
large number of sync() system calls, which should eliminate issues due
to large numbers of concurrent invocations of the sync() system call.

Changes since v1 (https://lkml.org/lkml/2013/7/24/683):

o	Add a pair of memory barriers to keep the increments from
	bleeding into the do_sync() code.  (The failure probability
	is insanely low, but when you have several hundred million
	devices running Linux, you can expect several hundred instances
	of one-in-a-million failures.)

o	Actually CC some people who have experience in this area.

Reported-by: Dave Jones <davej@redhat.com>
Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
Cc: Alexander Viro <viro@zeniv.linux.org.uk>
Cc: Christoph Hellwig <hch@lst.de>
Cc: Jan Kara <jack@suse.cz>
Cc: Curt Wohlgemuth <curtw@google.com>
Cc: Jens Axboe <jaxboe@fusionio.com>
Cc: linux-fsdevel@vger.kernel.org

Signed-off-by: Paul Reioux <reioux@gmail.com>

---
## [Khan/math-input@f489abe167...](https://github.com/Khan/math-input/commit/f489abe1676695f6d6d285916461dbf631b7ba0e)
##### 2020-02-21 18:33:11 by Diedra Rater

Show overflow input values when typing or pulling cursor handle

SUMMARY
Issue: https://khanacademy.atlassian.net/browse/LP-7812

It turns out that if we remove the code that overrides Mathquil's native scrolling logic, the extra scrolly behavior we want (scrolling on cursor handle pull and when the user is typing past the edge of the box) just magically work. For some reason, we still needed to add the `overflow: "scroll"` styles in `override.less` to get manually scrolling to work, but Mathquil can handle the other stuff for us.

So this diff mostly just removes the code that overrides Mathquil's code. That also means removing the `scrollable` prop, which I really should have removed before anyway, since we're now making the input field always scrollable. (Should we be concerned about removing this prop since this is an open source project? I actually don't have any experience with open source, so I really don't know.)

I also updated my code for hiding the cursor handle on scroll since that currently messes up the feature of scrolling by pulling on the cursor handle (for obvious reasons). This isn't actually part of the ticket I set out to do, but since Mathquil is giving it to us for free, why not? It's not perfect though. It works pretty well when scrolling the input field left by pulling on the cursor, but scrolling it right is really janky. So I was thinking of taking the ticket I had for implementing the scroll-on-handle-pull feature and, instead of closing it, updating it to instead say to make this feature better. But since it's already a P3, I don't know if we'll ever get to it, so maybe it's better to just close it? https://khanacademy.atlassian.net/browse/LP-7695

TEST PLAN
Open the expression widget,
type in a whole buncha values,
when you pass the max width of the input field, verify the input field scrolls to show the new values you insert,
verify you can manually scroll left and right by using a track pad, scroll wheel, or by pulling the scroll bar,
tap into the input field,
verify the cursor handle appears,
scroll the field again,
verify the handle disappears,
tap into the field again,
grab the cursor handle,
verify you can pull it around the input field,
pull it off the side of the input field in a direction that has hidden values,
and verify the input field scrolls to show the hidden values.

---
## [Farquaar/tgstation@65485b9c54...](https://github.com/Farquaar/tgstation/commit/65485b9c54e9d2fc269e40502ab929888cdb2db3)
##### 2020-02-21 21:11:04 by ArcaneMusic

Adds a new Tech to the B.E.P.I.S., Specialized Engineering, and a new Minor Reward. (#48507)

About The Pull Request

Round 2.
image
Adds a new tech to be unlocked within the B.E.P.I.S.'s major techs, called "Specialized Engineering". Within that tech are 2 new items, Heat Resistant Rods, and the Tinker's Gloves, as well as a new minor tech, the Survival Pen.
Heat Resistant Rods:
Have you ever wanted to expand Lavaland Base? Build a lava fortress worthy of your magnificence? Well, now you can! Using Heat Resistant Rods, you can make a catwalk to cross lava tiles, as well as build atop lava, without messy methods like using the RCD!
Tinker's Gloves:
This just in engineers, insulated gloves have new competition in town! The Tinker's gloves are complicated, overdesigned gloves that, while not very shockproof, allow for faster wall girder construction. No longer will you need to die of old age walling off an area when you're out of RCD ammo! Warning: This product contains no likeness to clockwork gauntlets used by the extinct cult of Rat'Var, and any such similarity is by no means intentional.

Survival Pen:
Have you ever been stuck on lavaland, trapped by your survival pod with just a few chairs, some titanium walls, and walls of ash closing in on you? Well THANK GOD you have your Rockbreaker brand Survival Pen! Allows for basic mining operations, and is portable like a standard pen!
BUT WAIT!
A watcher blocks your path. Thankfully, your expensive, diamond encrusted pen isn't just good for being the world's slowest pickaxe, it's ALSO coated in the one thing watchers crave: DIAMONDS. Toss the pen to draw the watcher's attention elsewhere.
Why It's Good For The Game

Starts to fill our B.E.P.I.S. Major Reward Techs, as intended, and fills a niche that doesn't get much play nowadays: Building on Lavaland. This was something I've had in the back of my mind since we did the first tests of the Disaster gamemode a few months ago, so each item here was made with the intention of improving the mining base should the station become un-livable. Lava-Proof Rods are beneficial in that you'll be able to cross and build over lava by the mid-end of the shift. RCDs still work as usual, but this way you won't have to worry about getting specialized engineering equipment as a member of cargo or science. The tinker's gloves are basically a variant of the nitrile gloves, but they grant a speed bonus to adding plating to metal girders, so that some kind of functional alternative to giving every engineer insulated gloves.
Survival Pens are quite honestly very niche, but getting dumb pens with extra functionality is a tradition of trade shows all over the world, so it feels right at home as a minor reward.

Also, does a tiny change to the doe sprites, just to look a little bit less old.
Changelog

cl
add: A new Technology has been implemented as a major reward in the B.E.P.I.S., Specialized Engineering, to appeal to engineering utility and new construction horizons.
tweak: Watchers will now actively consume diamond ore left lying around, alongside the new survival pens.
/cl

---
## [CorySanin/OpenRCT2-FFA@a8b5304786...](https://github.com/CorySanin/OpenRCT2-FFA/commit/a8b5304786abb546ddb7a082a3ba27dc4284be70)
##### 2020-02-21 23:49:23 by Ted John

Remove exe / com wrapper around openrct2.dll for Windows (#10727)

We get repeated reports of people saying the game is incorrectly reported as a virus. It is becoming more inconvenient for players and even myself, because when we attempt to download a build, it is immediately deleted by scanners (including the default for Windows: Windows Defender).

One scanner is not too much of an issue, but the game is flagged by almost half of available scanners as reported by VirusTotal.

So why is it being flagged?

Windows has a very annoying concept, the subsystem for a binary. The console subsystem allows stdin / stdout as you would expect, just like posix. Unfortunately if a user runs a console subsystem binary from the desktop or explorer, the game will be opened under conhost and thus you get a console showing alongside the game window. This is not a good user experience for most players. To resolve this, you can use the windows subsystem, but this will detach stdin and stdout immediately on launch. There are hacks that can be done in code to allocate a new console but I found this to not work very well with stdin or other terminal emulators.

My solution to the problem was to have two binaries: openrct2.exe and openrct2.com. Both are executable but openrct2.exe is windows subsystem, openrct2.com is console subsystem. The desktop shortcut opens openrct2.exe with no console window showing. Typing openrct2 on the command line will execute openrct2.com (as .com has higher PATH precedence than .exe by default) with working stdin and stdout. In order to reduce the size, I have the entire game inside openrct2.dll and then supply two tiny wrapper EXEs that simply route main(...) into the DLL.

These wrapper EXEs are the problem, they are very small and do nothing but call into a DLL, this must match virus signatures too closely and their size probably reduces the data available for the scanner to analyse.

So as I can not find any other way of achieving my goal of a cli and gui version of OpenRCT2, this changes the build to publish openrct2 as a single executable (rather than a DLL + wrapper EXE), and then duplicate the entire ~10MB exe again and flip the subsystem flag. The installer and zip size won't be affected as this extra size will be completely compressed out, but when unpacked will lead to an extra ~10MB on disc. But I think it is a fair compromise.

VirusTotal now reports all artefacts as safe, for now anyway.

---

# [<](2020-02-20.md) 2020-02-21 [>](2020-02-22.md)

