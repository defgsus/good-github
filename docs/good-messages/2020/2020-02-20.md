# [<](2020-02-19.md) 2020-02-20 [>](2020-02-21.md)

2,251,032 events, 1,128,492 push events, 1,811,652 commit messages, 129,355,793 characters


## [saqib-ali/hivemined](https://github.com/saqib-ali/hivemined)@[39e3f7a872...](https://github.com/saqib-ali/hivemined/commit/39e3f7a872b479bb8bb88519687faad60cebbaac)
#### Thursday 2020-02-20 00:45:17 by Saqib Ali

Senior Product Designer at LogDNA - San Francisco - Dribbble Design Jobs. NICE Careers - Product Manager. JDRF International Product Designer | SmartRecruiters. Product Manager - Love to Ride and Civic Dinners - Love to Ride. Chegg Careers - Senior Product Manager. Product Manager - Personal Care at Grofers. Job Application for Senior Product Manager at Guideline, Inc.. Job Application for Product Designer at Guideline, Inc.. Product Manager, Analytics &amp; Data Science. Job Application for Product Manager Lead OTT at Yieldmo.

---
## [gdalgas/Test](https://github.com/gdalgas/Test)@[cb983321ba...](https://github.com/gdalgas/Test/commit/cb983321ba64215c491ff8db5879dad059718177)
#### Thursday 2020-02-20 01:05:54 by gdalgas

GitHub Flavored Markdown

================================

*View the [source of this content](http://github.github.com/github-flavored-markdown/sample_content.html).*

Let's get the whole "linebreak" thing out of the way. The next paragraph contains two phrases separated by a single newline character:

Roses are red
Violets are blue

The next paragraph has the same phrases, but now they are separated by two spaces and a newline character:

Roses are red
Violets are blue

Oh, and one thing I cannot stand is the mangling of words with multiple underscores in them like perform_complicated_task or do_this_and_do_that_and_another_thing.

A bit of the GitHub spice
-------------------------

In addition to the changes in the previous section, certain references are auto-linked:

* SHA: be6a8cc1c1ecfe9489fb51e4869af15a13fc2cd2
* User@SHA ref: mojombo@be6a8cc1c1ecfe9489fb51e4869af15a13fc2cd2
* User/Project@SHA: mojombo/god@be6a8cc1c1ecfe9489fb51e4869af15a13fc2cd2
* \#Num: #1
* User/#Num: mojombo#1
* User/Project#Num: mojombo/god#1

These are dangerous goodies though, and we need to make sure email addresses don't get mangled:

My email addy is tom@github.com.

Math is hard, let's go shopping
-------------------------------

In first grade I learned that 5 > 3 and 2 < 7. Maybe some arrows. 1 -> 2 -> 3. 9 <- 8 <- 7.

Triangles man! a^2 + b^2 = c^2

We all like making lists
------------------------

The above header should be an H2 tag. Now, for a list of fruits:

* Red Apples
* Purple Grapes
* Green Kiwifruits

Let's get crazy:

1.  This is a list item with two paragraphs. Lorem ipsum dolor
    sit amet, consectetuer adipiscing elit. Aliquam hendrerit
    mi posuere lectus.

    Vestibulum enim wisi, viverra nec, fringilla in, laoreet
    vitae, risus. Donec sit amet nisl. Aliquam semper ipsum
    sit amet velit.

2.  Suspendisse id sem consectetuer libero luctus adipiscing.

What about some code **in** a list? That's insane, right?

1. In Ruby you can map like this:

        ['a', 'b'].map { |x| x.uppercase }

2. In Rails, you can do a shortcut:

        ['a', 'b'].map(&:uppercase)

Some people seem to like definition lists

<dl>
  <dt>Lower cost</dt>
  <dd>The new version of this product costs significantly less than the previous one!</dd>
  <dt>Easier to use</dt>
  <dd>We've changed the product so that it's much easier to use!</dd>
</dl>

I am a robot
------------

Maybe you want to print `robot` to the console 1000 times. Why not?

    def robot_invasion
      puts("robot " * 1000)
    end

You see, that was formatted as code because it's been indented by four spaces.

How about we throw some angle braces and ampersands in there?

    <div class="footer">
        &copy; 2004 Foo Corporation
    </div>

Set in stone
------------

Preformatted blocks are useful for ASCII art:

<pre>
             ,-.
    ,     ,-.   ,-.
   / \   (   )-(   )
   \ |  ,.>-(   )-<
    \|,' (   )-(   )
     Y ___`-'   `-'
     |/__/   `-'
     |
     |
     |    -hrr-
  ___|_____________
</pre>

Playing the blame game
----------------------

If you need to blame someone, the best way to do so is by quoting them:

> I, at any rate, am convinced that He does not throw dice.

Or perhaps someone a little less eloquent:

> I wish you'd have given me this written question ahead of time so I
> could plan for it... I'm sure something will pop into my head here in
> the midst of this press conference, with all the pressure of trying to
> come up with answer, but it hadn't yet...
>
> I don't want to sound like
> I have made no mistakes. I'm confident I have. I just haven't - you
> just put me under the spot here, and maybe I'm not as quick on my feet
> as I should be in coming up with one.

Table for two
-------------

<table>
  <tr>
    <th>ID</th><th>Name</th><th>Rank</th>
  </tr>
  <tr>
    <td>1</td><td>Tom Preston-Werner</td><td>Awesome</td>
  </tr>
  <tr>
    <td>2</td><td>Albert Einstein</td><td>Nearly as awesome</td>
  </tr>
</table>

Crazy linking action
--------------------

I get 10 times more traffic from [Google] [1] than from
[Yahoo] [2] or [MSN] [3].

  [1]: http://google.com/        "Google"
  [2]: http://search.yahoo.com/  "Yahoo Search"
  [3]: http://search.msn.com/    "MSN Search"

---
## [ggfolks/demo](https://github.com/ggfolks/demo)@[70c75c0817...](https://github.com/ggfolks/demo/commit/70c75c0817db4e93d18f9bf42a0f6b76e041029f)
#### Thursday 2020-02-20 02:02:50 by Ray J. Greenwell

Add some more info to tower dialogs.

Also:
I already found a fucked-up case where a train gets jammed because wind
blows you out of your imprinted location and then you try to go back to
it. Following towers can't also go to that location because the lead is
there again. Perhaps in that case I fall back to ignoring the imprint
and instead using the leading tower's current location?

But weird shit like that will make it frustrating to try to build a
mental model of what's going on. I'll think about it.

---
## [PranaliBhosale/DataViz](https://github.com/PranaliBhosale/DataViz)@[1ad6430a6b...](https://github.com/PranaliBhosale/DataViz/commit/1ad6430a6b32e9752f84f84cb0630642f0ddca75)
#### Thursday 2020-02-20 02:22:32 by PranaliBhosale

DBLP Data using SQL connection

DBLP database of bibliographic information on major computer science
journals and proceedings, available from https://data.mendeley.com/datasets/3p9w84t5mr. The dataset has
been processed to include predictions of the author’s genders using the open-source Genderize API. The
processed data has been made available in the form of SQL scripts that import the data into a MySQL
database. We are primarily interested in the “general” and “authors” tables created by the “main.sql” and
“authors.sql” scripts, respectively.

Problem 1
Filter the data to include only the authors for whom a gender was predicted as ‘male’ or ‘female’ with a
probability of 0.90 or greater, and then create a bar plot showing the total number of distinct male and
female authors published each year. Comment on the visualization.

Problem 2
Still including only the authors for whom a gender was predicted with a probability of 0.90 or greater, create
a stacked bar plot showing the proportions of distinct male authors vs. distinct female authors published each
year. (The stacked bars for each year will sum to one.) Comment on the visualization.

Problem 3
Still including only the authors for whom a gender was predicted with a probability of 0.90 or greater, create
a faceted bar plots showing the proportions of female first authorships for each year for each domain (CS, DE,
SE, and TH). (If a conference belongs to multiple domains, you may include it for both of them.) Comment
on the visualization. Which domains have the highest and lowest representation of papers with female first
authors?

---
## [ethanwilloner/kernel-workspace](https://github.com/ethanwilloner/kernel-workspace)@[ab44ce900d...](https://github.com/ethanwilloner/kernel-workspace/commit/ab44ce900d631ea6c296a1b5f24831f7725007c2)
#### Thursday 2020-02-20 06:06:03 by Ethan Willoner

Added more flags, and some dependency fixups, to the Makefile.
Improved the qemu gdb debugging, plus got to hate my life for a night
trying to work aroung gdb's inability to find the vmlinux-gdb.py file
even when it's pointed right at it.

---
## [mrakgr/The-Spiral-Language](https://github.com/mrakgr/The-Spiral-Language)@[42101b8b69...](https://github.com/mrakgr/The-Spiral-Language/commit/42101b8b69bc5e37f3e038aa9899c87363aafb2d)
#### Thursday 2020-02-20 10:53:16 by Marko Grdinić

"9:40am. Got up 10m ago and am just chilling.

Let me do my reading and then I will start. I haven't gotten much in terms of replies on the PL sub, so from that I am sure that I am not well grounded at the moment. It is not my imagination that this is overly difficult. And the reason for that is my lack of webdev knowledge.

I've definitely looking down too much on webdev. Sure, JS is shit, but ultimately webdev is about communication. Communicating processes, communicating nodes, communicating servers...web shit is what floats at the top. At the bottom is what I actually need to understand which is asynchronous communication.

10:20am. Ok, enough slacking. Though I feel like just gathering my will rather than diving into the book right away.

Let me just say, I really botched the last ten days. I've been really stubborn on finding a good template. I've been resolved to make the plugin, but I had not been resolved to necessarily dive into the far end of webdev.

But I should have known, though servers are used for web, they do not have to be in any language specifically. It is just that the context they are in clearly highlights their need. So that is where they came into being.

10:30am. I've been resolved to end it in a week or two, but now that I've failed I am resolved to have this take months. That is what failure usually looks like for me.

10:35am. Ahhh...I do not feel like going through this quickly. I guess Spiral will get done when it wants to be done. What I will do now is go back to 2015, and turn on the study mode again.

10:40am. Enough dwelling on this. Let me give chapter one a try again.

Oh yes. It occurred to me during the night, but I forgot about it till now. What I will be studying here will be related to the interface creation mission once I have the agents ready. I find it ironic that I am doing this out of order, but nevertheless it is good that I am claiming these hidden benefits.

10:45am. Hmmm, VS Code is nearly 3Gb when fully unpacked on disk.

That is a lot of dependencies.

10:50am. Hmmm...I think I did a minimalist install of VS with just F# support. I think I'll have to get Typescript separately. Let me do so now.

11am. Ok, I've installed the typescript support for VS 2019, but where are the templates?

11:05am. Ah screw it. Though it is 3Gb let me get full webdev support.

I might as well take that break here.

11:50am. Let me put in a few words even though it is my break since I forgot to commit earlier. The thing installed and I see the ASP.NET template. There is such a template for F# as well, so I'll rather go with that than C#. Great. It is a nice touch from the devs to put the `new` icon to indicate the new additions to the VS instance.

There is nothing under Typescript itself for some reason. Well, the devs probably put it there as on option."

---
## [loot/oblivion](https://github.com/loot/oblivion)@[88dfbf6c81...](https://github.com/loot/oblivion/commit/88dfbf6c81ed2702cd007cf620dc5fba11e888c3)
#### Thursday 2020-02-20 14:21:02 by McSplody

Add locations for mods (#93)

28 Days and a Bit 4 ZOMBIES
A Blades house at Cloud Ruler Temple
A Bloody Night
A Change in Management
A Family Problem
A Not So Simple Cave Retreat
A Sorceress Love
A Strange Cave
A Witch Tale
A dense Epic Dungeon
AFK Tweaks
Abandoned Mountain Shack
Abu Emir 01
Adventurers: Oblivion
Aetheric Cuteblade
Ahtata argonian replacer HGEC
Akiviri Imports MOBS patch
Alastus
Alchemists Cave COBL
Ald-Khull
All in one Basement COBL
Alternative Entrances
Ancient Elven Sorcerer
Ancient Elven Sorceress
Ancient Ruins Ayleid Edition
Ancient Tree Home
Anvil Bay Expansion
Anvil Morning Glory
Anvil Townwall Castle
Aqua City
Arachnophobia
Arcane Services
Archers Range and Lodge
Archery Shop With All Arrows In The Game
Arena Alive
Arena Battle
Arena Loot by Angel
Arkshtrumz EV
Armageddon
Arrows of the Ayleid King
Artefacts of the Ancestors
Artifacts of Tamriel 300
Athletics Skill Increases While Riding
Auriels Retreat
Azuras Services
Bandit Hideouts
Bandits and Highwaymen without leveled items
Bane Oils Revisited
Basement for CObl
Beast Head Inn Quest
BeldaElysium ManorHouse and Quests
Benirus Manor Remade
Better Gray Fox
Better Inns & New Home Owners
BladeSong
Blades Smithy
Boss Fight Giant Problem
Boss Fight Stygian Halls
Boss Fight The Dismal Thicket
Bravil Docks
Brown Clydesdale Horse
Bruma Mages Guild Restored
Bury Corpse
CD Zombie Diversity
CDEP Underpall Cave
CM Partner Companion Jade a Tabaxi Cat
CM Partner Companion Kaleah
CM Partners Mod Basic
COBL Tweaks for Frans
CV Templar Castle
Cardac
Castle Arpenia
Castle Dunkerlore
Castle In The Mountain
Castle Legacy
Castlevania Mix Full Version
Cats and Rats
Cats for Tamriel Immersion Experience
Chameleon-NoRefraction
Chapter 1 The Dwarves Of The Mountain
Cheydinhal Petshop
Children Of Rourken Episode1 Secret of Enourk
Clamshell Cottage
Clintmichs Beautiful Arcane University
Clintmichs Beautiful Elven Gardens District
Clintmichs Beautiful Imperial City Arboretum
Clintmichs Beautiful Talos Plaza District
Clintmichs Improved Prison District
Clintmichs The Beautiful Market District
Clothing and Armor Replacer for Exnems Complete
Cloud City Project
Command your horse
Complete Mage Pack
Cyrodiil Border Regions
Cyrodiil NPCs Remodeling Project Bruma
Cyrodiil NPCs Remodeling Project Cheydinhal
Cyrodiil NPCs Remodeling Project Chorrol
Cyrodiil NPCs Remodeling Project Dark Brotherhood
Cyrodiil NPCs Remodeling Project Fighters Guild
Cyrodiil Transportation Network
DBs Static Quest Rewards
DMRA BBB Artifacts Complete
Daedric Armor of Darkness
Daggerfall NPCs
Dangerous Overhaul
Dapple Clydesdale Horse
Dark Brotherhood Outposts New Sanctuaries
Dark Brotherhood Sanctuary Rebuilt
Dark Mistress HGEC
Dark Quest
Darkness Hollows
Deepwood Adventures
Dibella Temple and Willow Lake Village
Diverse Legion Armor
Diverse Will o the Wisps
DrIstvaans poison mod
Dragon Captions - County Sutch - New Haven City
Dragon Captions - County Sutch - Sutch City
Dragon Captions County Kvatch Guard Towers
Dragon Invasion
Edhildils Underdark
Elven Garden Retreat
Elven district public baths
Emertxe
Enchanted Druid Treehome
Enhanced Quest Roleplaying
Evyrgry2
Exploring the Great Temple of Aerryanil
Extended Cyrodiil EV
FF Real Thirst Cobl
Faithless The Shadow of Faith
FineWeapons and RustyItems for OOO
Five Blind Mice
Flaming Nightmare
Forgotten Tomb
Forgrums Travelogue
Fort Nocturna Suppressio
Francesco Ore Refiner
Fuses Snail Racing
Gift Of Kynareth
Gold Smelting
HG Eyecandy Body Amazon Armor
HGEC Companion's Chainmail
HGEC D-cup Rogue armors
HGEC Sexy Ghost Armor
Hackdirt The Deep Ones
Halcyon Island
Haunted House
Haunted House Quest
Hentai Mania for OOO, MMM, FCOM
Hilltop Lodge
Holy Cathedral
Horse Armor Revamped
Horse Management
Horse Turn Speed Modular
ImpeREAL City Unique Districts
Imperial City Cave House
Imperial City Manor
Imperial Furniture
Imperial Horse Armor
Imperial Palace Armor
Indigo Armor for HG EyeCandy Body
KD Circlets OOO Optimized
Legion Shield Replacer
LexMiscClothesII for BAB UFF TGND
Lingerie Set for HGEC
Lost Relics of Tamriel
Luck Based Loot For Frans
MTC Dirtier Bandits
Mad Mages Tower
Markov Manor
Mighty Umbra
Mining Company
Mounted Combat OBSE
Mr Siikas Durzog
Mysterious Bears Power Animals
No Zombies Mod
OOO Lockfix
Oblivion Intensity
Oblivion Quest Of The Week
Oblivion Roleplaying Expansion
Oblivion War Cry New Dimension
Oblivion War Cry New Dimension
Oblivion WarCry 1.09 Full installation
Oddbasket Imperial Armor Replacement
Oddbasket's Glass Replacement for HGEC
Open Cities
Potion Sorter
ROM Revised Oblivion Mod
Ranokoas Organized Potions
Realistic Flora
Red Headed Gang Quest and Girl Companion MOD
Ruined Tails Tale
Ruins of Malamath
Rune Skulls
SIRMS (Shivering Isles Realistic Merchant Storage)
Safe Roads Dangerous Wilderness
Sagerbliv Creature Balance Fixes
Scribe Supplies
Secrets
Shadow Steed
Shadowcrest Vineyard
Sheogoraths Master Craft Mod 2 for MMM
Side's Backpacks
Slof's Black Unicorn
Slof's Oblivion Horses
Slof's Robe Trader
Stirk
Suliin Village
TESFU Book Collection
TIE4MODS
TJ_HorseNames
Talos Bridge Gatehouse
Tamriel Resource Exchange
Tamriel Snacks EV and DV
Tamriel Travellers
Tamriellic Glassworks
The Automagicon
The Blade of the Haunted
The Butcher
The Cave of Wishcraft
The Contented Prisoner
The Fight For Castle Ravenpride
The Gateway Realm
The Haunted Lair
The Hole
The Hoser Hut
The Hunt for Hazadirs Arms
The Imperial Waters
The Last Queen Of The Ayleids
The Living And The Dead
The Magic Realm of Araenya
The Order of the Dragon Patch Series
The Pirate Isles BETA
The city of Bjornheim
Thieves Guild Front Door Fix
Trade and Commerce
Trails of Cyrodiil by Malachi Delacot
Treasure Maps UL BC edition
UFF Amazon Armor
UFF Gold & Silver Daedric Armor
Universal Horse Armor
Unleveled shops
VAcuitys Spirits and Ephemerals
Velveteen For HGEC
Very Skimpy Stock Clothing Armor HGEC
WCGL - Wilderness Creatures List - Updated!
Waterfront Market
YAARM Steel and Blackwood armor HGEC
Zombie Slayer Armor HGEC

---
## [olysonek/tuned](https://github.com/olysonek/tuned)@[13a0a6d37f...](https://github.com/olysonek/tuned/commit/13a0a6d37f6e7b8b66828d3eadf3b955191ec674)
#### Thursday 2020-02-20 16:21:32 by Ondřej Lysoněk

WIP: Add a new file access API

The API is meant to be a replacement for commands.read_file() and
commands.write_to_file().

The new API allows us to log each read and write. At the same time, it
allows the callers to react to different errors that the read/write
operation can result in.

It also allows the callers to log more user-friendly messages - no more
messages like "writing to file foobar failed: Permission denied", that
may not be understandable to a regular user. Instead, we can log more
high-level messages like "Failed to set parameter X to Y: Permission
denied". The actual files that were accessed can still be logged using
the API, however these messages are meant to be debug messages. I.e.,
the 'log_func' argument to FileHandler should be something like
log.debug.

The new API also allows us to test its callers in a better way and
more easily, by replacing the FileOperations class with a mock
implementation that doesn't access real files. Also, the API itself is
very nicely testable, see the included tests.

Another advantage of the new API is that it's separate from the
overcrowded 'commands' class which violates the Single Responsibility
Principle.

The old API provided several features that the new API doesn't provide:
1. The 'makedir' argument to write_to_file() that can be used to create
   directories on the path to the file being written. While having this
   functionality is kind of nice, it's not worth polluting the API with
   an extra parameter that is set to True only twice in the entire
   codebase (one occurence being in tests).
2. The 'no_error' argument, which can be used to suppress logging error
   messages. The same effect ((*) and better) can be achieved by not
   providing 'log_error_func' to the new API.
   (*) The old API is kind of silly in that if no_error == True and an
   error happens, debug log messages about reading/writing to the file
   are still logged, however no messages of any kind regarding the error
   that happened are logged.
3. The 'err_ret' argument to read_file which can be used to obtain a
   default value if reading the file fails. The existence of this
   feature is nothing but laziness to write exception handlers IMHO.
   It's not that hard to write exception handlers, and having them
   results in more readable code, so please, let's just drop this
   feature.

TODO: document the API

Open questions:
1. Can we come up with better names for FileOperations and FileHandler?
2. Should we split up FileHandler into FileReader and FileWriter?

Signed-off-by: Ondřej Lysoněk <olysonek@redhat.com>

---
## [LightingResearchCenter/HealthyLiving](https://github.com/LightingResearchCenter/HealthyLiving)@[9cc17cb2a4...](https://github.com/LightingResearchCenter/HealthyLiving/commit/9cc17cb2a44698148ab459e94bade69f61650ebe)
#### Thursday 2020-02-20 16:27:40 by MichaelvMorrison

School>Classroom>Combo> 3000 K Morning, Afternoon, Evening/Night render wrong-- they are using the 6500 K render woops

---
## [richard-lane/ex3](https://github.com/richard-lane/ex3)@[427371a3fc...](https://github.com/richard-lane/ex3/commit/427371a3fc7fdae922a0ba3f43e98482fefb3362)
#### Thursday 2020-02-20 16:27:45 by Richard Lane

Squashed commit of the following:

commit d1f87b70076509d9c47a9663d35245e572273621
Author: Richard Lane <richard.lane@bristol.ac.uk>
Date:   Thu Feb 20 16:27:21 2020 +0000

    stupid idiot curve fitting

commit f645bbddb12d9d513b43b9e00c43fcf9db3f8411
Author: Richard Lane <richard.lane@bristol.ac.uk>
Date:   Thu Feb 20 15:31:09 2020 +0000

    overlay our hists with the expected sin curve

commit 8c405fc4c0b0b1578a30f30ae537f1746262ca05
Author: Richard Lane <richard.lane@bristol.ac.uk>
Date:   Thu Feb 20 14:50:29 2020 +0000

    function for timing two different methods

commit 5854bd38687368c943691a8e9054c90c2778ebb7
Author: Richard Lane <richard.lane@bristol.ac.uk>
Date:   Thu Feb 20 14:06:02 2020 +0000

    function for q1a

commit 70cede5530461483ea726667bdccff222e039788
Author: Richard Lane <richard.lane@bristol.ac.uk>
Date:   Thu Feb 20 14:01:10 2020 +0000

    accept-reject and analytical distribution generation

---
## [C-Cracks/SSH-BruteForce](https://github.com/C-Cracks/SSH-BruteForce)@[88129012d2...](https://github.com/C-Cracks/SSH-BruteForce/commit/88129012d259ec6b74a0a8c7ee19c5166427430d)
#### Thursday 2020-02-20 17:48:19 by C-Cracks

A lack of the module pyfiglet no longer halts execution of the program and made some minor changes to the output produced for a valid result- discovered my university's Python module requires students to write an SSH brute force script so yeah... Gotta love those weird coincidences. :')

---
## [BlackDragon038/Valr](https://github.com/BlackDragon038/Valr)@[cd6502dcc8...](https://github.com/BlackDragon038/Valr/commit/cd6502dcc8c6723bca6400fef56fd8dae2cdd9e1)
#### Thursday 2020-02-20 19:49:26 by Sultan Iljasov

Just too many changes to list, check description.

I'll just be as brief as possible since there are way too many changes to recall.

* Finally added some sort of machine learning driven AI. It's still stupid as all hell and doesn't work properly whatsoever, but this is very, veeeery early stages.

* Added new particle effects.

* Added menus.

* Added new music.

* Added a new stage inspired by Medieval times.

* Added a new actor component for debugging attacks.

* Fixed a ridiculous amount of bugs... So. Many. Bugs. Finally over...

* Made adjustments to gameplay: You can no longer move away from center indefinetly. You'll eventually be stopped.

---
## [facebookexperimental/eden](https://github.com/facebookexperimental/eden)@[4a29fe400d...](https://github.com/facebookexperimental/eden/commit/4a29fe400da21c0e9644d01a58c4b581ae6d3a6d)
#### Thursday 2020-02-20 20:27:01 by Thomas Orozco

mononoke/blobstore_healer: migrate replication lag polling to async / await

Summary:
The former implementation here was a little difficult to work with, and
resulted in a whole lot of cloning of closures, etc.

This updates the implementation to be a little simpler on the whole (async /
await is nicer for while loops, since you can use, well, loops)

It does slightly change a few parts of the behavior:

- The old implementation would wait for the replication lag duration. That's
  not really correct. As we've observed several time this weeks, replication
  lag usually drops quickly once it starts dropping. I.e. if the replication
  lag is 10 seconds, it doesn't take 10 seconds to catch up. This gets more
  important with big lag durations.
- I updated replication lag to be u64 instead of usize. usize doesn't really
  make sense for something that has absolutely nothing to do with our pointer
  size.

I also split out the logic for calculating how long we wait in a part that
cares about whether we are busy and one that cares about replication lag
(whereas the older one kinda mixed the two together). We wait for our own
throttling (i.e. sleep for a sec if we didn't do anything) before we wait for
replication lag, so the new behavior should have the desired behavior of:

- If we don't have much work to do, we sleep 1 second between each iteration
  (but if we do have work, we don't).
- No matter what, if we have replication lag, we wait until that passes before
  doing any work.

The old one did that too, but it mixed the two calculations together, and was
(at least in my opinion) kinda hard to reason about as a result.

Reviewed By: StanislavGlebik

Differential Revision: D19997587

fbshipit-source-id: 1de6a9f9c1ecb56e26c304d32b907103b47b4728

---
## [gmcgibbon/rails](https://github.com/gmcgibbon/rails)@[a2a525bbb6...](https://github.com/gmcgibbon/rails/commit/a2a525bbb622849fa73802cb489679d3d4cadc1d)
#### Thursday 2020-02-20 23:18:34 by eileencodes

Add an intermediary called RoleManager to manage connections

This PR is an alternate solution to #37388. While there are benefits
to merging #37388 it changes the public API and swaps around existing
concepts for how connection management works. The changes are
backwards-incompatible and pretty major. This will have a negative impact
on gems and applications relying on how conn management currently works.

**Background:**

Shopify and other applications need sharding but Rails has
made it impossible to do this because a handler can only hold one
connection pool per class. Sharded apps need to hold multiple
connections per handler per class.

This PR aims to solve only that problem.

**What this PR does:**

In this PR we've added a `RoleManager` class that can hold multiple
`Roles`. Each `Role` holds the `db_config`,
`connection_specification_name`, `schema_cache` and `pool`. By default
the `RoleManager` holds a single reference from a `default` key to the
`Role` instance. A sharded/multi-tenant app can pass an optional second
argument to `remove_connection`, `retrieve_connection_pool`,
`establish_connection` and `connected?` on the handler, thus allowing
for multiple connections belonging to the same class/handler without
breaking backwards compatibility.

By using the `RoleManager` we can avoid altering the public API, moving
around handler/role concepts, and achieve the internal needs for
establishing multiple connections per handler per class.

**A note about why we opened this PR:**

We very much appreciate the work that went into #37388 and in no way mean
to diminish that work. However, it breaks the following public APIs:

* `#retrieve_connection`, `#connected?`, and `#remove_connection` are
public methods on handler and can't be changed from taking a spec to a
role.
* The knowledge that the handler keys are symbols relating to a role
(`:writing`/`:reading`) is public - changing how handlers are accessed
will break apps/libraries.

In addition it doesn't solve the problem of mapping a single connection
to a single class since it has a 1:1 mapping of `class (handler) -> role
(writing) -> db_config`. Multiple pools in a writing role can't exist
in that implementation.

The new PR solves this by using the `RoleManager` to hold multiple connection
objects for the same class. This lets a handler hold a role manager
which can hold as many roles for that writer as the app needs.

**Regarding the `Role` name:**

When I originally designed the API for multiple databases, it wasn't
accidental that handler and role are the same concept. Handler is the
internal concept (since that's what was there already) and Role was the
public external concept. Meaning, role and handler were meant to
be the same thing. The concept here means that when you switch a
handler/role, Rails automatically can pick up the connection on the
other role by knowing the specification name. Changing this would mean not
just that we need to rework how GitHub and many many gems work, but also
means retraining users of Rails 6.0 that all these concepts changed.

Since this PR doesn't move around the concepts in connection
management and instead creates an intermediary between `handler` and
`role` to manage the connection data (`db_config`, `schema_cache`,
`pool`, and `connection_specification`) we think that `Role` and
`RoleManager` are the wrong name.

We didn't change it yet in this PR because we wanted to keep change
churn low for initial review. We also haven't come up with a better
name yet. :smile:

**What this PR does not solve:**

Our PR here solves a small portion of the problem - it allows models to
have multiple connections on a class. It doesn't aim to solve any other
problems than that. Going forward we'll need to still solve the
following problems:

* `DatabaseConfig` doesn't support a sharding configuration
* `connects_to`/`connected_to` still needs a way to switch connections for shards
* Automatic switching of shards
* `connection_specification_name` still exists

**The End**

Thanks for reading this far. These problems aren't easy to solve. John
and I spent a lot of time trying different things and so I hope that
this doesn't come across as if we think we know better. I would have
commented on the other PR what changes to make but we needed to try out
different solutions in order to get here.

Ultimately we're aiming to change as little as the API as possible. Even
if the handler/role -> manager -> db_config/pool/etc isn't how we'd
design connection management if we could start over, we also don't want
to break public APIs. It's important that we make things better while
maintaining compatibility.

The `RoleManager` class makes it possible for us to fix the underlying
problem while maintaining all the backwards compatibility in the public
API.

We all have the same goal; to add sharding support to Rails. Let me know
your thoughts on this change in lieu of #37388 and if you have questions.

Co-authored-by: John Crepezzi <seejohnrun@github.com>

---
## [AlexeyGorbunov72/Erectus-ios-app](https://github.com/AlexeyGorbunov72/Erectus-ios-app)@[5acb0de07d...](https://github.com/AlexeyGorbunov72/Erectus-ios-app/commit/5acb0de07df193ad2b9d0ab718149baad9dd3b14)
#### Thursday 2020-02-20 23:35:21 by Retard

since this moment in my life.... i use fucken core data, because I'm fucken reterd, so i don't knew how to do lister for realm, so core data is best stuff in my life
hope i will die in agony...

---

# [<](2020-02-19.md) 2020-02-20 [>](2020-02-21.md)

