# [<](2020-09-23.md) 2020-09-24 [>](2020-09-25.md)

2,674,954 events, 1,352,048 push events, 2,110,978 commit messages, 151,739,121 characters


## [Jasper-27/JBot](https://github.com/Jasper-27/JBot)@[a21cf60fa1...](https://github.com/Jasper-27/JBot/commit/a21cf60fa166df186740387a0356317868633181)
#### Thursday 2020-09-24 00:28:13 by Jasper Cox

fixed the fuck you to use the client id, not a hardcoded value

---
## [FFY00/dbus-objects](https://github.com/FFY00/dbus-objects)@[ee5706b443...](https://github.com/FFY00/dbus-objects/commit/ee5706b443fbae2cf07490d83112564879f100e3)
#### Thursday 2020-09-24 03:03:28 by Filipe LaÃ­ns

major refactoring

I hate myself for dumping this massive patch, so please forgive me.

I have been working on this on/off for a few months now, with a big
summer-sized hole in the middle. The code has become too much
intertwined and would be a PITA to have proper segmented patches. As I
am the only contributor, I guess no one will mind Â¯\_(ãƒ„)_/Â¯.

This _massive_ patch mainly reworks the DBusServerBase and uses treelib
to save the server topology and implements the XML introspection.

Signed-off-by: Filipe LaÃ­ns <lains@archlinux.org>

---
## [fedarko/empress](https://github.com/fedarko/empress)@[766158eaf4...](https://github.com/fedarko/empress/commit/766158eaf456d9239ed5bec51277d5a6daab9d26)
#### Thursday 2020-09-24 03:19:15 by Marcus Fedarko

MNT: add explicit padding to right side of cat SVG

it looks like things are the opposite from how i thought -- looks like
the perceived extra space was just due to the boldfont used in
estimating the texts (when you make the text bold it's almost snug
with the border on the right side). may as well add the same padding
as for the continuous legends so things look consistent ish.

Still, this leaves it kinda unclear as to why continuous legends were
so comparatively snug with the border until i added padding ... maybe
boldface numbers are just not that bigger? idk

UPDATE: yeah i checked it and bold numbers are basically the same size
but bold letters are much larger. mystery solved :100:

---
## [garbageslam/aligned](https://github.com/garbageslam/aligned)@[84fa8f9c31...](https://github.com/garbageslam/aligned/commit/84fa8f9c31f31bc1e36579ca6fc84997af3e3af9)
#### Thursday 2020-09-24 03:47:29 by Chris Beck

Add features to integrate with generic_array crate

In a project, I have to manipulate large aligned arrays of bytes
and manipulate them in various ways very quickly. Right now the only way
to really do that in generic code in rust is to use `generic_array` AFAIK,
and const generics are still a long way off. Initially the thing I wanted was
to make `generic_array::Slice` API work without losing alignment information.
There was no way to do that without adding code to the `aligned` crate
due to the orphan rules, so that was what I did. I found that it worked
really well for me.

It's possible that this code should not be in `aligned` crate, and
instead it should be in `generic_array` crate, which should depend
on `aligned`. But at present that's unworkable because `aligned`
depends on `as_slice`, and `as_slice` depends on `generic_array`.
So if `generic_array` depends on `aligned` we get a circular dependency.
We could resolve this by first making `generic_array` depend on `as_slice`
rather than the reverse, but that's a larger project.

Later, I added more helpful functionality extending the
`aligned` + `generic_array` integration idea:
- `AsAlignedChunks` allows to iterate over an aligned array in
  a manner similar to `chunks` API on the slice type, but preseving
  the alignment information.
- `AsNeSlice` allows to convert a ref to aligned bytes to a ref
  aligned integer types like `u32` and `u64`. Without alignment
  information this isn't possible with copies of course, but when
  we have alignment info we can convert to native-endian integers
  without copying. It's not uncommon to have to do this in low-level
  code and I found having a simple, safe API for this helpful.

Both of these were really helpful for my project, because it means that
the crates using these calls can deny unsafe code, when otherwise
they would have dozens of unsafe calls.

There was also some other minor stuff:
- `Aligned<A4, _>` implements `AsRef<Aligned<A2, _>>` and so on.
  To do this, I added an associated type to `sealed::Alignment` type,
  which is the `typenum` corresponding to the alignment value.
  This doesn't become part of the public API and makes it straightforward
  to implement the trait bounds for these APIs. `typenum` is in many ways
  annoying, but I don't know any real alternative, and it is the basis
  of `generic_array` anyways.
- I added `A32` and `A64` type to this crate. The reason I did that is
  that some AVX2 instructions require 32-byte alignment and some
  AVX512 instructions require 64-byte alignment and I need to use them.
- When I looked at the diff, I realized I added `repr(C)` to the `A` types,
  I think I did that because I thought there might be some rule that
  everything in the struct is transitively `repr(C)`. But now I think
  I might be wrong about that, or at least I can't find evidence.
  But anyways it seems like it can't hurt. Let me know what you think.
- I marked many functions `#[inline]`, because in my understanding,
  rust is not permitted to inline across crate boundaries unless that
  annotation is there, and many of these functions should ideally be
  completely transparent to the optimizer. Let me know what you think
  about that.

So, this is somewhat a significant extension of the crate.
I'm not sure if you'll agree with the direction here -- let me
know what you think. I'd love to find a way to get this code into
either `aligned` or `generic_array` or split among both crates,
because I think much of it needs to be in one of those two places
due to orphan rules.

There are also some TODO's that I marked, but you should give me
direction there what you think is best. Thanks

---
## [eErenYeager/android_kernel_cyanogen_msm8916](https://github.com/eErenYeager/android_kernel_cyanogen_msm8916)@[ee8af2b2cf...](https://github.com/eErenYeager/android_kernel_cyanogen_msm8916/commit/ee8af2b2cf37f9766142b00671c2979eaff3a0b1)
#### Thursday 2020-09-24 07:14:34 by Shoaib0597

Introduce Quick Charge v1.0

Signed-off-by: Shoaib0597 <Shoaib0595@gmail.com>

First of all, I would like to thank Varun Chitre for Developing a Great Fast-Charge Driver i.e., ThunderCharge for Tomato(+) Devices. Before this Driver, the Charging Time of Tomato(+) Devices was very long, sometimes even exceeding 2 and a Half-Hours! However, with the Introduction of ThunderCharge, this Slow-Charging issue was Solved. So, Thank You Varun Chitre for your Wonderful Contribution.

Now, in ThunderCharge, I observed a Potential to Achieve even More Efficiency while Charging. In my opinion, ThunderCharge suffers from the following Problems---
1. A Constant Current (mA) is Forced at all the Times of Charging without any Attention to Battery Status.
2. The above Method, I think, proves Quite Dangerous if Higher Values of Current (mA) are used because the Current (mA) remains Constant throughout the Charge-Cycle.
3. All of this creates a rigidness in the Driver and thus, Higher Values of Current (mA) are rarely used because of Probable Damage to Hardware.
4. Since all the Tomato(+) Devices suffer from Over-Heating issues, Forcing a Constant Current (mA) at all the Times of Charging may Prove Very Dangerous.

To Fix these issues, I decided to Alter the Mechanism of ThunderCharge Current Control Driver. As you all know, Qualcomm's Quick-Charge Technology Charges the Phones Quite Fast. In order to achieve this, the Battery is first Charged upto a certain % with the Max. Supported Current (mA), then the Value of Current (mA) is Dropped Gradually as the Battery nears 100%. As per the Explaination of this Technology, this is done to Avoid Damage to the Battery and Keep the Temperatures in Check. Apparently, Charging the Battery at a Constant High Current (mA) when the Battery is about to get Fully Charged, is very Dangerous and Degrades the Battery-Life quickly.

On the Basis of such Information and Technique, I have Altered the Working of ThunderCharge and turned this into a New Driver called Quick Charge v1.0. Moreover, I have Removed most of the sysFS Controls too as they are no longer Required.

Explaination of the Working of Quick Charge v1.0, developed by Shoaib Anwar a.k.a. Shoaib0597---
Battery (%)				Current (mA)
0-60					1500 (Max. Supported as per DTB)
61-90					1250
91-100					1000 (Standard Output)

Notes---
-This is NOT the Original Quick Charge v1.0 Technology from Qualcomm. I have just used the Name because the Working/Mechanism is Similar.
-The Stock Hardware doesn't supports Qualcomm's Quick Charge v1.0 Technology.
-Thus, the Charging Speed won't be as Fast as Qualcomm's Quick Charge v1.0.
-However, the Charging Speed will be the Fastest Possible on the Stock Hardware.
-In other words, this Driver is an Improved Version of ThunderCharge and Offers the Best Possible Experience and Efficiency.

---
## [civicrm/composer-compile-plugin](https://github.com/civicrm/composer-compile-plugin)@[35bd4fa3d1...](https://github.com/civicrm/composer-compile-plugin/commit/35bd4fa3d1dbc38ce7fb8a6df6b0eff1b8b18ab8)
#### Thursday 2020-09-24 09:35:29 by Tim Otten

Task specification - Convert 'php-method'/'shell' fields to 'run' field

This a notable change in the schema.

* Before: `{"shell": "cat js/{one,two,three}.js > all.js"}`
* After: `{"run": "@sh cat js/{one,two,three}.js > all.js"}`

(Note: The old notation is merely deprecated.  It still works and is still
used in the test-suites.)

This change arises from the following milieu:

- Watch lists
    - USE CASE: Suppose you have multiple steps in a compilation process,
      and suppose they're closely related.
    - BEFORE: You must make each step a separate task.  However, to make
      'compile:watch' work nicely, you'd have to declare 'watch-files' in
      every task.  That starts to feel silly.
    - AFTER: You can create one task with multiple 'run' elements, but
      you only need one watch-list.

- Mixed mode
    - Based on the watch-list problem, I initially tried expanding 'php-method'
      and 'shell' to accept a list of php-methods or a list of shell-commands.
      But that did not allow one task to have multiple *types* of steps.

- Upstream composer-scripts
    - In upstream, the 'scripts' may be defined with multiple actions,
      each one can use a prefix like `@php` or `@composer`.

- Package location/lookup
    - Suppose you want to reference a file/input provided by an upstream
      package.  Given all the futzing people can do in the root package, you
      don't know where it's located.  How can we pass that information from
      composer down to your package?
    - An environment variable would be appealing. But there can be a lot
      of packages, and their paths can be long, and system-limits on env-vars
      vary widely by platform. Consequently, we can't pre-emptively export
      all that info via env-vars.
    - I experimented with doing a lazy-export (e.g.  only export if the
      variable is referenced), but this only worked for sh that was directly
      embedded -- not for php-methods or sh subscripts.
    - We can take some inspiration from composer's `@putenv` - ie in the list
      of tasks, define a task for exporting the info.
    - This is not implemented right now, but it's another reason to prefer
      the model here.

---
## [Boos4721/op6_kernel](https://github.com/Boos4721/op6_kernel)@[99f3fd7bda...](https://github.com/Boos4721/op6_kernel/commit/99f3fd7bdadc833e80e01401783eb7c1c8f2f5bc)
#### Thursday 2020-09-24 09:42:08 by Nathan Chancellor

Merge 4.9.233 into oneplus/SDM845_Q_10.0

Changes in 4.9.233: (211 commits)
        xfs: catch inode allocation state mismatch corruption
        xfs: validate cached inodes are free when allocated
        xfs: don't call xfs_da_shrink_inode with NULL bp
        net: phy: mdio-bcm-unimac: fix potential NULL dereference in unimac_mdio_probe()
        crypto: ccp - Release all allocated memory if sha type is invalid
        media: rc: prevent memory leak in cx23888_ir_probe
        ath9k_htc: release allocated buffer if timed out
        ath9k: release allocated buffer if timed out
        PCI/ASPM: Disable ASPM on ASMedia ASM1083/1085 PCIe-to-PCI bridge
        ARM: 8986/1: hw_breakpoint: Don't invoke overflow handler on uaccess watchpoints
        drm/amdgpu: Prevent kernel-infoleak in amdgpu_info_ioctl()
        drm: hold gem reference until object is no longer accessed
        f2fs: check memory boundary by insane namelen
        f2fs: check if file namelen exceeds max value
        9p/trans_fd: abort p9_read_work if req status changed
        9p/trans_fd: Fix concurrency del of req_list in p9_fd_cancelled/p9_read_work
        x86/build/lto: Fix truncated .bss with -fdata-sections
        x86, vmlinux.lds: Page-align end of ..page_aligned sections
        fbdev: Detect integer underflow at "struct fbcon_ops"->clear_margins.
        rds: Prevent kernel-infoleak in rds_notify_queue_get()
        xfs: fix missed wakeup on l_flush_wait
        uapi: includes linux/types.h before exporting files
        install several missing uapi headers
        net/x25: Fix x25_neigh refcnt leak when x25 disconnect
        net/x25: Fix null-ptr-deref in x25_disconnect
        sh: Fix validation of system call number
        net: lan78xx: add missing endpoint sanity check
        net: lan78xx: fix transfer-buffer memory leak
        mlx4: disable device on shutdown
        mlxsw: core: Increase scope of RCU read-side critical section
        mlxsw: core: Free EMAD transactions using kfree_rcu()
        ibmvnic: Fix IRQ mapping disposal in error path
        mac80211: mesh: Free ie data when leaving mesh
        mac80211: mesh: Free pending skb when destroying a mpath
        arm64: csum: Fix handling of bad packets
        usb: hso: Fix debug compile warning on sparc32
        qed: Disable "MFW indication via attention" SPAM every 5 minutes
        nfc: s3fwrn5: add missing release on skb in s3fwrn5_recv_frame
        parisc: add support for cmpxchg on u8 pointers
        net: ethernet: ravb: exit if re-initialization fails in tx timeout
        Revert "i2c: cadence: Fix the hold bit setting"
        xen-netfront: fix potential deadlock in xennet_remove()
        KVM: LAPIC: Prevent setting the tscdeadline timer if the lapic is hw disabled
        x86/i8259: Use printk_deferred() to prevent deadlock
        random32: update the net random state on interrupt and activity
        ARM: percpu.h: fix build error
        random: fix circular include dependency on arm64 after addition of percpu.h
        random32: remove net_rand_state from the latent entropy gcc plugin
        random32: move the pseudo-random 32-bit definitions to prandom.h
        ext4: fix direct I/O read error
        USB: serial: qcserial: add EM7305 QDL product ID
        net/mlx5e: Don't support phys switch id if not in switchdev mode
        ALSA: seq: oss: Serialize ioctls
        Bluetooth: Fix slab-out-of-bounds read in hci_extended_inquiry_result_evt()
        Bluetooth: Prevent out-of-bounds read in hci_inquiry_result_evt()
        Bluetooth: Prevent out-of-bounds read in hci_inquiry_result_with_rssi_evt()
        omapfb: dss: Fix max fclk divider for omap36xx
        vgacon: Fix for missing check in scrollback handling
        mtd: properly check all write ioctls for permissions
        leds: wm831x-status: fix use-after-free on unbind
        leds: da903x: fix use-after-free on unbind
        leds: lm3533: fix use-after-free on unbind
        leds: 88pm860x: fix use-after-free on unbind
        net/9p: validate fds in p9_fd_open
        drm/nouveau/fbcon: fix module unload when fbcon init has failed for some reason
        cfg80211: check vendor command doit pointer before use
        igb: reinit_locked() should be called with rtnl_lock
        atm: fix atm_dev refcnt leaks in atmtcp_remove_persistent
        tools lib traceevent: Fix memory leak in process_dynamic_array_len
        xattr: break delegations in {set,remove}xattr
        binder: Prevent context manager from incrementing ref 0
        ipv4: Silence suspicious RCU usage warning
        ipv6: fix memory leaks on IPV6_ADDRFORM path
        vxlan: Ensure FDB dump is performed under RCU
        net: lan78xx: replace bogus endpoint lookup
        Revert "vxlan: fix tos value before xmit"
        usb: hso: check for return value in hso_serial_common_create()
        Smack: fix use-after-free in smk_write_relabel_self()
        tracepoint: Mark __tracepoint_string's __used
        gpio: fix oops resulting from calling of_get_named_gpio(NULL, ...)
        cgroup: add missing skcd->no_refcnt check in cgroup_sk_clone()
        EDAC: Fix reference count leaks
        arm64: dts: qcom: msm8916: Replace invalid bias-pull-none property
        arm64: dts: exynos: Fix silent hang after boot on Espresso
        m68k: mac: Don't send IOP message until channel is idle
        m68k: mac: Fix IOP status/control register writes
        platform/x86: intel-hid: Fix return value check in check_acpi_dev()
        platform/x86: intel-vbtn: Fix return value check in check_acpi_dev()
        ARM: at91: pm: add missing put_device() call in at91_pm_sram_init()
        ARM: socfpga: PM: add missing put_device() call in socfpga_setup_ocram_self_refresh()
        drm/tilcdc: fix leak & null ref in panel_connector_get_modes
        Bluetooth: add a mutex lock to avoid UAF in do_enale_set
        fs/btrfs: Add cond_resched() for try_release_extent_mapping() stalls
        drm/radeon: Fix reference count leaks caused by pm_runtime_get_sync
        video: fbdev: neofb: fix memory leak in neo_scan_monitor()
        md-cluster: fix wild pointer of unlock_all_bitmaps()
        drm/nouveau: fix multiple instances of reference count leaks
        drm/debugfs: fix plain echo to connector "force" attribute
        mm/mmap.c: Add cond_resched() for exit_mmap() CPU stalls
        brcmfmac: To fix Bss Info flag definition Bug
        iwlegacy: Check the return value of pcie_capability_read_*()
        usb: gadget: net2280: fix memory leak on probe error handling paths
        bdc: Fix bug causing crash after multiple disconnects
        dyndbg: fix a BUG_ON in ddebug_describe_flags
        bcache: fix super block seq numbers comparision in register_cache_set()
        ACPICA: Do not increment operation_region reference counts for field units
        agp/intel: Fix a memory leak on module initialisation failure
        video: fbdev: sm712fb: fix an issue about iounmap for a wrong address
        console: newport_con: fix an issue about leak related system resources
        video: pxafb: Fix the function used to balance a 'dma_alloc_coherent()' call
        iio: improve IIO_CONCENTRATION channel type description
        leds: lm355x: avoid enum conversion warning
        media: omap3isp: Add missed v4l2_ctrl_handler_free() for preview_init_entities()
        scsi: cumana_2: Fix different dev_id between request_irq() and free_irq()
        drm/mipi: use dcs write for mipi_dsi_dcs_set_tear_scanline
        cxl: Fix kobject memleak
        drm/radeon: fix array out-of-bounds read and write issues
        scsi: powertec: Fix different dev_id between request_irq() and free_irq()
        scsi: eesox: Fix different dev_id between request_irq() and free_irq()
        media: firewire: Using uninitialized values in node_probe()
        media: exynos4-is: Add missed check for pinctrl_lookup_state()
        xfs: fix reflink quota reservation accounting error
        PCI: Fix pci_cfg_wait queue locking problem
        leds: core: Flush scheduled work for system suspend
        drm: panel: simple: Fix bpc for LG LB070WV8 panel
        scsi: scsi_debug: Add check for sdebug_max_queue during module init
        mwifiex: Prevent memory corruption handling keys
        powerpc/vdso: Fix vdso cpu truncation
        staging: rtl8192u: fix a dubious looking mask before a shift
        PCI/ASPM: Add missing newline in sysfs 'policy'
        drm/imx: tve: fix regulator_disable error path
        USB: serial: iuu_phoenix: fix led-activity helpers
        usb: dwc2: Fix error path in gadget registration
        scsi: mesh: Fix panic after host or bus reset
        Smack: fix another vsscanf out of bounds
        Smack: prevent underflow in smk_set_cipso()
        power: supply: check if calc_soc succeeded in pm860x_init_battery
        selftests/powerpc: Fix CPU affinity for child process
        selftests/powerpc: Fix online CPU selection
        s390/qeth: don't process empty bridge port events
        wl1251: fix always return 0 error
        net: spider_net: Fix the size used in a 'dma_free_coherent()' call
        fsl/fman: use 32-bit unsigned integer
        fsl/fman: fix dereference null return value
        fsl/fman: fix unreachable code
        fsl/fman: check dereferencing null pointer
        fsl/fman: fix eth hash table allocation
        dlm: Fix kobject memleak
        pinctrl-single: fix pcs_parse_pinconf() return value
        drivers/net/wan/lapbether: Added needed_headroom and a skb->len check
        net/nfc/rawsock.c: add CAP_NET_RAW check.
        net: Set fput_needed iff FDPUT_FPUT is set
        USB: serial: cp210x: re-enable auto-RTS on open
        USB: serial: cp210x: enable usb generic throttle/unthrottle
        ALSA: usb-audio: Creative USB X-Fi Pro SB1095 volume knob support
        ALSA: usb-audio: fix overeager device match for MacroSilicon MS2109
        ALSA: usb-audio: add quirk for Pioneer DDJ-RB
        crypto: qat - fix double free in qat_uclo_create_batch_init_list
        crypto: ccp - Fix use of merged scatterlists
        fs/minix: check return value of sb_getblk()
        fs/minix: don't allow getting deleted inodes
        fs/minix: reject too-large maximum file size
        ALSA: usb-audio: work around streaming quirk for MacroSilicon MS2109
        9p: Fix memory leak in v9fs_mount
        parisc: mask out enable and reserved bits from sba imask
        ARM: 8992/1: Fix unwind_frame for clang-built kernels
        xen/balloon: fix accounting in alloc_xenballooned_pages error path
        xen/balloon: make the balloon wait interruptible
        smb3: warn on confusing error scenario with sec=krb5
        PCI: hotplug: ACPI: Fix context refcounting in acpiphp_grab_context()
        btrfs: don't allocate anonymous block device for user invisible roots
        btrfs: only search for left_info if there is no right_info in try_merge_free_space
        btrfs: fix memory leaks after failure to lookup checksums during inode logging
        iio: dac: ad5592r: fix unbalanced mutex unlocks in ad5592r_read_raw()
        xtensa: fix xtensa_pmu_setup prototype
        powerpc: Fix circular dependency between percpu.h and mmu.h
        net: ethernet: stmmac: Disable hardware multicast filter
        net: stmmac: dwmac1000: provide multicast filter fallback
        net/compat: Add missing sock updates for SCM_RIGHTS
        md/raid5: Fix Force reconstruct-write io stuck in degraded raid5
        bcache: allocate meta data pages as compound pages
        mac80211: fix misplaced while instead of if
        MIPS: CPU#0 is not hotpluggable
        ext2: fix missing percpu_counter_inc
        ocfs2: change slot number type s16 to u16
        ftrace: Setup correct FTRACE_FL_REGS flags for module
        kprobes: Fix NULL pointer dereference at kprobe_ftrace_handler
        watchdog: f71808e_wdt: indicate WDIOF_CARDRESET support in watchdog_info.options
        watchdog: f71808e_wdt: remove use of wrong watchdog_info option
        watchdog: f71808e_wdt: clear watchdog timeout occurred flag
        pseries: Fix 64 bit logical memory block panic
        mfd: arizona: Ensure 32k clock is put on driver unbind and error
        USB: serial: ftdi_sio: make process-packet buffer unsigned
        USB: serial: ftdi_sio: clean up receive processing
        gpu: ipu-v3: image-convert: Combine rotate/no-rotate irq handlers
        iommu/omap: Check for failure of a call to omap_iommu_dump_ctx
        iommu/vt-d: Enforce PASID devTLB field mask
        i2c: rcar: slave: only send STOP event when we have been addressed
        clk: clk-atlas6: fix return value check in atlas6_clk_init()
        pwm: bcm-iproc: handle clk_get_rate() return
        Input: sentelic - fix error return when fsp_reg_write fails
        drm/vmwgfx: Fix two list_for_each loop exit tests
        net: qcom/emac: add missed clk_disable_unprepare in error path of emac_clks_phase1_init
        nfs: Fix getxattr kernel panic and memory overflow
        fs/ufs: avoid potential u32 multiplication overflow
        mfd: dln2: Run event handler loop under spinlock
        ALSA: echoaudio: Fix potential Oops in snd_echo_resume()
        sh: landisk: Add missing initialization of sh_io_port_base
        khugepaged: retract_page_tables() remember to test exit
        mm: Avoid calling build_all_zonelists_init under hotplug context
        Linux 4.9.233

Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>

Conflicts:
	drivers/android/binder.c
	fs/f2fs/dir.c
	include/uapi/drm/Kbuild
	include/uapi/linux/Kbuild

---
## [mrakgr/The-Spiral-Language](https://github.com/mrakgr/The-Spiral-Language)@[ec5ee5d0c5...](https://github.com/mrakgr/The-Spiral-Language/commit/ec5ee5d0c507b1079dfaafe6f5ea51254aa7def6)
#### Thursday 2020-09-24 10:38:21 by Marko GrdiniÄ‡

"9:55am. Today how about I start right away? I am eager to begin. Today I will finish the last two steps and with that the prepass itself. I'll do them both in a single pass.

10am. Focus me. Let me do this. Right now my determination is high and I have the plan from yesterday in my head. It should be doable to finish resolve before the time for breakfast. That will leave cleaning up for the rest of the day.

10:15am.

```fs
type ResolveEnv = { term : Map<int,int>; ty : Map<int,int>; term_rec : Map<int,E>; term_rec_free_vars : Map<int,Set<int>> }
```

Ah, I got the env wrong the first time around.

10:30am. I am into this.

```fs
type ResolveEnv = { term : Map<int,int>; ty : Map<int,int>; term_rec : Map<int,E>; term_rec_free_vars : Map<int,Set<int>>; adjust_let_term : int; adjust_let_ty : int }

let resolve (scope : Dictionary<obj,PropagatedVars>) x =
    let subst (env : ResolveEnv) (x : PropagatedVars) : FreeVars =
        let fv_term = x.term.vars |> Set.fold (fun s x -> if x < 0 then s + env.term_rec_free_vars.[x] else Set.add env.term.[x] s) Set.empty |> Set.toArray
        let fv_ty = x.ty.vars |> Set.fold (fun s x -> Set.add env.ty.[x] s) Set.empty |> Set.toArray
        let stack_size min max = if min <= max then max - min else 0
        {
        term = {|free_vars=fv_term; stack_size=fv_term.Length + stack_size x.term.min x.term.max|}
        ty = {|free_vars=fv_ty; stack_size=fv_ty.Length + stack_size x.ty.min x.ty.max|}
        }
```

But it is not enough to just get back the free vars. I need the new `ResolveEnv` as well.

10:35am. Took a short break. Let me resume.

10:55am.

```fs
let resolve (scope : Dictionary<obj,PropagatedVars>) x =
    let subst (env : ResolveEnv) (x : PropagatedVars) : FreeVars =
        let fv_term = x.term.vars |> Set.fold (fun s x -> if x < 0 then s + env.term_rec_free_vars.[x] else Set.add env.term.[x] s) Set.empty |> Set.toArray
        let fv_ty = x.ty.vars |> Set.fold (fun s x -> Set.add env.ty.[x] s) Set.empty |> Set.toArray
        let free_vars : FreeVars =
            let stack_size min max = if min <= max then max - min else 0
            {
            term = {|free_vars=fv_term; stack_size=fv_term.Length + stack_size x.term.min x.term.max|}
            ty = {|free_vars=fv_ty; stack_size=fv_ty.Length + stack_size x.ty.min x.ty.max|}
            }

        let adjust_let_term = x.term.min - fv_term.Length
        let adjust_let_ty = x.ty.min - fv_ty.Length
        let term,_ = Set.fold (fun (s,i) x -> Map.add x i s, i+1) (Map.empty,0) x.term.vars

        failwith ""
```

Time sure flies. But tsk. This is not good. I was wrong. I can't deal with recursives and lowering at the same time after all. It is making it too complicated to know what goes in what order.

Let me curtail my ambition. Let me just focus on dealing with recursives today. It does not matter if I am a day late. ANd probably, I'll have enough time to deal with two passes today.

```fs
type ResolveEnv = { term : Map<int,int>; ty : Map<int,int>; term_rec_free_vars : Map<int,Set<int>> }
```

Let me make this the resolve env. I'll just focus on adjusting the propagated vars. I'll actually substitute the recursives during the later stage. At least that will be easy.

11:05am.

```fs
type ResolveEnv = Map<int,Set<int>>
```

Let me just focus on this one thing. After I have it down I will properly transform the AST into its final form.

Ugh, let me do subst from the start.

11:10am. One thing that is giving me trouble is figuring out how to do recursive statements succinctly. Doing substitution for regular ones is the easiest thing in the world, but I am quite unsure how to reuse that in the recursive case.

11:20am.

```fs
type ResolveEnv = Map<int,Set<Id>>
let resolve_recursive_free_vars env =
    Map.fold (fun (env : ResolveEnv) k v ->
        let has_visited = HashSet()
        let rec f s k v = if has_visited.Add(k) then Set.fold (fun s k -> if 0 < k then f s k env.[k] else Set.add k s) s v else s
        Map.add k (f Set.empty k v) env
        ) env env

let resolve (scope : Dictionary<obj,PropagatedVars>) x =
    let subst (env : ResolveEnv) (x : PropagatedVars) : PropagatedVars =
        let f s x =
            if x < 0 then
                match Map.tryFind x env with
                | Some x -> s + x
                | None -> s
            else Set.add x s
        let fv_term = Set.fold f Set.empty x.term.vars
        {x with term = {|x.term with vars = fv_term|} }
```

Let me do it like this.

11:30am. Ok, after brainstorming this a lot, I think I know how I want to do this.

11:55am.

```fs
let inline remove (dict : Dictionary<_,_>) x on_succ on_fail =
    let mutable q = Unchecked.defaultof<_>
    if dict.Remove(x, &q) then on_succ q else on_fail ()
```

Let me do this helper. I'll refactor the thing in the server that uses this pattern.

12pm.

```fs
            let l =
                List.fold (fun s (id,body) ->
                    let q = Utils.remove scope body id (fun () -> failwith "impossible")
                    let x = subst' env q
                    Map.add id x.term.vars s
                    ) Map.empty a
```

Ah for fuck's sake what the hell am I trying to do?

12:10pm.

```fs
        | ERecBlock(r,a,b) ->
            let l =
                List.fold (fun s (id,body) ->
                    let x = subst' env scope.[body]
                    Map.add id x.term.vars s
                    ) Map.empty a
                |> resolve_recursive_free_vars
            let env = Map.foldBack Map.add l env
            a |> List.iter (fun (id,body) ->
                Utils.remove scope (body :> _)
                    (fun v -> term env body; scope.[body] <- {v with term = {|v.term with vars = env.[id]|} })
                    (fun () -> failwith "impossible")
                )
            term env b
```

Finally got the block recursive case out of the way. For some reason writing this was way thougher than expected. It took me over two hours to get to this point. But what this does in the end is pretty simple. And the code itself is not complicated.

There are various ways that I can think of to do this thing, but the way I am doing it now has the ideal tradeoff between program complexity and performance.

Now that I've done this, the rest is just simple iteration. I can do this in the next 10-20m. Let me do that I will take a break.

12:35pm.

```fs
type ResolveEnv = Map<int,Set<Id>>
let resolve_recursive_free_vars env =
    Map.fold (fun (env : ResolveEnv) k v ->
        let has_visited = HashSet()
        let rec f s k v = if has_visited.Add(k) then Set.fold (fun s k -> if 0 < k then f s k env.[k] else Set.add k s) s v else s
        Map.add k (f Set.empty k v) env
        ) env env

let resolve (scope : Dictionary<obj,PropagatedVars>) x =
    let dict = Dictionary(HashIdentity.Reference)
    let subst' (env : ResolveEnv) (x : PropagatedVars) : PropagatedVars =
        let f s x =
            if x < 0 then
                match Map.tryFind x env with
                | Some x -> s + x
                | None -> Set.add x s
            else Set.add x s
        let fv_term = Set.fold f Set.empty x.term.vars
        {x with term = {|x.term with vars = fv_term|} }
    let subst env (x : obj) = match scope.TryGetValue(x) with true, v -> scope.[x] <- subst' env v | _ -> ()
    let rec term (env : ResolveEnv) x =
        let f = term env
        match x with
        | EPatternMiss | ERecord | EV | ERecursive | ESymbolCreate | EDefaultLit | ELit | EB -> ()
        | EPrototypeApply(_,_,a) | EType(_,a) -> ty env a
        | EJoinPoint(_,a,b) | EFun(_,_,a,b) -> subst env x; f a; Option.iter (ty env) b
        | EForall(_,_,a) -> subst env x; f a
        | ERecBlock(r,a,b) ->
            let l =
                List.fold (fun s (id,body) ->
                    let x = subst' env scope.[body]
                    Map.add id x.term.vars s
                    ) Map.empty a
                |> resolve_recursive_free_vars
            let env = Map.foldBack Map.add l env
            a |> List.iter (fun (id,body) ->
                Utils.remove scope (body :> _)
                    (fun v -> term env body; scope.[body] <- {v with term = {|v.term with vars = env.[id]|} })
                    (fun () -> failwith "impossible")
                )
            term env b
        | ERecordWith(_,a,b,c) ->
            List.iter f a
            b |> List.iter (function
                | RSymbolModify(_,a) | RSymbol(_,a) -> f a
                | RVarModify((_,a),b) | RVar((_,a),b) -> f a; f b)
            c |> List.iter (function
                | WSymbol -> ()
                | WVar(_,a) -> f a)
        | ETypeLet(_,_,b,a) | ETypeApply(_,a,b) | EAnnot(_,a,b) -> f a; ty env b
        | EOp(_,_,a) -> List.iter f a
        | EReal(_,a) -> f a
        | ETypePairTest(_,_,_,_,a,b) | ETypeFunTest(_,_,_,_,a,b) | ETypeRecordTest(_,_,_,a,b) | ETypeApplyTest(_,_,_,_,a,b) | ETypeArrayTest(_,_,_,a,b)
        | EUnitTest(_,_,a,b) | ESymbolTest(_,_,_,a,b) | EPairTest(_,_,_,_,a,b) | ELitTest(_,_,_,a,b)
        | ELet(_,_,a,b) | EIfThen(_,a,b) | EPairCreate(_,a,b) | ESeq(_,a,b) | EHeapMutableSet(_,a,b) | EApply(_,a,b) -> f a; f b
        | EIfThenElse(_,a,b,c) -> f a; f b; f c
        | EMacro(_,a,b) ->
            a |> List.iter (function MType a -> ty env a | MTerm a -> f a | MText -> ())
            ty env b
        | EPatternMemo a -> Utils.memoize dict f a
        | ERecordTest(_,l,_,a,b) ->
            l |> List.iter (function Symbol -> () | Var((_,a),_) -> f a)
            f a; f b
        | ETypeEq(_,t,_,a,b) | EDefaultLitTest(_,_,t,_,a,b) | ENominalTest(_,t,_,_,a,b) | EAnnotTest(_,t,_,a,b) -> ty env t; f a; f b

    and ty (env : ResolveEnv) x = failwith ""
    term Map.empty x
```

Let me have breakfast here. I'll do `ty` later."

---
## [matchu/impress-2020](https://github.com/matchu/impress-2020)@[ce402c23d7...](https://github.com/matchu/impress-2020/commit/ce402c23d7e5a4ae86bf3e0e89453dffba216ad7)
#### Thursday 2020-09-24 13:28:42 by Matchu

include animated assets in preloading

Honestly kinda surprised this worked on the first go! I was worried something about the process would make the sorta like, instant-cache expectation not work.

Still thinking it might be considerate to like, keep a LRU cache of MovieClip options, so that we don't double-execute these scripts when adding stuffâ€¦ we even re-execute the ones already applied lol ðŸ˜… and that adds lots of script tags to the body!

But yeah I'm not gonna push on it yet until I see evidence that it actually causes performance issues in practice

---
## [mrakgr/The-Spiral-Language](https://github.com/mrakgr/The-Spiral-Language)@[0a32445340...](https://github.com/mrakgr/The-Spiral-Language/commit/0a32445340bedb910c66d5baf5ddc0b31cde367a)
#### Thursday 2020-09-24 14:29:35 by Marko GrdiniÄ‡

"2pm. Done with breakfast.

2:!5pm. Let me get back into the fray. I want to get this done today.

Focus me, focus. Do the `ty` function. After that I will do the last pass, this time without trouble.

2:25pm.

```fs
    and ty (env : ResolveEnv) x =
        let f = ty env
        match x with
        | TArrow' -> failwith "Compiler error: Not supposed to show up here."
        | TNominal | TPrim | TSymbol | TV | TUnit -> ()
        | TArrow(_,_,a) -> subst env x; f a
        | TApply(_,a,b) | TFun(_,a,b) | TPair(_,a,b) -> f a; f b
        | TRecord(_,a) | TUnion(_,a) -> Map.iter (fun _ -> f) a
        | TTerm(_,a) -> term env a
        | TMacro(_,a) -> a |> List.iter (function TMText -> () | TMType a -> f a)
        | TLayout(_,a,_) | TArray(_,a) -> f a
```

2:30pm. Had to take a short break. At any rate, I am done with recursive variables.

Now it is time for the last step which is lowering. Once I have that, I will tie it all together in the prepass function.

2:45pm.

```fs
let lower (scope : Dictionary<obj,PropagatedVars>) x =
    let dict = Dictionary(HashIdentity.Reference)
    let rec term env x =
        let f = term env
        match x with
        | EForall' | EJoinPoint' | EFun' -> failwith "Compiler error: Not supposed to show up here."
        | EPatternMiss | ERecord | ERecursive | ESymbolCreate | ELit | EB -> x
        | EFun(r,a,b,c) -> failwith ""
```

Focus me, focus. What should the env be here?

2:50pm.

```fs
type LowerSubEnv<'x> = {|var : Map<int,'x>; adj : int|}
type LowerEnv = {term : LowerSubEnv<E>; ty : LowerSubEnv<T> }
```

2:55pm. Focus me focus. Stop looking at inverse VIX ETF charts.

As far as the env is concerned this should be enough. Let me go with this. Just do it. Go forward.

3:20pm.

```fs
type LowerSubEnv<'x> = {|var : Map<int,'x>; adj : int|}
type LowerEnv = {term : LowerSubEnv<E>; ty : LowerSubEnv<T> }
let lower (scope : Dictionary<obj,PropagatedVars>) x =
    let dict = Dictionary(HashIdentity.Reference)
    let inline scope (env : LowerEnv) x f =
        match scope.TryGetValue(x) with
        | true, v ->
            let fv_term = v.term.vars |> Set.toArray |> Array.map (fun x -> env.term.var.[x])
            let stack_size_term = fv_term.Length + max 0 (v.term.max - v.term.min)
            let adj_term = if v.term.min = System.Int32.MaxValue then 0 else fv_term.Length - v.term.min
```

My focus is low right now.

3:35pm.

```fs
type LowerSubEnv<'x> = {|var : Map<int,'x>; adj : int|}
type LowerEnv = {term : LowerSubEnv<E>; ty : LowerSubEnv<T> }
let lower (scope : Dictionary<obj,PropagatedVars>) x =
    let dict = Dictionary(HashIdentity.Reference)
    let scope (env : LowerEnv) x =
        let v = scope.[x]
        let fv_term = v.term.vars |> Set.toArray
        let stack_size_term = fv_term.Length + max 0 (v.term.max - v.term.min)

        let fv_ty = v.ty.vars |> Set.toArray
        let stack_size_ty = fv_ty.Length + max 0 (v.ty.max - v.ty.min)
        let free_vars : FreeVars = {
            term = {|free_vars = fv_term; stack_size = stack_size_term|}
            ty = {|free_vars = fv_ty; stack_size = stack_size_ty|}
            }

        let var_term,_ = Array.fold (fun (s,i) x -> Map.add x (EV i) s,i+1) (env.term.var, 0) fv_term // I am passing in the old env here in order to keep recursives around.
        let adj_term = if v.term.min = System.Int32.MaxValue then 0 else fv_term.Length - v.term.min

        let var_ty,_ = Array.fold (fun (s,i) x -> Map.add x (TV i) s,i+1) (env.ty.var, 0) fv_ty
        let adj_ty = if v.ty.min = System.Int32.MaxValue then 0 else fv_ty.Length - v.ty.min

        let env : LowerEnv = {
            term = {|var = var_term; adj = adj_term|}
            ty = {|var = var_ty; adj = adj_ty|}
            }

        free_vars, env
```

3:40pm. My brain is incredibly dull. I feel like thinking about anything other than the task at hand. Well, it does not matter.

This was the hardest part of the entire step. Now all I have to sprinkle it throughout and I will be done. Focus me.

```fs
        | EFun(r,a,b,c) ->
            let free_vars, env = scope env x
            EFun'(r,free_vars,a,term env b,Option.map (ty env) c)
        | EForall(r,a,b) ->
            let free_vars, env = scope env x
            EForall'(r,free_vars,a,term env b)
```

Can't forget the adjust.

3:45pm.

```fs
    let adj' (env : LowerEnv) i = i + env.term.adj

    let rec term (env : LowerEnv) x =
        let f = term env
        let adj = adj' env
        match x with
        | EForall' | EJoinPoint' | EFun' -> failwith "Compiler error: Not supposed to show up here."
        | EPatternMiss | ERecord | ERecursive | ESymbolCreate | ELit | EB -> x
        | EFun(r,a,b,c) ->
            let free_vars, env = scope env x
            EFun'(r,free_vars,adj' env a,term env b,Option.map (ty env) c)
        | EForall(r,a,b) ->
            let free_vars, env = scope env x
            EForall'(r,free_vars,adj' env a,term env b)
        | EJoinPoint(r,a,b) ->
            let free_vars, env = scope env x
            EJoinPoint'(r,free_vars,term env a,Option.map (ty env) b)
```

Got this done. Now let me do the rest of the cases. This will be a pain in the ass, but I have to do it. Let me do it.

4:05pm.

```fs
        | ERecBlock(r,a,b) ->
            let a, env =
                List.mapFold (fun env (id,body) ->
                    let re = ref Unchecked.defaultof<_>
                    let body env = let x = term env body in re := x; id, x
                    body, add_term id (ERecursive re) env
                    ) env a
            let a, env = List.mapFold (fun env x -> let id,body = x env in (id,body), add_term id body env) env a
            ERecBlock(r,a,term env b)
```

This form actually surprises me. It slipped my mind that once the first one is done, I can slip it into the rest without the need for references.

4:10pm. Focus me.

Now I just need to go through the rest of the cases. The hard parts have been done. Nothing will stop me.

4:25pm.

```fs
        | ELet(r,a,b,c) ->
            let env = add_term a (EV(adj a)) env
            ELet(r,adj a,term env b,term env c)
        //| EPairTest of Range * bind: Id * pat1: Id * pat2: Id * on_succ: E * on_fail: E
```

This will be a pain in the ass won't it?

Let me take a break. Kengan Omega is out.

After this I will just drum out the rest of the cases and take that long awaited rest."

---
## [quietly-turning/Simply-Love-SM5](https://github.com/quietly-turning/Simply-Love-SM5)@[0d148dce0c...](https://github.com/quietly-turning/Simply-Love-SM5/commit/0d148dce0c23833f1936a0a091880054212ac258)
#### Thursday 2020-09-24 18:36:04 by quietly-turning

update SL Acknowledgments

I dreamt so vividly earlier this morning that it woke me up.

In my dreams, my legs are always immobile. I'm never able to move myself
forward, or anywhere. It has been like this for as long as I can recall.
Zoloft made it so that I could not move my mouth or lungs while I slept,
so I had nightmares of drowning every night for three months in 2015,
but I've since discontinued that.

In this morning's dream, I found a bicycle that I could coast on, and I
used that to travel through pitch darkness, homeward. Gliding like this,
I heard harsh sounds around me, though it was too dark to discern
anything.

After some time of this, I arrived home where a large group of friends I
hadn't seen in years were waiting.

Yanelli greeted me at the door and pounced with a hug. I knew her from
one of my earlier college attempts. As we hugged in the dream and she
said that it was wonderful to see me again, sadness washed over me.

"I'm sorry for having been such a burden," I apologized. "I don't know
how you carried me that year.  You had so much, yourself." She was
devoutly Christian and had her fiancÃ©e waiting multiple time zones away.
My own partner was six hundred miles removed. Yanelli and I had spoken
often of longing for a sense of acceptance as we walked around campus
late at night together.

There was one night when it must have seemed unbearable. She had asked
me to hold her, and we spent an hour cuddling in her room, two lonely
children lost in sadness.

In the dream from this morning, when I apologized, she only smiled and
reassured me that everything was okay now.

I awoke with a start, and felt quite certain, quite suddenly, that if
there were a heaven, that would have been it.

---
## [legodps/arc-article-pipeline](https://github.com/legodps/arc-article-pipeline)@[d136af4041...](https://github.com/legodps/arc-article-pipeline/commit/d136af404138df717cc49c96b26fba8a0e06901f)
#### Thursday 2020-09-24 22:06:17 by David Sander

[MAJOR] rename module, update config, add requirement versions

Been a couple weeks or so since I've made a last commit. Suffice to say, hard at work, just not on
things I could commit until today. I have managed to write up a script to parse through a particular
question file from the TQA question dataset. I'll be adding the code for that hopefully soon, though I
need to reorient with my professor to get a good idea of next steps.

This commit was mostly about some quality of life related stuff. Firstly, I noticed that running this
repeatedly, sucked. So I created a fallback for the `-f` configuration to look for a property in the
config file. So, priority to terminal command options, then to the config file, failing if neither
has a proper data filepath. This will allow me to test stuff more rapidly, which I'm happy about. In
addition I have renamed the module from pipeline to archiver. This more accurately represents what the
module does, and as such, could be run on its own. My ultimate plan would be to have something that
could end to end run the archiver and several other functions in succession. I have updated `readme.md`
with the configuration and updated running instructions.

Working with Elasticsearch I encountered a strange issue where my "index" commands were being rejected
due to some "read-only" property. Initially I thought this was because of a setting in Elasticsearch,
but further Googling determined that it was actually me not having enough disk space available. After
cleaning up my disk, and re-running, I had no issues. Another oddity I noticed, but is intermittent,
is that if I rerun the archiver with the same files, it might double (but no more if rerun past that)
the size of the index. I found no evidence that it was just duplicating information beyond the index
size, as the number of hits didn't seem to change. Since I can't really reproduce it, I'm keeping it
in mind if stuff comes up later.

Quick note, in my examination of the Elasticsearch documentation, I found out that the mapping
"doc type" is a deprecated function piece. I have removed it both from my configuration file and the
code to support this. I need to make some notes about what version of Elasticsearch I expect.

I raised test coverage to 100%! I had to make some alterations. I moved the Elasticsearch constructor
call to `__main__.py` as well as the importing of `elasticsearch.helpers.bulk`. I really tried to find
a way to mock those libraries but following the online documentation of the mocking library didn't help
nor did looking for my issues in particular. With this in mind, I think this solution is workable for
now and I can double back and fix this later when its not late in the evening and I have more patience.

Another important thing to note, I have added specific versions for the different libraries I use.
While earlier/later versions are likely to work, from my recent and horrible experience with another
library that did not version (they used specific git commits *shudder*) I never wish to inflict that
pain upon anyone else that would use my code. This way, the version is specified, so everyone knows.

---
## [legodps/arc-article-pipeline](https://github.com/legodps/arc-article-pipeline)@[6ae503ed8b...](https://github.com/legodps/arc-article-pipeline/commit/6ae503ed8bd71a6b5cd0037b09c63cf8e4b1bcf5)
#### Thursday 2020-09-24 22:06:17 by David Sander

Add `__main__.py` to allow for a terminal interface add property loading

With the experience of some of my other projects at work, doing the terminal interface was familiar
and not difficult (thankfully). This gives me a framework to expand this as time goes on. I also
added functionality to import configurations from a yaml configuration file. I debated between yaml
and json but since yaml doesn't require quite as much formatting, I decided to use yaml. I shifted
some of the hard coded values to the config file and I will try to get that tested when I next have
time to work on this (hopefully tomorrow, trying to put in ~an hour a day on this during the week).

I also added another unit/integration test, this time to test the loading of config yaml files.
Pretty simple stuff but it will help to have that later on. Doing my best to conform to the same
stringent work requirements surrounding python coding. Both for the best practices that they are
but so that others that might see this can understand it better. With the terminal interface now
open for use, and config files ready to use, I plan on working with the article parsing tomorrow
and digging into the format that I was given from a professor I'm working with. They are using
jsonl, which I'm kind of familiar with, part of me wishes it was just json though. Not sure how
best to handle the variety of formats people might use to provide articles outside of just me,
I'll probably look to that professor for some thoughts on that for ease of use. Ideally I would
avoid having an import per file type (e.g. .txt and .json and .jsonl, so on and so forth) but
we'll see what happens as I want to make this tool available for use by the group.

Tests passing, coverage raised but not 100% just yet. Will need to do some mocking to technically
reach that peak. Ideally once this system is set up I can add some larger integration and functional
tests to ensure it works properly at a larger scale.

---
## [legodps/arc-article-pipeline](https://github.com/legodps/arc-article-pipeline)@[c47138db53...](https://github.com/legodps/arc-article-pipeline/commit/c47138db530c394eb2eac1b49f3fb143036d79cd)
#### Thursday 2020-09-24 22:06:17 by David Sander

add in command to run ARC-Solver via benchmark and extract results from the run

Lot of progress here, really happy it went this smoothly. I thought it would be a royal pain to get
python to be able to communicate with ARC-Solver, but I figured it out. See ARC-Solver by default
uses Conda as an environment keeper. So I used `subprocess.run` in conjunction with the
`conda run` command and I was able to force conda to run the ARC-Solver script in the conda environment
that had been set up already. This is huge for me! To top it off, I was able to get the results from
the run of the script and get the number of correct and incorrect answered questions. We'll have to
see how things go, but maybe 10 more hours on this project will let me get to a place I can run the
benchmark and be confident in how it works. Definitely gonna need to unit test this, that'll be
difficult but doable.

Added some additional configs to benchmarkConfig.yaml, not all things make sense to enter via the
terminal, I'm considering removing those entirely so it is simple how to configure it, I'll think about
that some more. The next step is to set up the automation of running the index. I already have the
reset and copy test set functions all set up. There's some additional work I need to do to get
the articles associated with their files... that'll be a little sucky but I'll make it work.

Lacking a lot of coverage for arc_runner.py, I'll add it soon.

---
## [jtv/libpqxx](https://github.com/jtv/libpqxx)@[dde4eebc8c...](https://github.com/jtv/libpqxx/commit/dde4eebc8c97aa03e4295f9fe5962744bead7c4c)
#### Thursday 2020-09-24 23:22:11 by Jeroen T. Vermeulen

Deprecate `namedclass`.

I hate this class.  It has its use, sure, but it brought in too much
complexity â€” notably virtual inheritance!

The libpqxx 7.0 changes may have simplified the situation a bit, and I
now see just two, distinct (non-overlapping) use-cases:
 1. The `transaction` hierarchy.
 2. `transactionfocus` and its children.

In both these cases, `namedclass` exists to check for, and report,
mistakes such as "you tried to open a transaction while another one was
active on the same connection."  So two things: common base class for
polymorphism, and a human-readable name for an object which may or may
not have been given an individual name.

Let's see how far we can get if we separate these, and streamline them
individually.

For starters, I'm not at all convinced that it's really useful to have a
specific class name in the case of the transaction hierarchy.  As far as
the user is concerned, they're all "transaction."  And if the developer
wants more detail, they'll get far more from giving the transactions
helpful names.  There goes the vtable.  Just a `name()` on the
transaction will do.

I haven't looked at `transactionfocus` in as much detail yet.  It's the
case where we do want polymorphism that isn't already there.  So yeah, I
fear the vtable stays.  But virtual inheritance?  No, that no longer
looks necessary.  Right now it's only there (far as I can see right now)
because `subtransaction` is both a `transactionfocus` and a
`transaction_base`, which is a `namedclass` in its own right.  But if I
tear these two things apart, well, who cares?

And... a `std::string` for the class name?  A `std::string_view` will do
just fine, thank you.  That string is hardly going to change!  Yes, yes,
I know: another option would be to construct the full description right
when we construct the `transactionfocus`.  But who wants to pay that
cost all the time for something we'll use so rarely?

---

# [<](2020-09-23.md) 2020-09-24 [>](2020-09-25.md)

