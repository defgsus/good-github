# [<](2020-02-07.md) 2020-02-08 [>](2020-02-09.md)

1,402,167 events, 781,904 push events, 1,141,897 commit messages, 69,881,933 characters


## [newstools/2020-sundiata-post@b4e7f122c5...](https://github.com/newstools/2020-sundiata-post/commit/b4e7f122c598b005ea9fbd741494cd1d18e5443e)
##### 2020-02-08 02:18:13 by NewsTools

Created Text For URL [sundiatapost.com/10-year-old-boy-impregnates-his-13-year-old-girlfriend-photos/]

---
## [dong-liuliu/runtime@ce474152d7...](https://github.com/dong-liuliu/runtime/commit/ce474152d79572a72b7f79d6771b226f1fa7cfb3)
##### 2020-02-08 02:29:23 by Jose Carlos Venegas Munoz

clh: update to v0.5.0

Changes:

Virtual Machine Dynamic Resizing
With 0.4.0 we added support for CPU hot plug, and 0.5.0 adds CPU hot
unplug and memory hot plug as well. This allows to dynamically resize
Cloud Hypervisor guests which is needed for e.g. Kubernetes related use
cases.
The memory hot plug implementation is based on the same framework as the
CPU hot plug/unplug one, i.e. hardware-reduced ACPI notifications to the
guest.

Next on our VM resizing roadmap is the PCI devices hotplug feature.

Multi-Queue, Multi-Threaded Paravirtualization
We enhanced our virtio networking and block support by having both
devices use multiple I/O queues handled by multiple threads. This
improves our default paravirtualized networking and block devices
throughput.

New Interrupt Management Framework
We improved our interrupt management implementation by introducing an
Interrupt Manager framework, based on the currently on-going rust-vmm
vm-device crates discussions. This move made the code significantly
cleaner, and allowed us to remove several KVM related dependencies from
crates like the PCI and virtio ones.

Development Tools
In order to provide a better developer experience, we worked on
improving our build, development and testing tools.
Somehow similar to the excellent Firecracker's devtool, we now provide a
dev_cli script.

With this new tool, our users and contributors will be able to build and
test Cloud Hypervisor through a containerized environment.

Kata Containers Integration
We spent some significant time and efforts debugging and fixing our
integration with the Kata Containers project. Cloud Hypervisor is now a
fully supported Kata Containers hypervisor, and is integrated into the
project's CI.

Log:

62ccccc vmm: Make sure to retry creating the VM on EINTR
671b49b build(deps): bump vm-memory from `d6229fc` to `4237db3`
e5b7fff build(deps): bump micro_http from `1eb80f8` to `ab44474`
da2b3c9 vm-device: interrupt: Remove InterruptType dependencies and definitions
84fc807 interrupt: Interrupt manager split
56d7c04 vm-virtio: vsock: Don't return error when epoll_wait is interrupted
6e6b2b8 scripts: Check the Rust formatting is valid
705f271 scripts: dev_cli: Pass unit and integration test args to cargo test
bc053f1 main: Ignore error on log writing
91739be main: Add help info for block-backend
ae6cf4c tests: integration: Add memory overhead test
7cb61d3 main: Don't panic (by calling .expect()) if writing to the log fails
880a57c vmm: Remove VmInfo struct
07bc292 vmm: device_manager: Get VmFd from AddressManager
6411c3a vmm: device_manager: Use MemoryManager to get guest memory
066fc6c vmm: device_manager: Get VM config from the struct member
77ae3de vmm: device_manager: Make legacy device addition a method
599275b vmm: device_manager: Make ACPI device creation a method
b8c1b2e vmm: device_manager: Make console creation a method
b5440e2 vmm: device_manager: Make virtio device creation functions methods
e90c6f3 vmm: device_manager: Make make_virtio_devices a method
dbc09ad vmm: device_manager: Make add_vfio_devices a method
d9e1c2c vmm: device_manager: Make add_virtio_pci_device a method
aaa5e2e vmm: device_manager: Make add_virtio_mmio_device a method
2987476 vmm: device_manager: Make add_pci_devices and add_mmio_devices methods
3dbae42 vmm: device_manager: Only add MemoryManager to I/O bus on ACPI builds
68fa97e vmm: device_manager: Always embed MemoryManager in the struct
789a39a ci: Add MQ support in the test cases
99da1df vhost-user-blk: Add MQ support in backend
1038a07 vhost-user-blk: Device support multiple queues
839f3a7 build(deps): bump serde_json from 1.0.45 to 1.0.46
652b603 vfio: Use the vfio-binding FAM wrappers
275cb5c scripts: dev_cli: Add clean command support
8676759 README: Basic dev_cli documentation
76087f1 script: cargo: Improve the cargo tests
db6f894 scripts: Add container based development script
31c3685 build(deps): bump micro_http from `e5ef374` to `1eb80f8`
8dfb79e build(deps): bump vm-memory from `df6207f` to `d6229fc`
e99b640 build(deps): bump regex-syntax from 0.6.13 to 0.6.14
92b3764 build(deps): bump openssl-sys from 0.9.53 to 0.9.54
de91c30 build(deps): bump micro_http from `9e68aa4` to `e5ef374`
aa4efdd ci: Update kernel related to virtio-iommu
ac01ced vmm: Cleanup list of PCI IDs related to virtual IOMMU
097cff2 vmm: Use virtio topology for virtio-iommu
bac0d1e iommu: Implement virtio topology configuration
0c73ff8 iommu: Add topology structures
db42cae vm-virtio: Handle special virtio-pci capability CAP_PCI_CFG
db9f9b7 pci: Make self mutable when reading from PCI config space
655d9cd build(deps): bump smallvec from 1.1.0 to 1.2.0
74ab468 build(deps): bump backtrace from 0.3.42 to 0.3.43
1651cc3 build(deps): bump kvm-ioctls from 0.4.0 to 0.5.0
b4d04bd tests: Add CLI <-> API validation test for --disk changes
3c8cf09 docs: Update device model to clarify how to enable vhost-user-block
75e6762 vmm: Give deprecation warning for "--vhost-user-blk" syntax
969b5ee vmm: config: Add warning about specifying "wce" without "vhost-user"
12f4cd9 tests: Use "--disks" for vhost-user-block testing
aeeae66 vmm: Support vhost-user-block via "--disks"
362942f build(deps): bump micro_http from `53cf1ba` to `9e68aa4`
b5992fe build(deps): bump thiserror from 1.0.9 to 1.0.10
2c6f528 vmm: Give deprecation warning for "--vhost-user-net" syntax
f322e92 docs: Update device model to clarify how to enable vhost-user-net
4888dd2 tests: Add CLI <-> API validation test for --net changes
8f096b8 tests: Use "--net" parameter for vhost-user-net setup
a831aa2 vmm: Support vhost-user-net via "--net"
e155e36 vm-virtio: Simplify virtio-fs configuration
8e48fc4 vm-virtio: Simplify virtio-blk configuration
8946a09 vm-virtio: Simplify virtio-net configuration
9efaff7 ci: Consolidate virtio-blk integration tests
a33e834 ci: Add integration test for virtio-blk multiqueue support
f5b53ae vm-virtio: Implement multiqueue/multithread support for virtio-blk
08e47eb vmm: Add num_queues and queue_size parameters to virtio-blk
c4b3ed7 vm-virtio: Further factorization
bce7627 vm-virtio: Define a separate macro alias for ctrl queue devices
2e2b1e4 vm-virtio: Remove the multiqueue argument from the pausable macro
2cb7ec0 vm-virtio: Pausable macro factorization improvements
c06a827 vm-virtio: Rename epoll_thread to epoll_threads
f648f28 vm-virtio: Make all virtio devices potentially multi-threaded
ac8e4b9 build(deps): bump vm-memory from `8a606cd` to `df6207f`
45d43f9 build(deps): bump micro_http from `af25399` to `53cf1ba`
9174709 build(deps): bump arrayref from 0.3.5 to 0.3.6
90810a9 build(deps): bump micro_http from `1f931c6` to `af25399`
16af54e build(deps): bump signal-hook from 0.1.12 to 0.1.13
4ff972c build(deps): bump ssh2 from 0.6.0 to 0.7.1
3508440 build(deps): bump itoa from 0.4.4 to 0.4.5
0fa1e2c vmm: Handle mapping from devices regions through vm-memory
694da82 ci: Make the integration tests fail if images are not valid
0ea6406 build(deps): bump vm-memory from `beaf215` to `8a606cd`
148a9ed vmm: Fix map_err losing the inner error
0a7bcc9 vm-virtio: Fix map_err losing the inner error
4587cc7 vhost_user_net: Fix map_err losing the inner error
f444ef6 vfio: Fix map_err losing the inner error
aa5ae76 src: Fix map_err losing the inner error
cf25bd7 qcow: Fix map_err losing the inner error
0639659 net_util: Fix map_err losing the inner error
f5a52ed arch: Fix map_err losing the inner error
a34893a Revert "vmm: Move MemoryManager from I/O ports to MMIO region"
57ed006 Revert "devices, vmm: Move GED device to MMIO region"
6120d0f Revert "vmm: Move CpuManager device to MMIO region"
6475052 build(deps): bump micro_http from `1db1bbd` to `1f931c6`
980e03f vmm: Move CpuManager device to MMIO region
5e3c62d devices, vmm: Move GED device to MMIO region
03108fb vmm: Move MemoryManager from I/O ports to MMIO region
3202e8a vfio: Fix 64bits BAR size reading
d5d4053 README.md: Update kernel instructions to use branch
0042f1d ioapic: Rely fully on the InterruptSourceGroup to manage interrupts
2dca959 ioapic: Create the InterruptSourceGroup from InterruptManager
52800a8 vmm: Create an InterruptManager dedicated to IOAPIC
29e668c cargo: Update Cargo.lock
cafab9e main: Add some command line argument conflicts
611d13e main: Move logging arguments to their own group
8aabb90 main: Add "--vhost-user-blk" to the "vm-config" group
bdb0ad9 tests: Use cloud-hypervisor binary for "--{net,block}-backend"
45fb918 main: Allow main binary to be used as net or block backend
7f73eeb vhost_user_block: Split launching backend into its own function
9fd187c vhost_user_net: Split launching backend into its own function
b851887 main: Split current VMM running code into it's own function
1dd2451 vhost_user_block: Refactor vhost_user_block backend code into a new crate
fb763c4 vhost_user_net: Refactor vhost_user_net backend code into a new crate
dd82064 main: Delay converting command line to VM params
e12179a bin: vhost_user_net: Rename "--backend" to "--net-backend"
3ede2dc bin: vhost_user_blk: Rename "--backend" to "--block-backend"
032b8e4 build(deps): bump micro_http from `ebc15f2` to `1db1bbd`
204f05f build(deps): bump serde_json from 1.0.44 to 1.0.45
7ee9eca build(deps): bump vmm-sys-util from 0.3.1 to 0.4.0
2034fc2 vmm: Fix LENGTH_OFFSET_HIGH of MemoryManager
503e047 build(deps): bump redox_users from 0.3.3 to 0.3.4
605fa83 ci: Add integration test for virtio-blk with 'direct=on'
925c862 vmm: device_manager: Add 'direct' support for virtio-blk
2bd90d9 ci: Add integration test for virtio-blk with 'readonly=on'
fb79e75 vmm: device_manager: Add read-only support for virtio-blk
9ac06bf ci: Run clippy for each specific feature
e91638e pci: Cleanup the crate from unneeded types
99f3929 pci: Simplify PciDevice trait
a20b383 vmm: Always use a reference for InterruptManager
bb8cd9e vmm: Use LegacyUserspaceInterruptGroup for acpi device
75e22ff vmm: Use LegacyUserspaceInterruptGroup for serial device
8d7c4ea vmm: Use LegacyUserspaceInterruptGroup for mmio devices
12657ef vmm: Fully implement LegacyUserspaceInterruptGroup
f70c993 vmm: Add ioapic to KvmInterruptManager
c9ea235 vmm: Add LegacyUserspaceInterruptGroup skeleton for legacy interrupts
2aabf58 vmm: Move irq_routes creation to specific MSI use case
d34f31f vmm: Fix KvmInterruptManager when base is different from 0
e73cb1f vmm: Initialize InterruptManager sooner
9fab9bc build(deps): bump micro_http from `f77960b` to `ebc15f2`
9fe6ece build(deps): bump redox_users from 0.3.1 to 0.3.3
c27be84 build(deps): bump syn from 1.0.13 to 1.0.14
9731be1 build(deps): bump remain from 0.2.0 to 0.2.1
eedfb36 build(deps): bump micro_http from `6327290` to `f77960b`
3901a1d vmm: Log an error if VM resize fails
76d9bf2 vmm: Start memory slots at zero
0ab22fe vmm: Only generate GED event when new DIMM added
211786a vmm: Only generate GED interrupt when the number of vCPUs has changed
8049666 vm-virtio: Cleanup from kvm_iotcls and kvm_bindings dependencies
50a4c16 pci: Cleanup the crate from kvm_iotcls and kvm_bindings dependencies
4bb12a2 interrupt: Reorganize all interrupt management with InterruptManager
92082ad vmm: Fully implement interrupt traits
0f72712 vmm: Implement InterruptSourceGroup and InterruptManager skeleton
11d4d57 vm-device: Introduce InterruptManager and InterruptSourceGroup traits
be421dc vm-virtio: Optimize vhost-user interrupt notification
1f029dd vm-virtio: Add notifier to VirtioInterrupt trait
c396bac vm-virtio: Modify VirtioInterrupt callback into a trait
ef7d889 vfio: Remove unused GSI routing functions
1a4b5ec msi: Set KVM routes from MsiConfig instead of VFIO
f3c3870 msi: Create MsiConfig to embed MsiCap
1e5e028 msix: Perform interrupt enabling/disabling
19aeac4 msix: Remove the need for interrupt callback
3fe362e msix: Set KVM routes from MsixConfig instead of VFIO
2381f32 msix: Add gsi_msi_routes to MsixConfig
9b60fcd msix: Add VmFd to MsixConfig
86c760a msix: Add SystemAllocator to MsixConfig
f77d2c2 pci: Add some KVM and interrupt utilities to the crate
f5704d3 vmm: Move gsi_msi_routes creation to be shared across all PCI devices
ed5459f ci: Add integration test for vhost_user_blk with 'direct'
e0a8da2 vhost_user_blk: Add missing WCE property support
c7e9056 vhost_user_blk: implement support for direct (O_DIRECT) mode
a14aee9 qcow: Use RawFile as backend instead of File
c5a656c vm-virtio: block: Add support for alignment restrictions
e483cde docs: Update networking.md with multiple queue support
973eb16 src: Add multiple queue checking in vhost-user-net integration test
4885dc0 src: Update test_valid_vm_config_net with new option for virtio-net
652e7b9 vm-virtio: Implement multiple queue support for net devices
404316e vmm: Add multiple queue option and update config for virtio-net device
4ab88a8 net_util: Add multiple queue support for tap
cf7e0cd vm-virtio: Add multiple queue handling with control queue
709f7fe vm-virtio: Implement control queue support for net devices
d38787c vm-virtio: Add control queue support in net_util.rs
1ae7deb vm-virtio: Implement refactor for net devices and backend
6ae2597 vm-virtio: Create new module to abstract common parts for net devices
3485e89 vm-virtio: Stop delivering interrupt while NO_VECTOR
1324aa4 build(deps): bump proc-macro2 from 1.0.7 to 1.0.8
dcb6d02 build(deps): bump micro_http from `db75e88` to `6327290`
cde2c44 build(deps): bump backtrace from 0.3.41 to 0.3.42
d8adf6a build(deps): bump micro_http from `52e21d0` to `db75e88`
14041e9 docs: Add memory resizing documentation
32506da docs: Document CPU unplug
8b500d7 deps: Bump vm-memory and linux-loader version
7310ab6 devices, vmm: Use a bit field for ACPI GED interrupt type
d2d1248 tests: Add test combining memory and vCPU hotplug
2073007 tests: Add integration test for RAM hotplug
351058a resources: Add memory hotplug support to the kernel configuration
28c6652 vmm: Upon VmResize attempt to hotplug the memory
4e414f0 vmm: device_manager: Scan memory devices upon GED interrupt
284d5e0 vmm: Add memory hotplug ACPI entries to DSDT
8ecf736 vmm: device_manager: Add the MemoryManager to the I/O bus
1218765 vmm: memory_manager: Expose the slots details via an I/O port
9880a2a vmm: memory_manger: Add support for adding new memory to the VM
82fce5a vmm: Add support for resizing the memory used by the VM
78dcb18 vmm: device_manager: Store the type of notification in a local value
5da7c63 acpi_tables: aml: Add support for creating fields
f5137e8 vmm, main: Add optional "hotplug_size" to --mem
f1b6657 vmm: Make desired vCPUs optional in resize command
72b9e92 vmm: memory_manager: Further refactor memory region allocation
1af11a7 vmm: memory_manager: Refactor GuestMemoryMmap construction
281b99a build(deps): bump micro_http from `803c8fa` to `52e21d0`
0acabcd build(deps): bump libssh2-sys from 0.2.13 to 0.2.14
85f43c7 build(deps): bump micro_http from `edbff4c` to `803c8fa`
5788d36 vmm: Do not create virtio devices when missing a transport
41895d7 build(deps): bump rand from 0.7.2 to 0.7.3
85d1555 build(deps): bump micro_http from `0987cdc` to `edbff4c`
3430e20 build(deps): bump memchr from 2.2.1 to 2.3.0
7d85324 build(deps): bump constant_time_eq from 0.1.4 to 0.1.5
fc8bfe0 build(deps): bump backtrace from 0.3.40 to 0.3.41
fa34fae ci: Move to personal branch for virtiofsd
f427d94 virtio-fs: Update virtiofs daemon parameters
345c922 build(deps): bump micro_http from `0bfaf39` to `0987cdc`
b38beb6 build(deps): bump regex-syntax from 0.6.12 to 0.6.13
c2f6dfc vm-virtio: Fix VirtioDeviceType traits
9d775a1 build(deps): bump pnet from 0.23.0 to 0.25.0
70d80cc build(deps): bump pnet_sys from 0.23.0 to 0.23.1
f493d43 build(deps): bump vm-memory from `467eda6` to `218afdd`
2500d0a build(deps): bump micro_http from `2953365` to `0bfaf39`
279c4f9 build(deps): bump pnet_macros from 0.23.0 to 0.25.0
24cf15d vfio: Don't throw an error if a region cannot be found
c2ae380 pci: Refine detection of BAR reprogramming
07bad79 pci: Fix detection of expansion ROM BAR reprogramming
0d2e38d build(deps): bump cc from 1.0.49 to 1.0.50
38468d3 vm-virtio: Improve virtio-console input processing
e4c3401 vm-virtio: Don't waste a descriptor if not filled
7a3e6ca vm-virtio: Simplify virtio-console input processing
ad223f2 fs: Use cache=none by default
84445aa vm-virtio: Implement multi-mapping for virtio-fs
143471b fs: Update mount command to mount virtiofs filesystem
e1822cf vm-virtio: Implement VIRTIO_IOMMU_F_PROBE feature
ae6f272 acpi: Introduce VIOT to support latest virtio-iommu implementation
4dbb33a resources: Update kernel config
c56af8d ci: Use a temporary kernel branch before we override the current one
d756844 build(deps): bump getrandom from 0.1.13 to 0.1.14
9d3f656 build(deps): bump cc from 1.0.48 to 1.0.49
f59665e build(deps): bump epoll from 4.0.1 to 4.1.0
9482ded build(deps): bump micro_http from `aec25f9` to `2953365`
e4ea60d build(deps): bump rand from 0.7.0 to 0.7.2
44dd056 build(deps): bump remain from 0.1.5 to 0.2.0
091c9d9 build(deps): bump pnet from 0.22.0 to 0.23.0
d8c3912 build(deps): bump micro_http from `be97831` to `aec25f9`
1a28f64 build(deps): bump atty from 0.2.13 to 0.2.14
8f6cbf8 build(deps): bump vm-memory from `291dc2e` to `467eda6`
5a0d01c build(deps): bump blake2b_simd from 0.5.9 to 0.5.10
38c0d32 build(deps): bump syn from 1.0.12 to 1.0.13
134bcd8 tests: Use the workspace to unit test all the crates
b6f6772 vhost_rs: Fix compile failure in tests
cf1983c vhost_rs: Mark some broken tests ignored
32a39f9 vm-virtio: Fix broken write_base_regs() unit test
b2589d4 vm-virtio, vmm, vfio: Store GuestMemoryMmap in an Arc<ArcSwap<T>>
5c0bb38 build(deps): bump vm-memory from `09c119f` to `291dc2e`
b997130 build(deps): bump syn from 1.0.11 to 1.0.12
fda8a04 build(deps): bump vm-memory from `3ef06be` to `09c119f`
34e35c9 build(deps): bump anyhow from 1.0.25 to 1.0.26
95352db build(deps): bump vm-memory from `ec69de9` to `3ef06be`
a551398 vmm: device_manager: Use MemoryManager to create KVM mapping
962dec2 vmm: memory_manager: Refactor KVM userspace mapping creation
7df8879 vmm: device_manager: Get device range from MemoryManager
61cfe3e vmm: Obtain sequential KVM memory slot numbers from MemoryManager
260cebb vmm: Introduce MemoryManager
bcfe546 build(deps): bump vm-memory from `bb29ec8` to `ec69de9`
f668603 ci: Fix flaky test_memory_mergeable_on test
1e3fd2f tests: Remove many redundant clones
d5682cd vmm: device_manager: Rewrite if chain using match
21b88c3 vmm: cpu: Rewrite if chain using match
e25a47b vmm: device_manager: Remove redundant clones
9fb1c46 vm-virtio: Remove unnecessary cloning
deb3cbd arch_gen: Remove unused bootparam module
9701fde vm-virtio: Add connection handshake to vsock
5c4e172 ci: test the vhost-user-blk readonly function
cee01ed vhost-user-blk backend: add readonly support
91549dd tests: Add integration test for CPU unplug
a6878ac vmm: cpu: Implement CPU removal
7b3fc72 vmm: cpu: Notify guest OS that it should offline vCPUs
7e81b0d vmm: cpu: Create vCPU state for all possible vCPUs
156ea39 vmm: cpu: Only do ACPI notify on newly added vCPUs
e8313e3 vmm: acpi: Refactor ACPI CPU notification
43d2e09 ci: Add unit tests to compare CLI and OpenAPI
d139090 vmm: config: Derive Debug and PartialEq for configuration structures
93f5f6e vmm: config: Provide a default empty command line through OpenAPI
43bd0e5 main: Move VmParams creation into a dedicated function
17a167d main: Move default values preparation into a dedicated function
9c3a7dd main: Move clap::App creation into a dedicated function
11750ef build(deps): bump log from 0.4.8 to 0.4.10
dea5776 build(deps): bump serde from 1.0.103 to 1.0.104
7909f7a build(deps): bump serde_derive from 1.0.103 to 1.0.104
23150f8 tests: Throttle tests based on disk space
d59fe4e ci: Add some time measurements to CI scripts
fa0fdc6 cargo: Update Cargo.lock for the 0.4.0 release
cec884e release: v0.4.0
6444e29 docs: Add CPU hot plug documentation
a002093 build(deps): bump anyhow from 1.0.23 to 1.0.25
43f0478 build(deps): bump thiserror from 1.0.6 to 1.0.9
664431f vsock: vhost_user: vfio: Fix potential host memory overflow
1e97d14 README: Update for newer distribution support
e8e21ae README: Update the --cpus command line examples
a40a70a ci: Rely on latest virtiofsd version
f0b7412 vmm: device_manager: Add all virtio devices to the migratable list
37557c8 vmm: vm: Implement the Pausable trait
9756fc2 vmm: cpu_manager: Implement the Pausable trait
35dd152 vmm: device_manager: Implement the Pausable trait
a122da4 vm-virtio: vhost: Implement the Pausable trait for all vhost-user devices
dae0b2e vm-virtio: Implement the Pausable trait for all virtio devices
35d7721 vmm: Convert virtio devices to Arc<Mutex<T>>
5450de0 cargo: Do not run fmt on anyhow's build code
0361df4 vm-device: Initial Migratable trait
36daf9c ci: Skip testing RFC or WIP PRs
64c5e3d vmm: api: Adjust FsConfig for OpenAPI
4bfd51c vmm: api: Match VhostUserBlkConfig defaults between CLI and HTTP API
1c2587f vmm: api: Match VhostUserNetConfig defaults between CLI and HTTP API
5e0bbf9 vmm: Don't factorize vhost-user configurations
793327c vmm: api: Make ConsoleConfig default match between CLI and HTTP API
cc08c44 vmm: api: Make MemoryConfig default match between CLI and HTTP API
5a72225 vmm: api: Update CpuConfig name to match the internal name
f7c215d cli: Fix default CPU argument
59ae01f ci: Cancel older builders on Jenkins
c61104d vmm: Port to latest vmm-sys-util
4c92f89 ci: Add OpenAPI validation
93bd88e ci: Simplify travis.yml
d42ef18 ci: Offload cargo tests to the worker node VM
ee528ae vmm: api: Make FsConfig defaults match between CLI and HTTP API
befd342 vmm: api: Make NetConfig defaults match between CLI and HTTP API
eff78f7 resources: Prevent kernel config interactive shell from showing up
99e608c openapi: Fix schema
f994665 vmm: Reduce the minimum IRQ constant
ba59c62 vmm, devices: Remove hardcoded IRQ number for GED device
ce1bd9c resources: turn on CONFIG_ACPI_REDUCED_HARDWARE_ONLY
0374c3d build(deps): bump ssh2 from 0.5.0 to 0.6.0
aa94e9b Revert "vmm: api: Modify FsConfig to be OpenAPI friendly"
9b1ba14 vmm: Delegate device related ACPI DSDT table work to DeviceManager
60e6609 vmm: Delegate CPU related ACPI tables to CpuManager
defc5dc vmm: api: Modify FsConfig to be OpenAPI friendly
66e00ce ci: Extend VFIO integration test
59d0171 vmm: Remove kernel based IOAPIC handling from the device manager
afea6a1 vmm: Stop initialising kernel based IOAPIC/PIC
9b1cb96 vmm: Remove pin based interrupt setup for virtio devices
72fb687 vmm: Check for required capabilities
904b1ea build(deps): bump unicode-width from 0.1.6 to 0.1.7
fcf92d8 tests: Add rebooting to the CPU hotplug test
f98b16f vmm: Update the configuration to preserve hot-plug CPUs after reboot
1722708 vmm: Switch to storing VmConfig inside an Arc<Mutex<>>
c063bb8 vmm: acpi: Make GED interrupt edge triggered
e1af17d vmm: Restore tty to canonical mode when SIGTERM or SIGINT received
44d026b build(deps): bump serde_json from 1.0.43 to 1.0.44
a1285ea build(deps): bump cc from 1.0.47 to 1.0.48
23929f4 vfio: Don't override MSI Enable bit through VFIO ioctl
1dfd60b vfio: use correct flags to disable interrupts
5208ff8 vmm: Detect and handle AMD SME (Secure Memory Encryption)
dcfd6ff build(deps): bump serde_json from 1.0.42 to 1.0.43
08258d5 vfio: pci: Allow multiple devices to be passed through
4115fa8 vfio: pci: Update irqfd registration
1379abb pci: msi: Fix MSG_CTL update through 32 bits write
c81e808 docs: Update instructions regarding virtiofsd
17badfb vmm: cpu: Call vcpu configure() on the vCPU thread
1350306 api: Fix OpenAPI specification entries
e1ff142 tests: Remove MSI only test from test_serial_off
e083064 tests: Add integration test for hotplugging vCPUs
66a31c1 vmm: acpi: Upon GED interrupt notify on all vCPUs
48bf141 vmm: Trigger a hotplug device notification when resizing
b629727 vmm: acpi: Add a CTFY method to notify on all CPU objects
ae9359c vmm: acpi: Create the CPU entries in the DSDT for all vCPUs
791ca33 vmm: device_manager: Add ability to notify via GED device
623755c devices: Add ACPI GED device
7ad68d4 vmm: device_manager: Allocate I/O port for ACPI shutdown device
86339b4 vmm: Add HTTP API to resize the VM
e7d4eae vmm: cpu: Add support for starting more vCPU threads
0ef9999 vmm: cpu: Support only partially configuring the vCPU
c8b3041 vmm: openapi: Update OpenAPI for CpuConfig struct
b6801e3 vmm: cpu: Refactor vCPU thread starting
66d5163 vmm: cpu: Encapsulate vCPU state into its own struct
ea19bb0 tests: Add a test to check that the boot vs max cpus work
1bbe48b vmm: acpi: Mark non-boot vCPUs as disabled in the MADT table
4bc8635 tests: Use new "--cpus" syntax for integration tests
82bc07c vmm: Add boot and max vCPU handling to command line parser
7543e00 vmm: Use new CpuManager accessor to get boot vCPUs
df09078 vmm: cpu: Introduce concept of maximum vs boot vCPUs in CpuManager
669d9a8 vhost_user_backend: fix memory region offsetting
d378da6 build(deps): bump vcpkg from 0.2.7 to 0.2.8
b1cfdc7 build(deps): bump syn from 1.0.9 to 1.0.11
0f21781 cargo: Bump the kvm and vmm-sys-util crates
ca97385 build(deps): bump libc from 0.2.65 to 0.2.66
f7dace1 build(deps): bump syn from 1.0.8 to 1.0.9
861d902 acpi_tables: aml: Add support for binary operators
f787139 build: Reorder travis build commands to reuse build assets
338beeb misc: Update locations to point to new kernel fork
4de04e8 vfio-pci: unmap regions when dropping VfioGroup
62fa595 cargo: set cloud-hypervisor as default crate
ab16af2 openapi: make context ID vsock int64
9fd5ea4 build(deps): bump signal-hook from 0.1.11 to 0.1.12
d6d1074 build(deps): bump serde_derive from 1.0.102 to 1.0.103
4cff045 build(deps): bump serde_json from 1.0.41 to 1.0.42
0ae9610 build(deps): bump serde from 1.0.102 to 1.0.103
0274b79 build(deps): bump signal-hook-registry from 1.1.1 to 1.2.0
edd59a0 build(deps): bump remain from 0.1.4 to 0.1.5
c718225 build(deps): bump openssl-sys from 0.9.52 to 0.9.53
360f063 Revert "vfio: use correct flags to disable interrupts"
8fe5a43 tests: Only setcap on test binary
f1c7f0c ci: Add integration test for vhost_user_fs daemon
50b0e58 vhost_user_fs: Allow specific shared directory to be specified
ba17758 src: Add vhost-user-fs daemon
5c12802 vhost_user_fs: Add Server structure to consume FileSystem implementation
e1fccc3 vhost_user_fs: Add virtio descriptor helper traits
5f7935f vhost_user_fs: Add file traits to handle writing volatile memory
e33ccb0 vhost_user_fs: Implement FileSystem trait for Passthrough
1b76c0a vhost_user_fs: Add FileSystem trait
1e65bda vhost_user_fs: Add multikey module
cd1684b vhost_user_fs: Add FUSE definitions
03361a6 vhost_user_fs: Add new crate
8845326 vm-virtio: Introduce DescriptorChain iterator
3d6b545 ci: Make the integration test binary run with same caps
ac118c9 ci: Parse the smaps file with Rust
bdb7bcd ci: Add integration test for mergeable memory
f979380 vmm: Mark guest persistent memory pages as mergeable
0f9afc3 vmm: Add mergeable=on|off option to --pmem flag
e4e8062 vmm: Mark guest RAM pages as mergeable
880f62b vmm: Add mergeable=on|off option to --memory flag
0213177 Jenkinsfile: Add timeout for build
d642060 Jenkinsfile: Switch to pipeline (declarative format)
1d852e9 vmm: Provide vmm version to start_vmm_thread
a518651 http: api: implement vmm.ping
348a1bc vmm: cpu: Allocate I/O port for the CPU manager
07cdb37 vmm: cpu & acpi: Query CPU manager for CPU status
5faf8b7 vmm: acpi: Add an _MAT for the CPU devices containing a LAPIC
e51ebe0 acpi_tables: Add support for Buffer objects
1da0ff3 vmm: cpu: Add the CpuManager onto the IO bus
39a1b8f acpi_tables: aml: Add support for calling methods
d5bb078 acpi_tables: aml: Add support for while loops
89f0db2 acpi_tables: aml: Add support for device notification
d6696e1 acpi_tables: aml: Add support for mutexes
3d70ce9 acpi_tables: aml: Add "if" with local variables and arguments
d06623f acpi_tables: aml: Add support for OpRegion
93ee6f5 acpi_tables: aml: Add support for field definitions
4b5ce23 acpi_tables: Add PkgLength variant that does not include itself
50c8335 vmm: device_manager: Expose the SystemAllocator
1ac1231 vmm: Encase CpuManager within an Arc<Mutex<>>
d7dc1a9 pci: don't cleanup msi/msix interrupts repeatedly
66fde24 vfio: use correct flags to disable interrupts
8ec89bc misc: Update to new repository locations
64305da docs: device_model: Fix formatting error
b55d75e docs: Add device model
f0e6184 vmm: device_manager: Use consistent naming when adding devices
a2ee681 vmm: device_manager: Add an MMIO devices creation routine
79b8f8e vmm: device_manager: Add a PCI devices creation routine
5087f63 vmm: device_manager: Add an IOAPIC creation routine
ce1765c vmm: device_manager: Add an ACPI device creation routine
cfca275 vmm: device_manager: Add a legacy devices creation routine
4b469b9 vmm: device_manager: Add a console creation routine
e1281b5 build(deps): bump cast from 0.2.2 to 0.2.3
fa0d573 build(deps): bump arc-swap from 0.4.3 to 0.4.4
d9695a0 docs: fs: Update virtio-fs documentation
4d0872d build(deps): bump vm-memory from `8d6ca35` to `bb29ec8`
c204d54 docs: networking: Fix typo in hyperlink
b930b3f vmm: api: Specify which integers are 64 bit wide
6af2f57 vmm: api: Fix the vm.info response payload
2dcd36f build(deps): bump synstructure from 0.12.2 to 0.12.3
6958ec4 vmm: Move CPU management code to its own module
7b77189 build(deps): bump vm-memory from `366a907` to `8d6ca35`
3dde848 vmm: api: Update our OpenAPI document
96aa244 vmm: http: Convert to micro_http HttpServer
f34ace7 vmm: http_endpoint: Do not sent 200 status code when our body is empty
ede2626 API: HTTP: change response content type to JSON
7498647 cargo: Update micro_http
fa94635 build(deps): bump syn from 1.0.7 to 1.0.8
ff36fa9 vm-virtio: Replace use of deprecated std::mem::uninitialized
3c715da vmm: Fix rustfmt failure by removing extra ";"
73b4668 acpi_tables: Fix rustfmt failure by removing extra ";"
a1a5fe0 vmm: Split CPU management into it's own struct
0319a4a arch: vmm: Move ACPI tables creation to vmm crate
c3eaa41 ci: use the new vhost-user-blk backend for integration tests
ceafd4c vhost_user_backend: remove ownership check in set_features()
5870452 src: add vhost-user-blk backend
3a3dd00 vm-virtio: export block::Request and related funcs/structs
08bebaa vhost_user_backend: move protocol_features to the backend
85e936d vhost_rs: fix VhostUserConfig payload management
2cc723f build(deps): bump blake2b_simd from 0.5.8 to 0.5.9
d1f03ba build(deps): bump pnet_macros from 0.22.0 to 0.23.0
ae5e8c4 build(deps): bump cc from 1.0.46 to 1.0.47
8cd45e4 build(deps): bump synstructure from 0.12.1 to 0.12.2
c999ea6 arch: x86_64: acpi: Add basic processor details
64368a1 acpi_tables: aml: Add support for Method and Return
08d6386 acpi_tables: aml: Add support for strings
5cd4f5d vmm: Release the old vm before build a new one
b3388c3 vmm: device_manager: Ensure I/O ports are allocated
2d25862 build(deps): bump pkg-config from 0.3.16 to 0.3.17
ce386ba tests: Use release build for integration tests
87e9ce6 build(deps): bump num_cpus from 1.10.1 to 1.11.0
5694ac2 vm-virtio: Create new VirtioTransport trait to abstract ioeventfds
3fa5df4 vmm: Unregister old ioeventfds when reprogramming PCI BAR
587a420 cargo: Update to the latest kvm-ioctls version
c7cabc8 vmm: Conditionally update ioeventfds for virtio PCI device
de21c9b pci: Remove ioeventfds() from PciDevice trait
3be95db pci: Remove KVM dependency
296f2e1 ci: Add integration test for PCI BAR reprogramming
d6c68e4 pci: Add error propagation to PCI BAR reprogramming
3e819ac pci: Use a weak reference to the AddressManager
149b61b pci: Detect BAR reprogramming
04a449d pci: Pass DeviceRelocation to PciBus
e93467a vmm: Implement DeviceRelocation trait
4f8054f pci: Store the type of BAR to return correct address
b51a9e1 pci: Make PciBarRegionType implement PartialEq
8746c16 vmm: Create AddressManager to own SystemAllocator
1870eb4 devices: Lock the BtreeMap inside to avoid deadlocks
733e636 devices: Allow for bus range removal and update
e536f88 vfio: Implement move_bar() from PciDevice trait
c865f93 pci: Extend PciDevice trait with move_bar() function
3e37f59 pci: Add new DeviceRelocation trait
5cc1e73 Fix Cargo.lock
05eb567 build: Ensure there is a release build artifact for travis to upload
75bf240 cargo: Move to 0.3.0
be6a197 build(deps): bump serde_derive from 1.0.101 to 1.0.102
f27893f build(deps): bump vm-memory from `8669369` to `366a907`
696f6ca build(deps): bump signal-hook from 0.1.10 to 0.1.11
1f7f484 build(deps): bump serde from 1.0.101 to 1.0.102
4e0b5e8 build(deps): bump syn from 1.0.6 to 1.0.7
c159515 build(deps): bump syn from 1.0.5 to 1.0.6
2633636 build(deps): bump getrandom from 0.1.12 to 0.1.13
7c2c4fb acpi_tables: aml: Rename to_bytes() to to_aml_bytes()
ad60fe1 arch: x86_64: acpi: Mark 64-bit device area uncacheable
025f1f9 arch: x86_64: acpi: Remove 16-bit PCI range
555ac68 arch: x86_64: acpi: Generate DSDT programatically
dd539df acpi_tables: sdt: Add ability to add to the table from a slice
c76fd6d acpi_tables: aml: Implement AML Zero, One, Ones
9269e40 acpi_tables: aml: Add support for device and scope
e1e0ac2 acpi_tables: aml: Add support for creating IO and interrupt resources
08aff4e acpi_tables: aml: Add support for address spaces
c4c3540 acpi_tables: aml: Add resource templates and Memory32Fixed
03d8cdc acpi_tables: aml: Generate EISA name IDs
3cb73b3 acpi_tables: aml: Add Package support
bf0d0d9 acpi_tables: aml: Add support for named definitions
5a70764 acpi_tables: aml: Implement numbers
a4ce596 acpi_tables: aml: Add support for generating AML name paths
1387ac5 ci: Add cargo audit to the travis pipeline
de9eb3e Bump vmm-sys-utils to 0.2.0
dc951af build(deps): bump c2-chacha from 0.2.2 to 0.2.3
3dff551 build(deps): bump ppv-lite86 from 0.2.5 to 0.2.6
4783fe7 build(deps): bump autocfg from 0.1.6 to 0.1.7
e10413b build(deps): bump proc-macro2 from 1.0.5 to 1.0.6
317d754 build(deps): bump ssh2 from 0.4.0 to 0.5.0
eff1ece build(deps): bump openssl-sys from 0.9.51 to 0.9.52
05c7130 ci: Update ClearLinux image
8e8a7b6 release-notes: v0.3.0 release
2d7bfdd build(deps): bump libc from 0.2.64 to 0.2.65
5822969 docs: Update instructions to create custom ClearLinux image
defc339 docs: iommu: Improve VM boot time and performance
efbafdf vm-virtio: Allow 2MiB mappings
2b60452 build(deps): bump backtrace from 0.3.39 to 0.3.40
e8a25c2 build(deps): bump backtrace from 0.3.38 to 0.3.39
b8be1dc build(deps): bump backtrace-sys from 0.1.31 to 0.1.32
8363159 build(deps): bump cc from 1.0.45 to 1.0.46
78e2f7a api: http: handle cpu according to openapi
205b8c1 api: http: make consistent api and implementation
3acf9df vfio: Don't map guest memory for VFIO devices attached to vIOMMU
63c30a6 vmm: Build and set the list of external mappings for VFIO
c65ead5 vm-virtio: Trigger external map/unmap from virtio-iommu
837bcbc vfio: Create VFIO implementation of ExternalDmaMapping
3598e60 vfio: Add a public function to retrive VFIO container
34bb317 vm-device: Add new crate for virtio and VFIO agnostic traits
9085a39 vmm: Attach VFIO devices to IORT table
5fc3f37 vmm: Add iommu=on|off option for --device
3bb51d4 build(deps): bump libc from 0.2.62 to 0.2.64
cc72ed1 vhost_user_net: Propagate errors correctly
8663b42 vhost_user_net: Remove unnecessary checks for unconfigured memory
df336ad vhost_user_net: Remove debugging println! messages
9e78c2e build(deps): bump ryu from 1.0.1 to 1.0.2
786e339 api: http: Fix openpi schema.
90d1083 build(deps): bump syn from 1.0.3 to 1.0.5
5ca068a build(deps): bump proc-macro2 from 1.0.1 to 1.0.5
2a0ba7a vmm: vm: Add state validation unit test
097b306 vmm: vm: Verify that state transitions are valid
ef090cf build(deps): bump ryu from 1.0.0 to 1.0.1
db3ece8 build(deps): bump failure from 0.1.5 to 0.1.6
af41d6f main: Add VM pause/resume test
d2d3abb vmm: Rename Booted vm state to Running
dbbd04a vmm: Implement VM resume
4ac0cb9 vmm: Implement VM pause
80c3fd9 ci: Allow enough time for L2 VM to boot
37a7000 ci: Make sure VFIO test don't conflict with Azure private IP
6e9e24e ci: Extend virtio-iommu integration test
1fc8ee9 ci: Remove QEMU dependency for nested VFIO test
cb59f82 scripts: Use virtio-fs-virtio-iommu branch as custom kernel
688ec0e resources: Update kernel config
8e018d6 vfio: Move vfio-bindings to crates.io
c446b9d Cargo: Move virtio-bindings to crates.io
6df7cd0 build(deps): bump openssl-sys from 0.9.50 to 0.9.51
3a04db5 build(deps): bump arrayvec from 0.4.11 to 0.4.12
ad7d02c build(deps): bump nodrop from 0.1.13 to 0.1.14
1298b50 vmm: Manage the exit and reset behaviours from the control loop
a95fa1c vmm: api: Add a VMM shutdown command
228adeb vmm: Unreference the VM when shutting down
14eb071 Cargo: Move to crates.io vmm-sys-util
5652cc7 README: Remove wrong statement about the firmware
2c50c96 docs: Explain how to use the virtual IOMMU
46848fd ci: Add integration test for virtio-iommu
b918220 vmm: Support virtio-pci devices attached to a virtual IOMMU
278ab05 vmm: Add iommu=on|off option for --vsock
32d07e4 vmm: Add iommu=on|off option for --console
63869bd vmm: Add iommu=on|off option for --pmem
fb47693 vmm: Add iommu=on|off option for --rng
20c4ed8 vmm: Add iommu=on|off option for --net
4b8d7e7 vmm: Add iommu=on|off option for --disk
6e0aa56 vmm: Add iommu field to the VmConfig
03352f4 arch: Create ACPI IORT table
f40adff vm-virtio: Add virtio-iommu support
0acb1e3 vm-virtio: Translate addresses for devices attached to IOMMU
6566c73 vm-virtio: Add IOMMU support to virtio-vsock
9ab00dc vm-virtio: Add IOMMU support to virtio-rng
ee1899c vm-virtio: Add IOMMU support to virtio-pmem
392f1ec vm-virtio: Add IOMMU support to virtio-console
9fad680 vm-virtio: Add IOMMU support to virtio-net
9ebb1a5 vm-virtio: Add IOMMU support to virtio-blk
85e1865 vm-virtio: Implement reset() for vhost-user-fs
4b1328a vm-virtio: Implement reset() for vhost-user-net
8225d4c vm-virtio: Implement reset() for virtio-console
dac7737 vm-virtio: Implement reset() for virtio-vsock
3e750de vm-virtio: Implement reset() for virtio-pmem
eb91bc8 vm-virtio: Implement reset() for virtio-rng
59b4aab vm-virtio: Implement reset() for virtio-net
8288cb2 micro_http: Use Firecracker version
2a46613 vmm: api: Set the HTTP response header Server field
fc5c210 micro_http: Set the response headers Server value
8dbb16d main: Add a simple HTTP API integration test
7abbad0 vmm: Be more idiomatic when calling into the VMM API
7328ecd vmm: Implement the /api/v1/vm.delete endpoint
f9daf2e vmm: Factorize the vm boot and shutdown code
43b3642 vmm: Clean Error handling up
4275824 vmm: Implement the /api/v1/vm.info endpoint
27af983 vmm: Track the VM state
b703441 vmm: Handle the missing VM error
7e0cb07 vmm: Only build a new VM when booting it
9a93f4f micro_http: Fix clippy warning
c505cfa vmm: Implement the VM HTTP endpoint handlers
8a5e47f vmm: Implement the shutdown and reboot API
46cde1a vmm: Rename the VM start and stop operations to boot and shutdown
ce0b475 vmm: Move the VM creation and startup helpers to the api module
f674019 vmm: {De}serialize VmConfig
f2de4d0 vmm: config: Make the cmdline config serializable
6a722e5 vmm: config: Make VhostUser configs serializable
aa31748 vmm: Start the HTTP server thread
b14fd37 vmm: Make --kernel optional
f27aa21 main: Add API socket option
fe5561d main: Group cli options logically
2371325 vmm: api: Add HTTP server
e50f441 micro_http: Import Firecracker HTTP 1.x implementation
8916dad vmm: api: Add cloud-hypervisor OpenAPI documentation
1b66a2f build(deps): bump serde_json from 1.0.40 to 1.0.41
8ea4145 devices, vmm: Add legacy CMOS device
47367eb build(deps): bump openssl-sys from 0.9.49 to 0.9.50
df3e5c8 tests: Add support for integration testing Ubuntu "eoan"
8ec6cda ci: Do not look for vubridge to decide if qemu must be built
8c33eb3 src: Add integration test for vhost-user-net backend
f6d1a9d src: Add vhost-user-net backend
d724511 vm-virtio: Add set_protocol_features in vhost-user-net
9ff4206 vhost_user_backend: Fix clippy issues
db15181 Cargo.toml: Add workspace config changes
9356af8 arch: Mark the PCI MMCONFIG region as reserved in the E820 tables
6a4a931 arch: acpi: Reserve the PCI MMCONFIG region
038f198 arch: acpi: Fix off-by-one error in size of PCI device region
833a3d4 pci, vmm: Expose the PCI bus for configuration via MMIO
c0ca3b6 arch: acpi, layout: Correctly calculate and expose PCI MMCONFIG area
a9eb352 arch: acpi: Patch the 32-bit PCI device area in the APCI table
09392f0 vhost_user_backend: Fix remaining issues
527dd68 vhost_user_backend: Update vmm_va_to_gpa with adding offset
4a1af7f vhost-user-backend: Correct error handling in run
c430951 vhost-user-backend: Remove one checking from set_features
347611b vhost_user_backend: Pass a backend that can be modified
f14ab87 vhost_user_backend: Give access to the EpollVringHandler
cfc8c39 vhost_user_backend: Provide some default trait implementations
1aab372 vhost_user_backend: Make the backend a server
c1b26b1 vhost_user_backend: Don't process disabled queues
d80ac43 vhost_user_backend: Remove useless started field
5f07692 vhost_user_backend: Allow for proper error propagation
36de390 vhost_user_backend: Make some trait functions as mutable
d4f7f73 vhost_user_backend: Move to a per-queue RwLock
4ed8189 vhost_user_backend: Replace Mutex with RwLock when possible
2e2cad9 vhost_user_backend: Add new crate
b5ee921 vmm, devices: Use APIC address constant
162791b vmm, arch: Use IOAPIC constants from layout in DeviceManager
8207b2e arch: Move addresses for GDT and IDT tables to layout module
a045516 vmm: Use layout constant for kernel command line
1bc4750 arch: Move initial page table addresses to layout module
5ba61f6 arch: Move address of MPTABLE to layout module
6d6e290 arch: Move APIC and IOAPIC addresses into layout
0e7a1fc arch, vmm: Start documenting major regions of RAM and reserved memory
f63cb85 net_util: Implement fmt::Display for MacAddr
ff1cb11 arch: Use if-let notation
df2516f vhost_rs: Add clippy override
2ae3919 vm-virtio: Fix formatting
8188074 main: Start the VMM thread
e235c6d vmm: Add VM creation and startup helpers
151f96e vmm: Add a VMM thread startup routine
2f1ff23 vmm: (Re-)Introduce a VMM structure
4671a58 vmm: Move the EpollContext implementation to lib
03ab683 vmm: Introduce Cloud Hypervisor IPC
6710a39 vmm: Pass the exit and reset fds to the vm creation method
feb1c33 vmm: Add a VM config getter
47167a6 vmm: Add a VM console handling method
ea7abc6 vmm: Add a VM stop method
e6ef9ec vmm: Move the tty setting to the VM start routine
2e9d815 vmm: Use a reference counted VmConfig when creating a new VM
2e0f1c2 README: Update Slack invitation link
e869283 build(deps): bump cfg-if from 0.1.9 to 0.1.10
bdfd1a3 vmm: Remove the Vmm structure
9c5135d vmm: Simplify the VM start flow
b79c1f7 vmm: Derive the clone trait for VmConfig
acc60b0 vmm: Make VsockConfig owned
3dc7aff vmm: Make vhost-user configuration owned
5f8a62f vmm: Make DeviceConfig owned
3613723 vmm: Make ConsoleConfig owned
79a02f9 vmm: Make PmemConfig owned
00674cd vmm: Make FsConfig owned
5323da0 vmm: Make RngConfig owned
0688bec vmm: Make NetConfig owned
675e463 vmm: Make DiskConfig owned
036890e vmm: Make KernelConfig owned
9c5bfb8 vmm: Make MemoryConfig owned
dbff0e9 build(deps): bump backtrace from 0.3.37 to 0.3.38
0c8f9d2 ci: Boot from vhost-user-blk with hypervisor-fw
f06b2aa vm-virtio: vhost-user: Set the right vring size
a2f3da3 build(deps): bump arc-swap from 0.4.2 to 0.4.3
2cd406b vm-virtio: Fix virtio-pci BAR type
29b3848 ci: Add a test to validate the VM can be booted from vhost-user-blk
d723b7d vm-virtio: vhost-user-blk: Add support for reset
0a229ef ci: Extend vhost-user-blk test to validate the content
6b06cec ci: add test case for vhost-user-blk
360980d vhost-user-blk: enable write_config for WCE
39083d7 vhost-user-blk: make read_config work
a949ab2 main: add arguments entry for vhost-user-blk
4164853 vmm: add vhost-user-blk support
c7559bb config: make error definition common
397d388 vm-virtio: Add vhost-user-blk implementation
b232de9 vhost_rs: Add INFLIGHT_SHMFD protocol feature
927148d vhost_rs: Fix GET_CONFIG command
c347f84 Revert "vhost_rs: add config messge support"
0a0c735 virtio-bindings: Rely on the upstream crate from rust-vmm
5f0337c tests: Add a "huge" memory test
b488d48 arch: x86_64: Fix E820 table for RAM
5b3ca78 vmm: Use the full host physical address range
180e6d1 vm-virtio: Allocate BARs for virtio-block devices in 32-bit hole
f0360c9 arch: acpi: Set the upper device range based on RAM levels
f9b0875 arch: acpi: Correct range for the 32-bit device hole
bf4f3db build(deps): bump vmm-sys-util from `07ef2e2` to `27e7ff1`
eb60106 arch: acpi: Correct starting length of MCFG table
67ef4f0 build(deps): bump linux-loader from `b270081` to `6cf23a8`
f622a76 build: Build test all supported build configurations on Travis
3bc11a4 vmm: Make the "mmio" only build generate no errors
4df5ebe vmm: Add devices to IO/MMIO bus closer to creation
0739c2c vm-virtio: Fix compilation warning from "mmio" feature only build
7358144 vmm: Cleanup warning from "pci" feature only build
3567206 build, tests: Update to ssh2 0.4.0
ea7f4d7 build(deps): bump serde from 1.0.100 to 1.0.101
c0fede0 build(deps): bump libssh2-sys from 0.2.11 to 0.2.12
1097afb tests: Run MMIO supported integration tests
ccb8328 tests: Add integration testing for MMIO based virtio
3ad4b84 tests: Remove unused "kernel_path" variable
1099f07 vmm: Add MMIO support
26974c7 vm-virtio: Add MMIO transport
c042483 build: make PCI (virtio and vfio) disableable at build time
6d27ac9 vmm: Allow the DeviceManager to inject extra kernel commandline entries
3df1680 devices: Require Interrupt trait implementations to support Sync
f5a44ea docs: Explain how to create a custom Clear Linux cloud image
e950aa6 ci: Reduce integration testing time
05b5115 vmm: Call DeviceManager's register_devices() on creation
7edc46f vmm: Make virtio device creation independent of PCI
7c6ef7f ci: Add integration test for virtio-vsock
bf37b96 ci: Rely on custom Clear Linux cloud image
4d86359 ci: Install socat on the host VM
5e5c2f2 ci: Allow tests to print some useful information with println
a9b2207 ci: Allow threads to send ssh commands
40fc6c3 README: Update rust-hypervisor-firmware link
389f9e3 tests: Check that the test binary cleanly terminated
8f37dec vmm: "close" the SIGWINCH signal handler
c00b58d build(deps): bump pkg-config from 0.3.15 to 0.3.16
5f752da build(deps): bump serde from 1.0.99 to 1.0.100
8e7d67f build(deps): bump vmm-sys-util from `8703cfd` to `07ef2e2`
b515d48 build(deps): bump cc from 1.0.42 to 1.0.45
eb46aa2 vmm: If acpi feature is disabled make "reboot" shutdown
7975394 vm-virtio: vsock: Port unit testing from Firecracker
5a34728 vm-virtio: vsock: Implement VsockEpollHandler
475e487 vmm: Create vsock backend
434a5d0 vm-virtio: vsock: Port submodule unix from Firecracker
df61a8f vm-virtio: vsock: Port submodule csm and packet from Firecracker
22f91ab vm-virtio: Move vsock to its own module
4ccc81f vmm: Create virtio-vsock device
11e7ece vmm: Add new flag "--vsock"
c48ca61 vm-virtio: Add virtio-vsock skeleton
69e2728 vmm: Allocate enough MSI-X vectors for multiqueue virtio devices
d2db34e vmm: Hide underlying console setup from VM
d089ee4 vmm: Move ownership of the exit/reset EventFd to Vm structure
2f4de81 vmm: Access ioapic/io_bus/mmio_bus from DeviceManager via accessor
9ac967e vmm: Split DeviceManager into it's own file
f740a35 build(deps): bump getrandom from 0.1.11 to 0.1.12
e21bc97 build(deps): bump vmm-sys-util from `fd4dcd1` to `8703cfd`
d446a82 build(deps): bump blake2b_simd from 0.5.7 to 0.5.8
2432ad0 build(deps): bump cc from 1.0.41 to 1.0.42
9661e8d build: Really make the acpi feature disableable
7688e6e release-notes: Add table of contents
d784ac2 release-notes: Add v0.2.0 notes
8c2a9a7 vm-virtio: Update backend feature set for vhost-user-net
b8622b5 vm-virtio: Address event count error and refactor data setting
fe9398f scripts: Fix integration tests script
1f06c59 Revert "vmm, tests: Disable reboot support"
5dd6757 vmm: Call munmap() on regions that have been mmap()ed
037807f build(deps): bump backtrace from 0.3.36 to 0.3.37
47ca277 build(deps): bump backtrace from 0.3.35 to 0.3.36
f59cad1 vmm: Cleanup signal_handler thread used for console SIGWINCH handling
7ce0db9 build(deps): bump regex-syntax from 0.6.11 to 0.6.12
9e764fc vmm, arch, devices: Put ACPI support behind a default feature
bb2e7bb vmm: Shutdown vCPU threads
40f9da5 tests: Add a basic direct boot test with acpi=off
8308e1b vmm, tests: Disable reboot support
ad128bf vmm: Give vCPU and signal handler thread useful names
7205700 tests: Add integration testing for VM reboot
3af5619 tests: Use shutdown rather than reboot to shutdown the VMs
614eb68 vm: Make triple-fault and i8042 reset reboot the VM
5a187ee x86_64/devices: acpi: Add support for ACPI shutdown & reboot
ae66a44 vmm: Support both reset and shutdown
ebe8edd devices: i8042: Use error! macro
011496b arch: acpi: Fix legacy interrupt for serial device
2610f43 arch: acpi: Only add ACPI COM1 device if serial is turned on
15387cd arch: x86_64: acpi: Add DSDT table entries for PCI and COM1
638bf03 arch: x86_64: acpi: Generate MCFG table
451502b vm: If a VCPU thread errors out then exit the hypervisor
98f81c3 arch: x86_64: acpi: Generate MADT aka APIC table
ee83c2d arch: x86_64: Generate basic ACPI tables
eea6f1d acpi_tables: Add initial ACPI tables support
3e99098 vhost_rs: add config messge support
e05de45 vhost_rs: The vhost user version we support
6fb7c3b vhost_rs: remove config space offset setting
a44a903 vhost_rs: Change get_config()/set_config()
b4187a1 vhost_rs: Change the VhostUserConfigFlags
8718043 cloud-hypervisor: Bump vmm-sys-util crate version
add0471 vfio: Use the log crate macros
772191b vm-virtio: vhost-user: Rely on acked features to setup backend
97699a5 vm-virtio: vhost-user: Vring should be enabled after initialization
a4ebcf4 vm-virtio: vhost-user-net: Map proper error when getting features
cdfe576 vm-virtio: vhost-user-net: Set the right set of features
bc42420 vm-virtio: Expand vhost-user handler to be reused from virtio-fs
b7d3ad9 vm-virtio: fs: Factorize vhost-user setup
56cad00 vm-virtio: Move fs.rs to vhost_user module
cc7a96e main: Add integration test
f21d54f main: Add arguments entry for vhost-user-net
584a2cc vmm: Add vhost-user-net support
633f51a vm-virtio: Add vhost-user-net implementation
5130655 vmm: Add hugetlbfs handling support
ce60ff1 build(deps): bump vmm-sys-util from `a0b3893` to `829d605`
3dd3290 build(deps): bump vmm-sys-util from `2177381` to `a0b3893`
b2f85cb vhost_rs: Wait for full request to be satisfied
18a8bb0 build(deps): bump vmm-sys-util from `7222869` to `2177381`
151637b build(deps): bump cc from 1.0.40 to 1.0.41
c316c16 build(deps): bump vm-memory from `1635f25` to `8669369`
808fcaa build(deps): bump lazy_static from 1.3.0 to 1.4.0
bc87c9f build(deps): bump kvm-ioctls from `37669f6` to `30adb02`
66a7a94 build(deps): bump getrandom from 0.1.10 to 0.1.11
dfb18ef net: Make TAP registration functions immutable
0b8856d vmm: Add RwLock to the GuestMemoryMmap
ec0b556 vmm: Share the guest memory instead of cloning it
f4d41d6 virtio: net: Remove TAP fd from epoll when no available descriptors
582fc7f build(deps): bump constant_time_eq from 0.1.3 to 0.1.4
44d8ab0 vm-virtio: Remove unused dependency from unit tests
5f52dd2 net_util: Fix clippy error
aface5b build(deps): bump unicode-width from 0.1.5 to 0.1.6
dc31db4 ci: Fix virtio-fs tests
b528e99 build(deps): bump backtrace from 0.3.34 to 0.3.35
e841799 build(deps): bump blake2b_simd from 0.5.6 to 0.5.7
1d9ad9e build(deps): bump autocfg from 0.1.5 to 0.1.6
26a210a arch: x86_64: Fix EBDA adddress
55f01b2 build(deps): bump remain from 0.1.3 to 0.1.4
49a129f build(deps): bump serde from 1.0.98 to 1.0.99
1c23a09 build(deps): bump getrandom from 0.1.9 to 0.1.10
f0082fe tests: Make panics generate a backtrace
8b78e12 tests: Use newgrp to run unit tests
f5a6e3c build: Drop vendor directory from rustfmt command
d6e3b70 tests: Rename virtiofsd build path
71154d8 tests: Use "-f" on directory rm commands
7245cf7 build(deps): bump rust-argon2 from 0.5.0 to 0.5.1
7adb9d5 build(deps): bump libc from 0.2.61 to 0.2.62
760791a build(deps): bump openssl-sys from 0.9.48 to 0.9.49
7b718f3 build(deps): bump vmm-sys-util from `5f8c251` to `7222869`
08ed88c tests: Remove potential sources of nested panics
ab6a8f1 tests: Fix virtio-fs with dax=off integration test
567eda4 tests: Retrieve the bionic image from the Azure storage bucket
0affdd0 docs: Add networking HOWTO
658c076 linters: Fix clippy issues
c836417 docs: Add debug I/O port HOWTO
c52e276 vmm: Log debug ioport timestamps
48a9300 vmm: Log 0x80 IO port writes
10abfd4 build(deps): bump vmm-sys-util from `54e256b` to `5f8c251`
6678cbf build(deps): bump getrandom from 0.1.8 to 0.1.9
513d2fd arch: x86_64: Update linux-loader crate
76e3a30 pci: Simplify PciDevice trait
0d53a58 build(deps): bump rustc-demangle from 0.1.15 to 0.1.16
b3c809a tests: Fix virtio-pmem
af9a72e tests: Add virtio-fs tests with dax=on and dax=off
2e0508c vm-virtio: fs: Add DAX shared region support
3c29c47 vmm: Create shared memory region for virtio-fs
74225ab config: Add option dax and cache_size to virtio-fs
f30ba06 vm-virtio: Allocate shared memory regions on dedicated BAR
e0fda06 vm-virtio: Remove virtio-pci dependency from VirtioDevice
e2b38cc vm-virtio: Extend VirtioDevice trait to retrieve shared memory regions
d97079d vm-virtio: Update VirtioPciCap and introduce VirtioPciCap64
d180deb vm-virtio: pci: Fix PCI capability length
c6feb03 vhost_rs: Allow MasterReqHandler to reply when needed
ef2e8b6 tests: Update virtio-fs mount command
3645bf8 tests: Build virtiofsd from specific branch
021e8d9 tests: Move to new kernel 5.3-rc3
4b3fd90 build(deps): bump cc from 1.0.38 to 1.0.40
bc5b72f build(deps): bump libc from 0.2.60 to 0.2.61
6c06420 vm-virtio: net: Fix out-of-range slice panic when under load
b608671 build(deps): bump syn from 0.15.43 to 0.15.44
97c9648 build(deps): bump arc-swap from 0.4.1 to 0.4.2
df5058e vm-virtio: Implement console size config feature
d9a355f vmm: Add new "null" serial/console output mode
f910476 vmm: Only send stdin input to serial/console if it can handle it
aa44726 vm-virtio: Don't trigger an MSI-X interrupt if not enabled
c0e2bbb pci: Add MSI-X helper to check if interrupts are enabled
4c9759e build(deps): bump syn from 0.15.42 to 0.15.43
b7ed71b build(deps): bump vmm-sys-util from `9014b7a` to `54e256b`
8fcaf91 build(deps): bump redox_users from 0.3.0 to 0.3.1
87195c9 pci: Fix vector control read/write from/to MSI-X table
fca911e main: Add logging support controlled by command line
91ce39e tests: Ensure that the test pipeline fails
6cc3e88 build(deps): bump getrandom from 0.1.7 to 0.1.8
d1cd3c8 build(deps): bump vmm-sys-util from `c0bbae5` to `9014b7a`
91c7f27 build(deps): bump utf8-ranges from 1.0.3 to 1.0.4
87f148c build(deps): bump regex-syntax from 0.6.10 to 0.6.11
778c60f build(deps): bump vmm-sys-util from `71b5b25` to `c0bbae5`
846505d pci: Fix add_capability unit test
9caad73 build, misc: Bump vmm-sys-util dependency
ac950d9 build: Bulk update dependencies
a1f408a qcow: bounds check the refcount table offset and size
dfd44a6 qcow: Add a zero_cluster method to raw file
7d6bf75 qcow: limit the size of a qcow file
20f8d8d qcow: Avoid overflow when taking ceiling of division
4ba1d22 qcow: disallow crazy l1 table sizes
bd612b6 qcow: Fix invalid_cluster_bits test
b713737 qcow: Limit file setups that consume excessive RAM
35a3b47 qcow: Calculate the max refcounts as a u64
f927d1a qcow: better limits on cluster size
0c95476 build(deps): bump vm-memory from `4c329f4` to `1635f25`
6abd50f build(deps): bump clap from 2.27.1 to 2.33.0
c7f8498 build(deps): bump log from 0.4.6 to 0.4.8
8a7cfe8 build(deps): bump dirs from 2.0.1 to 2.0.2
49ef201 vfio: pci: Provide the right MSI-X table offset
a548a01 pci: Fix MSI-X table and PBA offsets
baec276 vm-virtio: Don't break from epoll loop on EINTR
1a484a8 vmm: Don't break from epoll loop on EINTR
532f6a9 vmm: Factorize VM related information into a structure
c0756c4 vmm: Increase memory slot from virtio-pmem
8c4c162 arch: x86_64: Set MTRR default memory type as WB
d526844 tests: Add Ubuntu Bionic version of test_simple_launch
facc3b3 tests: Add Bionic to integration test script
09aced9 tests: Use logical name for disk paths
56c4b70 tests: Refactor integration tests to support different distributions
d18c8d4 vfio: pci: Add support for expansion ROM BAR
d217089 pci: Add support for expansion ROM BAR
347f8a0 vfio: pci: Mask multi function device bit
b6ae2cc pci: Disable multiple functions
f86b9dd scripts: Add Ubuntu cloud-init data
be199e5 tests: Move Clear Linux cloud-init files to subdirectory
98d7955 vm-virtio: Add support for notifying about virtio config update
93b7753 release-notes: Add v0.1.0 notes
fa41ddd arch: Add a Reserved memory region to the memory hole
299d887 arch: Add SubRegion memory type
792cc27 vfio: Propagate the KVM routes setting error
421b896 vfio: Don't expose an Interrupt Pin
2f80288 vfio: Disable the ROM expansion BAR
e180521 vfio: Fix Memory BAR alignment
d92d797 vfio: Update memory slot index to support multiple VFIO devices
b9f677c vmm: Fix the memory slot index
b5eab43 vfio: Create a global KVM VFIO device for all VFIO devices
0ff074d vm-allocator: Fix potential allocation errors
927861c pci: Fix end of address space check
1971c94 tests: Adjust down entropy expectation
ebe04f6 tests: Use custom kernel for all tests
3cc6f48 docs: Add VFIO usage example
46eaea1 README: Fix kernel command line console argument
1f6f522 build: Upload release binary on tag
5ae3144 tests: Add VFIO integration test
4d16ca8 vmm: Support direct device assignment
b746dd7 vfio: Map MMIO regions into the guest
c93d536 vfio: pci: Build the KVM routes
20f0116 vfio: pci: Track MSI and MSI-X capabilities
db5b476 vfio: Initial PCI support
2cec3aa vfio: VFIO API wrappers and helpers
5372554 vfio-bindings: Initial commit
4e48309 vm: Factorize all virtio devices creation routines
8ba54af vm-virtio: Add integration test for virtio console device
24438e0 vm-virtio:  Enable the vmm support for virtio-console
577d44c vm-virtio: Add virtio console device for single port operation
f98a69f vm-allocator: Introduce an MMIO hole address allocator
a761b82 vm-allocator: Fix the aligned address check
7091488 vm-allocator: Fix free range allocation
0a04a95 vm-allocator: Expand the IRQ allocation API to support GSI
96fb38a vm-allocator: Align address at allocation time
af7cd74 vm-allocator: Make port IO non optional
1268165 pci: Allow for registering IO and Memory BAR
b157181 pci: Fix the way PCI configuration registers are being written
185b108 pci: Add a helper to set the BAR type
ee39e46 pci: Add MSI capability structure
72007f0 pci: Improve MSI-X code to let VFIO rely on it
2987895 pci: Implement the From trait for the PciCapabilityID structure
3f02cca qcow: Add support for QCOW v2 header
6f65f34 build: Ensure caps needed for unit test are set
998140f tests: Remove single test limit
492ab7a build: Use tmpfs for /tmp
80f3311 tests: Use incrementing IP and mac address for VMs
93c2099 tests: Abstract guest management under a struct
eab639e tests: Support customising the cloud-init network details
e9f0174 tests: Create cloud-init image from source files in tests
0776d9d tests: Sleep more in order to speed up tests
7ebfe90 tests: Use a temporary directory for the temporary test files
78fe807 build: Run unit tests on the Jenkins server
1dfe16c vhost_rs: vhost_user: Update unit tests
7499210 vm-virtio: net: Remove attributes for test exclusions
af15ce9 vm-virtio: Update test activate() function
a50c546 qcow: Make unit tests pass
9a17871 pci: Make unit tests compile
74d079f pci: Mark add_capability test as #[ignore] as it is currently failing
18d5286 arch: x86_64: Make unit tests pass
224f775 devices: serial: Make the serial unit tests pass
9e372a8 net_util: Bump pnet dependency
cb81f8b vmm: Make serial port controllable via command line
00df79a README: Really fix the memory parameters examples
bc742d6 main: Add a PCI bridge class integration test
2b2c31d pci: Use device PCI header type for our root bridge
d6d9b76 README: Fix the memory parameter examples
7ed0738 config: Fix default memory size parameter
d9ce291 vmm: Flag --disk should be optional
f0a76ad vmm: Add support for multiple virtio-net devices
a2947f9 cli: Accept K,M,G suffixes for size parameters
2bb0b22 pci: Refine pci topology
4605ecf pci: Extend the Device trait to carry the device BARs
8173e1c devices: Extend the Bus trait to carry the device range base
42e5458 devices: bus: Return the range base address when resolving
33796c4 devices: bus: Sync with crosvm code
4a15316 vm-virtio: Fix the network and storage PCI class and sub-class
77684f4 vm-virtio: Implement the u32 to VirtioDeviceType conversion
0b7fb42 pci: Export network and mass storage sub classes
49d6b49 vmm: Remove println! from debugging
34e0992 vmm: Add support for multiple virtio-pmem devices
785db62 test: Add virtio-pmem integration tests
294c26b vmm: Add virtio-pmem support to cloud-hypervisor
8862d61 vm-virtio: Add virtio-pmem implementation
c0336e8 docs: Add virtio-fs documentation
1cb2378 vmm: Add support for multiple virtio-fs devices
0fcca3e tests: Add virtio-fs testing
53085c7 memory: Allow memory to be backed by a file
2ede30b vmm: Add virtio-fs support to the VMM
1ddc8f2 vm-virtio: Add vhost-user-fs support
8f70771 vhost_rs: Copy vhost crate from jiangliu/v1
8dc06aa vm-virtio: Remove unneeded code
30266a4 vm-memory usage: vm-memory latest codes rename MmapError to Error
9da2343 device: Improvement for BusDevice trait and PciDevice trait
5f7d520 tests: Add split_irqchip test
5e803ab vmm: Integrate userspace IOAPIC
950bd20 devices: Add userspace IOAPIC implementation
c8c4a4d devices: Create Interrupt trait to abstract interrupt delivery
2a7fbe8 CI: Fix the Ubuntu VM update stuck on an interactive window
fe43e86 README: Use a permanent Slack invite link
c4c8b93 build: Switch over to using rust-vmm linux-loader crate
226d336 tests: Add direct boot test using bzImage
429b53a vmm: Add bzimage loader support
0f54429 vmm: Move all the CPUID related code to CpuidPatch
a0f4376 vmm: Set the APIC ID in the extended topology
0d0d19e vmm: Enable TSC_DEADLINE_TIMER allows for PIT emulation removal
946a5d4 build: Update Cargo.lock for syn crate update
72f3a69 tests: Add test for booting from vmlinux
445b484 fixup! resources: Shrink 5.0 kernel config
a45f473 tests: Loosen memory check requirements
52ce042 tests: Bump the Clear Linux version
fa0f1c8 resources: Shrink 5.0 kernel config
24dbe70 irq: Fix pin based interrupt for virtio-pci
4be3dfe build: Update Cargo.lock for linux-loader crate update
4d98dcb msix: Handle MSI-X device masking
d810c77 msix: Handle MSI-X vector masking
42378ca vm-virtio: Fix alignment and MSI-X table size on the BAR
edd1279 pci: Allow QWORD read and write to MSI-X table
00cdbbc pci: Make MSI-X PBA read only
bbd0f5e build: Update Cargo.lock for linux-loader crate update
b0a575d tests: Add a test for PCI MSI
47a4065 interrupt: Use a single closure to describe pin based and MSI-X
8df05b7 vmm: Add MSI-X support to virtio-pci devices
13a065d dep: Rely on latest kvm-ioctls crate
4b53dc4 pci: Add MSI-X implementation
d3c7b45 interrupt: Make IRQ delivery generic
1f53488 tests: Switch to launching by command
ddce3df tests: Add basic integration testing
f63d4a7 vm: Disable stdin and terminal reconfiguration when headless
425841a vm: Do not explictly exit on reset
74a21f2 vendor: Remove vendoring
842515c vendor: Add vmm-sys-util duplicate
89fc75d docs: Initial vendoring documentation
a6b7715 vendor: Move to the rust-vmm vmm-sys-util package
d5f5648 vendor: Add vendored dependencies
e3f7bc2 build: Update Cargo.lock to reflect changed dependencies
8370a5b vmm: Repair the port IO memory alignment
e5e6518 config: Reorganize command line parsing
9900daa README: Update for new --disk usage
a09f918 main, vmm: Add support for multiple --disk options
5279042 vm-allocator: Force documenting all public APIs
9f24775 vm-allocator: Allow for freeing system resources
4b451b0 vm-allocator: Allow for freeing address ranges
8bb71fa vmm: Simplify the vcpu run switch
6615d55 Revert "main: Fix --net behavior"
8e9e760 main: Fix --net behavior
e52132c main: refactored parameter parsing CONTRIBUTING.md: removed a space to suport markdown linking
9299502 cloud-hypervisor: Switch to crates.io kvm-ioctls
0d81937 README: Add travis build status badge
c1f1fe7 vm: Propagate errors appropriately
6ecdd98 virtio: Enable qcow support for virtio-block
919226f cloud-hypervisor: Add README
b60ef22 cloud-hypervisor: Add CREDITS
bcd562e cloud-hypervisor: Add a contributing guide
4daf999 cloud-hypervisor: Add initial list of maintainers
929b343 cloud-hypervisor: Adopt the Contributor Covenant code of conduct
adb0abf main: Make supplying the commandline optional
2c94529 vmm: Propagate boot_kernel errors properly
43965ed main: Improve guest setting log format
fe99c29 vm-virtio: Remove useless PCI BAR debug log
83dadb8 vmm: Remove useless memory setting log
3f38b42 vmm: Fix the Error enum comment
cacce5f vmm: Use random local MAC address as the default one
576a28a net_util: Add helper for generating a random local MAC
5934f30 vmm: Add support for letting the VMM create the TAP interface
0c4c330 cloud-hypervisor: Switch to the linux-loader pending PR branch
ac328df cloud-hypervisor: Switch to th…

---
## [petre-symfony/form-symfony-system@ed0295c9e5...](https://github.com/petre-symfony/form-symfony-system/commit/ed0295c9e53678d7e8b6f07e2ac4e65ab42561ba)
##### 2020-02-08 07:44:35 by petrero

11.1.Form Rendering Functions: form_*{The Form Rendering Functions; CSRF Tok
en; form_widget and form_row()}

To render the form, we're using a few form functions: one that makes the form start tag, one that makes the end tag and one that renders all the fields, labels and errors inside.
This was easy to set up. The problem is that we have almost no control over the HTML markup that's used! Sure, we were able to activate a "form theme" that told it to use Bootstrap-friendly markup. But, what if you need more control?
This is probably the hardest part of Symfony's form system. But don't worry: we're going to learn several different strategies to help you get the markup you need... without going crazy... probably.

The Form Rendering Functions
Go to your other tab and Google for "Symfony form rendering functions" to find a page that talks all about the functions we're using and a few others.
First, form_start(), yes, this does just render the form start tag, which might seem kind of silly, but it can come in handy when you add a file upload field to your form: it automatically add the enctype attribute.
Oh, but notice: form_start() has a second argument: an array of variables that can be passed to customize it. Apparently you can pass method to change the method attribute or attr to add any other attributes to the form tag - like a class.
Next: find form_end(). This one seems even sillier because it literally prints... yep! The form closing tag! But, it has a hidden superpower: it also renders any fields that we forgot to render. Now, that might not make sense yet because this magic form_widget() function seems to be rendering everything automatically. But, in a moment, we'll render the fields one-by-one. When we do that, if we've forgotten to render any of the fields, form_end() will render them for us... and then the closing tag.
That still may not seem like a good feature... and, in many ways, it's not! In reality, the purpose of this is not so that we can be lazy and form_end() will save us. Nope - the true purpose is that form_end() will render any hidden fields automatically, without us needing to even think about them. Most importantly, it will render your form's CSRF token

CSRF Token
Inspect element near the bottom of the form. Woh! Without us doing anything, we have a hidden input tag called _token. This is a CSRF token and it was automatically added by Symfony. And, even cooler, when we submit, Symfony automatically validates it.
Without even knowing it, all of our forms are protected from CSRF attacks.

form_widget and form_row()
Back to the form rendering goodness! To print the form fields themselves, the easiest way is to call form_widget() and pass the entire form. But, if you need a little bit more control, instead of form_widget(), you can call form_row() and render each field individually. For example, articleForm.title. Copy that and paste it three more times. Render articleForm.content, articleForm.publishedAt and articleForm.author.

---
## [Akemi/mpv@cce7062a8a...](https://github.com/Akemi/mpv/commit/cce7062a8a6b6a3b3666aea3ff86db879cba67b6)
##### 2020-02-08 09:59:09 by wm4

lua: fix highly security relevant arbitrary code execution bug

It appears Lua's package paths try to load .lua files from the current
working directory. Not only that, but also shared libraries.

  WHAT THE FUCK IS WHOEVER IS RESPONSIBLE FOR THIS FUCKING DOING?

mpv isn't setting this package path; currently it's only extending it.
In any sane world, this wouldn't be a default. Most programs use
essentially random working directories and don't change it.

I cannot comprehend what bullshit about "convenience" or whatever made
them do something this broken and dangerous. Thousands of programs using
Lua out there will try to randomly load random code from random
directories.

In mpv's case, this is so security relevant, because mpv is normally
used from the command line, and you will most likely actually change
into your media directory or whatever with the shell, and play a file
from there. No, you don't want to load a (probably downloaded) shared
library from this directory if a script try to load a system lib with
the same name or so.

I'm not sure why LUA_PATH_DEFAULT in luaconf.h (both upstream and the
Debian version) put "./?.lua" at the end, but in any case, trying to
load a module that doesn't exist nicely lists all package paths in
order, and confirms it tries to load files from the working directory
first (anyone can try this). Even if it didn't, this would be
problematic at best.

Note that scripts are _not_ sandboxed. They're allowed to load system
libraries, which is also why we want to keep the non-idiotic parts of
the package paths.

Attempt to fix this by filtering out relative paths. This is a bit
fragile and not very great for something security related, but probably
the best we can do without having to make assumptions about the target
system file system layout. Also, someone else can fix this for Windows.

Also replace ":" with ";" (for the extra path). On a side note, this
extra path addition is just in this function out of laziness, since
I'd rather not have 2 functions with edit the package path.

mpv in default configuration (i.e. no external scripts) is probably not
affected. All builtin scripts only "require" preloaded modules, which,
in a stroke of genius by the Lua developers, are highest priority in the
load order. Otherwise, enjoy your semi-remote code execution bug.

Completely unrelated this, I'm open for scripting languages and
especially implementations which are all around better than Lua, and are
suited for low footprint embedding.

---
## [Akemi/mpv@31acec5438...](https://github.com/Akemi/mpv/commit/31acec543819cf56d63dddae59507858b1229b75)
##### 2020-02-08 09:59:09 by wm4

path: change win32 semantics for joining drive-relative paths

win32 is a cursed abomination which has "drive letters" at the root of
the filesystem namespace for no reason. This requires special handling
beyond tolerating the idiotic "\" path separator.

Even more cursed is the fact that a path starting with a drive letter
can be a relative path. For example, "c:billsucks" is actually a
relative path to the current working directory of the C drive. So for
example if the current working directory is "c:/windowsphone", then
"c:billsucks" would reference "c:/windowsphone/billsucks".

You should realize that win32 is a ridiculous satanic trash fire by the
point you realize that win32 has at least 26 current working
directories, one for each drive letter.

Anyway, the actual problem is that mpv's mp_path_join() function would
return a relative path if an absolute relative path is joined with a
drive-relative path. This should never happen; I bet it breaks a lot of
assumptions (maybe even some security or safety relevant ones, but
probably not).

Since relative drive paths are such a fucked up shit idea, don't try to
support them "properly", and just solve the problem at hand. The
solution produces a path that should be invalid on win32.

Joining two relative paths still behaves the same; this is probably OK
(maybe).

The change isn't very minimal due to me rewriting parts of it without
strict need, but I don't care.

Note that the Python os.path.join() function (after which the mpv
function was apparently modeled) has the same problem.

---
## [petre-symfony/form-symfony-system@73ba2133f5...](https://github.com/petre-symfony/form-symfony-system/commit/73ba2133f536f772d91b6a54e688d1600eef30e7)
##### 2020-02-08 10:01:05 by petrero

18.1.Agree to Terms Checkbox Field

The User class has an agreedTermsAt property that expects a DateTime object. But, our form has an agreeTerms field that, on submit, will give us a true/false boolean value. How can we make these work together? As I so often like to say: there are two options.
First, we could be clever! There is no agreeTerms property on User. But, we could create a setAgreeTerms() method on User. When that's called, we would actually set the agreedTermsAt property to the current date. We would also need to create a getAgreeTerms() method that would return a boolean based on whether or not the agreedTermsAt property was set.
This is a fine solution. But, this is also a good example of how the form system can start to make your life harder instead of easier. When your form and your class don't look the same, sometimes you can find a simple and natural solution. But sometimes, you might need to dream up something crazy to make it all work. If the solution isn't obvious to you, move on to option two: make the field unmapped.
Let's try that: set agreeTerms to mapped false. To force this to be checked, add constraints set to a new IsTrue()... because we need the underlying value of this field to be true, not false. Set a custom message:

  I know, it's silly, but you must agree to our terms
Excellent! Thanks to the mapped = false, the form should at least load. Try it - refresh! Yes! Well... oh boy - our styling is so bad, the checkbox is hiding off the screen! Let's worry about that in a minute.

---
## [mrakgr/The-Spiral-Language@7d4796eeb0...](https://github.com/mrakgr/The-Spiral-Language/commit/7d4796eeb0ad64d9d7618d6d6b2675e5f4ef4cd3)
##### 2020-02-08 11:13:54 by Marko Grdinić

"9:40am. Ok, enough chilling. I've been doing that for nearly an hour. It is time to get something done.

9:45am. Let me open the IDE...

```
let test41: SpiralModule =
    {
    name="test40"
    prerequisites=[]
    description="Does the let statement work?"
    code=
    """
inl main _ =
    let f (x : i64) = x
    f 3
    """
    }
```

This just gets me `Box not implemented`.

```
| Op(op,_) -> raise_type_error d <| sprintf "Compiler error: %A not implemented" op
```

This is strange. At least when annotation is given I'd expect it to go through a different channel.

```
    | AnnotTest(do_boxing,ty,expr,on_succ,on_fail) ->
        let a = v expr
        let b = tev d ty
        if do_boxing then ev (push_value_var (box' d (a,b)) d) on_succ
        else if data_to_ty a = b then ev d on_succ else ev d on_fail
```

I mean this thing here.

Actually, do I even need the regular box?

Well...

Actually, I should make `ty` optional here. That way the typechecker will know where it has to put things.

10:10am. I am thinking here.

All this is so complicated.

Just how many different ways of boxing can there be?

If I am going to box, the most sensible thing would be to put the annotation directly in the function. That way, the typechecker will later know that it has to propagate this information and put it in the right place.

10:45am. https://thegradient.pub/independently-reproducible-machine-learning/

Let me read this.

I am still thinking about the whole issue of annotations vs boxing.

11am. Still thinking about it...

11:35am. In the bathroom...on this chair...I am still thinking about it.

11:55am. I can't believe I am completely stuck on this. It is not even closure conversion that is the problem, but how to deal with annotations instead.

I put in let statements haphazardly, saying the typechecker will take care of it, but now it is the time to really think about it.

What I am thinking about now is skipping the closure conversion thing and moving straight onto typechecking. That will clear things up for me.

12pm. Let me stop here. I did not do any programming to speak of despite having a head start.

Damn it, I really did want to make progress on closure conversion this morning too.

Nevermind. Forget that.

That and macros will be done in due time.

What I am going to do now is start the second part of the language. The parts up to now were only there to finally deal with the compilation issues. It is the top down typing that will really be Spiral's wings. It is this what will allow me to fight through the cruel world of computer science.

12:10pm. Ah damn it, now I am reading shitty ML sub threads. Let me have breakfast here.

I hadn't planned on starting typechecking right away so I've been caught flatfooted.

I am going to think about this for a bit and then just get on with it.

I'll do closure conversion while working on part two.

It is important that I get this done. Typechecking via constraint solving is something new even to me, and it will be the first time I will be working on this. And while I am doing this, I will also be ironing out the syntax so that the two pieces integrate nicely.

It is only after I've done this that I can say that the new language is complete.

This will be the real deal. The one true test of skill in PL development.

After I do this, I really will have done it all.

After it is done, all that will remain is for me to fish for the right ML algorithms."

---
## [petre-symfony/form-symfony-system@8407424a1c...](https://github.com/petre-symfony/form-symfony-system/commit/8407424a1c9fce2076648e78f26a35dd576bbd17)
##### 2020-02-08 16:45:35 by petrero

26.2.Leveraging Custom Field Options{Adding a finderCallback Option; Investigating the Core Field Types}

Cool! We've now made this class a little bit more flexible. But, that doesn't really help us yet. How can we allow this  to be customized each time we use this field? By creating a brand new field option.
Check this out: we know that invalid_message is already an option in Symfony and we're changing its default value. But, we can invent new options too! Add a new option called finder_callback and give it a default value: a callback that accepts a UserRepository $userRepository argument and the value - which will be a string $email. Inside return the normal $userRepository->findOneBy() with ['email' => $email].
Next, check out the build() method. See this array of $options? That will now include finder_callback, which will either be our default value, or some other callback if it was overridden.
Let's break this onto multiple lines and, for the second argument to EmailToUserTransformer, pass $options['finder_callback'].
Ok! Let's make sure it works. I'll hit enter on the URL to reload the page. Then, change to spacebar2@example.com, submit and... yes! It saves!
The real power of this is that, in ArticleFormType, when we use UserSelectTextType, we can pass a finder_callback option if we need to do a custom query. If we did that, it would override the default value and, when we instantiate EmailToUserTransformer, the second argument would be the callback that we passed from ArticleFormType.

Investigating the Core Field Types
This is how options are used internally by the core Symfony types. Oh, and you probably noticed by now that every field type in Symfony is represented by a normal, PHP class! If you've ever want to know more about how a specific field or option works, just open up the class!
For example, we know that this field is a DateTimeType. Press Shift+Shift and look for DateTimeType - open the one from the Form component. I love it - these classes will look a lot like our own custom field type class! This one has a build() method that adds some transformers. And if you scroll down far enough, cool! Here is the configureOptions() method where all of the valid options are defined for this field.
Want to know how one of these options is used? Copy its name and find out! Search for the with_seconds option. No surprise: it's used in buildForm(). If you looked a little further, you'd see that this is eventually used to configure how the data transformer works.
These core classes are a great way to figure out how to do something advanced or to get inspiration for your own custom field type. Don't' be afraid to dig!
Next: let's hook up some auto-complete JavaScript to this field.

---
## [mrakgr/The-Spiral-Language@8ac02d8b0f...](https://github.com/mrakgr/The-Spiral-Language/commit/8ac02d8b0f720f9b6eeff5789bb438cf180fc88b)
##### 2020-02-08 16:56:31 by Marko Grdinić

"5:10pm. Ok, I've somewhat fortified my mind. I've been in bed all this time thinking. I'd be lying if I said I was thinking about programming only, but going through blocks like these takes time.

Ok, first thing's first.

The part one of the language is nearly done. The things that are missing: union types, closures, macros are minor challenges that if wasn't intending to move to typechecking I would finish swiftly in a day or two. So that is what I mean by nearly done.

5:20pm. Right now I've been approaching this problem from the perspective of extending the work that I've done.

5:25pm. But that is not the right way to go about this.

Instead I need to fully commit to the top-down aspect. I won't be able to do the integration until I master it.

For this kind of planning to be done, it is not enough to have a rough conceptual understanding. My mastery of the subject has to be complete.

5:30pm. So here is what I will do. I will literally abandon the v0.2 stuff that I've done up to now. I can lie as it is for a few months.

Instead what I will do is start a new project, that is focused exclusively on the typechecking aspects of Spiral.

My goal will just be to do the typechecking, and alongside that I will begin work on the VSCode plugin.

When that is done, I will bring in the constraints and the partial evaluator.

5:35pm. It will be much easier to develop the new half in isolation and connect it later rather than do it all simultaneously.

I want to fully dedicate myself mentally to this next part without necessarily burdening myself with thoughts of what the prepass or the partial evaluator should be doing.

5:40pm. It is much earlier than I thought it would be, but the gong of destiny has been struck. It is time to begin the second fateful part of Spiral.

The big lesson from all of this is that even though partial evaluation can be used to do anything, it is not necessarily the best idea to actually do so.

The parallels with deep learning aren't escaping me.

Backprop is a key thing that can potentially do anything, but cannot scale all the way. Naive ways of doing regularization: L2 norm, weight norm, layer norm...aren't enough to deal with its issues. Neither can architectural tricks.

There is definitely something missing before the full picture can be completed.

In case of Spiral, I can see the issues and the problem clearly, but in the case of deep learning only the issues are clear. The neural equivalent of unification is shrouded in absolute darkness.

When the veil gets lifted, I will be able to move on to the next step and fulfill the old promises of the last decade.

5:50pm. Well, I'll take it easy from here.

Typechecking and the plugin sound like a big deal, but compared to the things I've done so far, they should not be too much.

Contextually, it seems partial evaluation is a more advanced subject than typechecking so I should be safe as long as I take it one at a time. Rather than let myself be crushed by the immensity of work I've yet to do, I need to look at the lighter aspects of the work that is to come.

For the first time in my life, I will be writing top-down Spiral code. If that is not something to look forward to, I do not know what is."

---
## [DanOscarsson/mpv@b9d351f02a...](https://github.com/DanOscarsson/mpv/commit/b9d351f02a3266b76256a90fc9c51f9d3cbf185d)
##### 2020-02-08 17:03:53 by wm4

Implement backwards playback

See manpage additions. This is a huge hack. You can bet there are shit
tons of bugs. It's literally forcing square pegs into round holes.
Hopefully, the manpage wall of text makes it clear enough that the whole
shit can easily crash and burn. (Although it shouldn't literally crash.
That would be a bug. It possibly _could_ start a fire by entering some
sort of endless loop, not a literal one, just something where it tries
to do work without making progress.)

(Some obvious bugs I simply ignored for this initial version, but
there's a number of potential bugs I can't even imagine. Normal playback
should remain completely unaffected, though.)

How this works is also described in the manpage. Basically, we demux in
reverse, then we decode in reverse, then we render in reverse.

The decoding part is the simplest: just reorder the decoder output. This
weirdly integrates with the timeline/ordered chapter code, which also
has special requirements on feeding the packets to the decoder in a
non-straightforward way (it doesn't conflict, although a bugmessmass
breaks correct slicing of segments, so EDL/ordered chapter playback is
broken in backward direction).

Backward demuxing is pretty involved. In theory, it could be much
easier: simply iterating the usual demuxer output backward. But this
just doesn't fit into our code, so there's a cthulhu nightmare of shit.
To be specific, each stream (audio, video) is reversed separately. At
least this means we can do backward playback within cached content (for
example, you could play backwards in a live stream; on that note, it
disables prefetching, which would lead to losing new live video, but
this could be avoided).

The fuckmess also meant that I didn't bother trying to support
subtitles. Subtitles are a problem because they're "sparse" streams.
They need to be "passively" demuxed: you don't try to read a subtitle
packet, you demux audio and video, and then look whether there was a
subtitle packet. This means to get subtitles for a time range, you need
to know that you demuxed video and audio over this range, which becomes
pretty messy when you demux audio and video backwards separately.

Backward display is the most weird (and potentially buggy) part. To
avoid that we need to touch a LOT of timing code, we negate all
timestamps. The basic idea is that due to the navigation, all
comparisons and subtractions of timestamps keep working, and you don't
need to touch every single of them to "reverse" them.

E.g.:

    bool before = pts_a < pts_b;

would need to be:

    bool before = forward
        ? pts_a < pts_b
        : pts_a > pts_b;

or:

    bool before = pts_a * dir < pts_b * dir;

or if you, as it's implemented now, just do this after decoding:

    pts_a *= dir;
    pts_b *= dir;

and then in the normal timing/renderer code:

    bool before = pts_a < pts_b;

Consequently, we don't need many changes in the latter code. But some
assumptions inhererently true for forward playback may have been broken
anyway. What is mainly needed is fixing places where values are passed
between positive and negative "domains". For example, seeking and
timestamp user display always uses positive timestamps. The main mess is
that it's not obvious which domain a given variable should or does use.

Well, in my tests with a single file, it suddenly started to work when I
did this. I'm honestly surprised that it did, and that I didn't have to
change a single line in the timing code past decoder (just something
minor to make external/cached text subtitles display). I committed it
immediately while avoiding thinking about it. But there really likely
are subtle problems of all sorts.

As far as I'm aware, gstreamer also supports backward playback. When I
looked at this years ago, I couldn't find a way to actually try this,
and I didn't revisit it now. Back then I also read talk slides from the
person who implemented it, and I'm not sure if and which ideas I might
have taken from it. It's possible that the timestamp reversal is
inspired by it, but I didn't check. (I think it claimed that it could
avoid large changes by changing a sign?)

VapourSynth has some sort of reverse function, which provides a backward
view on a video. The function itself is trivial to implement, as
VapourSynth aims to provide random access to video by frame numbers (so
you just request decreasing frame numbers). From what I remember, it
wasn't exactly fluid, but it worked. It's implemented by creating an
index, and seeking to the target on demand, and a bunch of caching. mpv
could use it, but it would either require using VapourSynth as demuxer
and decoder for everything, or replacing the current file every time
something is supposed to be played backwards.

FFmpeg's libavfilter has reversal filters for audio and video. These
require buffering the entire media data of the file, and don't really
fit into mpv's architecture. It could be used by playing a libavfilter
graph that also demuxes, but that's like VapourSynth but worse.

---
## [DanOscarsson/mpv@5b4ae42328...](https://github.com/DanOscarsson/mpv/commit/5b4ae42328b75b2f7683d04736d3c07108b0bcc3)
##### 2020-02-08 17:03:53 by wm4

demux_raw: fix operation with demuxer cache and backward playback

Raw audio formats can be accessed sample-wise, and logically audio
packets demuxed from it would contain only 1 sample. This is
inefficient, so raw audio demuxers typically "bundle" multiple samples
in one packet.

The problem for the demuxer cache and backward playback is that they
need properly aligned packets to make seeking "deterministic". The
requirement is that if you read some packets, and then seek back, you
eventually see the same packets again. demux_raw basically allowed to
seek into the middle of a previously returned packet, which makes it
impossible to make the transition seamless. (Unless you'd be aware of
the packet data format and cut them to make it seamless, which is too
complex for such a use case.)

Solve this by always aligning seeks to packet boundaries. This reduces
the seek accuracy to the arbitrarily chosen packet size. But you can use
hr-seek to fix this. The gain from not making raw audio an awful special
case pays in exchange for this "stupid" suggestion to use hr-seek.

It appears this also fixes that it could and did seek into the middle of
the frame (not sure if this code was ever tested - it goes back to
removing the code duplication between the former demux_rawaudio.c and
demux_rawvideo.c).

If you really cared, you could introduce a seek flag that controls
whether the seek is aligned or not. Then code which requires
"deterministic" demuxing could set it. But this isn't really useful for
us, and we'd always set the flag anyway, unless maybe the caching were
forced disabled.

libavformat's wav demuxer exhibits the same issue. We can't fix it (it
would require the unpleasant experience of contributing to FFmpeg), so
document this in otions.rst. In theory, this also affects seek range
joining, but the only bad effect should be that cached data is
discarded.

---
## [Shadowfire117/CHOMPStation2@e141872c31...](https://github.com/Shadowfire117/CHOMPStation2/commit/e141872c31ea745903a992de43d0c3162d87b29e)
##### 2020-02-08 21:22:07 by Shadowfire

Casino port

This is first phase of casino port where I have made my casino spaceship compatible with new chomp codebase. There isnt a connecting port at station yet due to changes being made to main map, but with second phase of casino port there should be one for casino shuttle to move back and forth to transfer visitors.

Non-casino changes
Port of:
purple assistant cap, wah!
wiggler hat, dont know if the sprite works fully yet.
The monocoole, every self respecting technomancer needs this! Also need this for casino rewards.
Snaps, can recommend for lunch, I prefer the licorice flavoured ones!
Space cleaner dispenser, yep any janitors dream, so far its only on casino spaceship.
Ported old modular sofa for station usage, is already on casino, future plans could involve making the modular sofa that can be built from steel be a little more pretty and made from wood as well and also get another overlay/color when added cloth for cushion.

also deleting a .txt file that I didnt get to delete before someone really wanted me to upload wip files so they could work off them, sorry about that but its fixed now!
deleted alienwhitelist and custom_items.txt since github doesnt seem to have those blacklisted

casino port:
Ported the map with the golden goose spacecasino
ported the deluxe edition bar and kitchen gear! Say hello to the good old deluxe dispenser, deluxe food vendor and deluxe drink vendor, perhaps one day they will be constructible by crew!
ported the casino stripper pole, casino roulette, slotmachine, poker/blackjack table, ported the casino wheel of fortune
casino wallet~
casino jukebox! And re implemented the system so the casino songs no longer are on the normal jukebox, sorry folks, hope you didnt like them too much :c
casino visitor and staff manual, might need a bit of revision depending on what event managers wants
Casino chips, gotta gamble with something!
fixed runtime errors from deluxe dispenser trying to add cartridges with reagents that have been renamed on new chomp

Be aware, there will be more casino changes in near future along with some other non-casino changes, including porting of pint metamorphic glass.

---
## [petre-symfony/form-symfony-system@82fdc07af1...](https://github.com/petre-symfony/form-symfony-system/commit/82fdc07af12504dcc0593a00e0da20f5e279a9db)
##### 2020-02-08 23:03:30 by petrero

31.2.Form Type Extension{Registering the Form Type Extension; The form.type_extension Tag & autoconfigure}

Registering the Form Type Extension
The only new method is getExtendedType() - we'll talk about that in a second. To tell Symfony that this form type extension exists and to tell it that we want to extend the TextareaType, we need a little bit of config. This might look confusing at first. Let's code it up, then I'll explain.
Open config/services.yaml. And, at the bottom, we need to give our service a "tag". First, put the form class and below, add tags. The syntax here is a bit ugly: add a dash, open an array and set name to form.type_extension. Then I'll create a new line for my own sanity and add one more option extended_type. We need to set this to the form type class that we want to extend - so TextareaType. Let's cheat real quick: I'll use TextareaType, auto-complete that, copy the class, then delete that. Go paste it in the config. Oh, and I forgot my comma!
As soon as we do this, every time a TextareaType is created in the system, every method on our TextareaSizeExtension will be called. It's almost as if each of these methods actually lives inside of the TextareaType class! If we add some code to buildForm(), it's pretty much identical to opening up the TextareaType class and adding code right there!

The form.type_extension Tag & autoconfigure
Now, two important things. If you're using Symfony 4.2, then you do not need to add any of this code in services.yaml. Whenever you need to "plug into" some part of Symfony, internally, you do that by registering a service and giving it a "tag". The form.type_extension tag says:

  Hey Symfony! This isn't just a normal service! It's a form type extension! So make sure you use it for that!

But these days, you don't see "tags" much in Symfony. The reason is simple: for most things, Symfony looks at the interfaces that your service implements, and adds the correct tags automatically. In Symfony 4.1 and earlier, this does not happen for the FormTypeExtensionInterface. But in Symfony 4.2... it does! So, no config needed... at all.
But then, how does Symfony know which form type we want to extend in Symfony 4.2? The getExtendedType() method! Inside, return TextareaType::class. And yea, we also need to fill in this method in Symfony 4.1... it's a bit redundant, which is why Symfony 4.2 will be so much cooler.

 Tip

Since Symfony 4.2 getExtendedType() method is deprecated in favor of getExtendedTypes() but you still need a dummy implementation of getExtendedType()

---

# [<](2020-02-07.md) 2020-02-08 [>](2020-02-09.md)

