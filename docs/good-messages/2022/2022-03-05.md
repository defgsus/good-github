# [<](2022-03-04.md) 2022-03-05 [>](2022-03-06.md)

1,428,637 events recorded by [gharchive.org](https://www.gharchive.org/) of which 1,428,637 were push events containing 2,116,898 commit messages that amount to 133,669,824 characters filtered with [words.py@e23d022007...](https://github.com/defgsus/good-github/blob/e23d022007992279f9bcb3a9fd40126629d787e2/src/words.py) to these 29 messages:


## [Melon-Tropics/bitcoin](https://github.com/Melon-Tropics/bitcoin)@[619f8a27ad...](https://github.com/Melon-Tropics/bitcoin/commit/619f8a27ad0f6a44f0ad1a1e55a0aaaef7a91312)
#### Saturday 2022-03-05 00:05:15 by MarcoFalke

Merge bitcoin/bitcoin#24304: [kernel 0/n] Introduce `bitcoin-chainstate`

2c03cec2ff8cdbfd5da92bfb507d218e5c6435b0 ci: Build bitcoin-chainstate (Carl Dong)
095aa6ca37bf0bd5c5e221bab779978a99b2a34c build: Add example bitcoin-chainstate executable (Carl Dong)

Pull request description:

  Part of: #24303

  This PR introduces an example/demo `bitcoin-chainstate` executable using said library which can print out information about a datadir and take in new blocks on stdin.

  Please read the commit messages for more details.

  -----

  #### You may ask: WTF?! Why is `index/*.cpp`, etc. being linked in?

  This PR is meant only to capture the state of dependencies in our consensus engine as of right now. There are many things to decouple from consensus, which will be done in subsequent PRs. Listing the files out right now in `bitcoin_chainstate_SOURCES` is purely to give us a clear picture of the task at hand, it is **not** to say that these dependencies _belongs_ there in any way.

  ### TODO

  1. Clean up `bitcoin-chainstate.cpp`
     It is quite ugly, with a lot of comments I've left for myself, I should clean it up to the best of my abilities (the ugliness of our init/shutdown might be the upper bound on cleanliness here...)

ACKs for top commit:
  ajtowns:
    ACK 2c03cec2ff8cdbfd5da92bfb507d218e5c6435b0
  ryanofsky:
    Code review ACK 2c03cec2ff8cdbfd5da92bfb507d218e5c6435b0. Just rebase, comments, formatting change since last review
  MarcoFalke:
    re-ACK 2c03cec2ff8cdbfd5da92bfb507d218e5c6435b0 üèî

Tree-SHA512: 86e7fb5718caa577df8abc8288c754f4a590650d974df9d2f6476c87ed25c70f923c4db651c6963f33498fc7a3a31f6692b9a75cbc996bf4888c5dac2f34a13b

---
## [josephanimate2021/josephanimate2021.github.io](https://github.com/josephanimate2021/josephanimate2021.github.io)@[4b1501e208...](https://github.com/josephanimate2021/josephanimate2021.github.io/commit/4b1501e208f651093aae091196359156a66d9855)
#### Saturday 2022-03-05 00:24:53 by idiotkid

im suffering, im suffering again... 

[Mark:]
Something here seems foul
Something here just reeks of
Blood and suffering

Could it be these halls are echoing
Of death?
We'll see

In all my dreams I see
A maze of halls with
Bloody walls and
Countless scrawls reminding me
It's me

Don't play these games
You've lost your fright
I'm armed with more than a light
And I'm surviving five nights

No phones, no screens
No more
Just you and me
A gun or three
And nothing else between me
And this door

You bring the fur
I'll bring the fight
Hey Foxy, come get a bite
'Cause I'm surviving five nights

---
## [MacBlaze1/tgstation](https://github.com/MacBlaze1/tgstation)@[3bd5a2d8df...](https://github.com/MacBlaze1/tgstation/commit/3bd5a2d8df49213708540f1c0ffe0873b5d2e233)
#### Saturday 2022-03-05 00:37:04 by Wallem

Makes Ants glow, puts a minimum on ant screaming and shoe permeability, and other ant-related things. (#64786)

I found out how emissives work and my first thought was "damn ants should glow that would look sick"
So now they do.

Also, having less than 5u ants in your body will make you not scream, so 0.0001u ants will no longer have that tiny chance of making someone scream for their life.

If an ant pile has a max damage value less than 1, then they won't be able to bite through your shoes. This is the same threshold as the second tier ant icon.

Makes the giant ant a hostile mob with the neutral faction, meaning they will attack anything not in the neutral faction.

---
## [josephanimate2021/josephanimate2021.github.io](https://github.com/josephanimate2021/josephanimate2021.github.io)@[ec111d3897...](https://github.com/josephanimate2021/josephanimate2021.github.io/commit/ec111d38973541015fe46a85aaae3e64914eaea5)
#### Saturday 2022-03-05 00:46:07 by idiotkid

After a painful hour or 2 of FUCKING HELL, at last im finished!

If this doesn't work I am going to lose my fucking sanity and throw a tantrum!

---
## [CitiesSkylinesMods/TMPE](https://github.com/CitiesSkylinesMods/TMPE)@[8ad7a2983d...](https://github.com/CitiesSkylinesMods/TMPE/commit/8ad7a2983d9e313858480015773933ca4c60a309)
#### Saturday 2022-03-05 00:55:53 by aubergine10

gah, my brain while my friends are being bombed = mush

Note: FUCK ALL STATE FUNDED TERORIST GROUPS

---
## [Giu13sse/holbertonschool-low_level_programming](https://github.com/Giu13sse/holbertonschool-low_level_programming)@[c7a56c2305...](https://github.com/Giu13sse/holbertonschool-low_level_programming/commit/c7a56c23059d9ca6bb73c00d4979699b16a5bd0b)
#### Saturday 2022-03-05 01:18:29 by Giu13sse

Love, let's talk about love
Is it anything and everything you hoped for?
Or do the feeling haunt you?
I know the feeling haunt you
This maybe the night that my dreams might let me know

---
## [LetterN/CEV-Eris](https://github.com/LetterN/CEV-Eris)@[c3fb43155f...](https://github.com/LetterN/CEV-Eris/commit/c3fb43155f41f2f0409bd4269b1a10546f6d3a97)
#### Saturday 2022-03-05 06:59:59 by Wouju

Reality Complicator, i luv me terror button (#6836)

* Yeah we're back

* Revert "Yeah we're back"

This reverts commit ddb5b5ed146c154be8cc6089621f6b332eb3086f.

* complicatorium

* map shit

* Update code/game/objects/items/complicator.dm

Co-authored-by: hyperioo <64754494+hyperioo@users.noreply.github.com>

---
## [KDE/kstars](https://github.com/KDE/kstars)@[ec9448cbd3...](https://github.com/KDE/kstars/commit/ec9448cbd3604bd3192531633957bd2b06df8370)
#### Saturday 2022-03-05 08:45:49 by Hy Murveit

New Greedy Algorithm for Scheduler

This MR now adds an alternative scheduling algorithm, called the Greedy Algorithm, or Greedy Scheduler.
It will attempt to fill the time so the telescope is busy all night, if the user provides enough scheduler jobs.
Like the classic scheduler, it tries to maintain a priority list, preferring jobs earlier in the list.  However, if it can fit in some time before a preferred job can start, it runs the highest priority runnable job until that preferred job can start. This works well for multi-day scheduling, or single-day scheduling.

This does not affect the classic algorithm, if the user chooses that, then jobs will be scheduled as they have in the past. (See disclaimer at the bottom re rememberJobProgress).

There is a UI choice for algorithms on the scheduler tab, defaulting to 'classic', and the users choice is stored in the .esl file that's saved, and restored for that loaded schedule.

I have added significant testing for this (see test_ekos_scheduler_ops.cpp). I have run on my telescope several nights and things have run well.

I am excited about this, I think it can add a new¬†way for folks to use Ekos. The bottom line is that this can¬†**increase the¬†usage of your imaging system**. I'd recommend for users to add, in addition to some primary targets, some background targets that could be run when the primary targets can't image. Ideally Ekos¬†would images all night, capturing as¬†many images of the main targets as possible, and also filling¬†in background targets when it can.

Job priority is simply the¬†order of the jobs (with an exception for StartAt which I've tried to give highest priority to).

**Screenshot**:
https://drive.google.com/file/d/1WjQ0g3ZFDNWEisRtS50nHqz255Lfmy87/view?usp=sharing
You can see I have enough jobs to keep it busy all night. My real target is Sombrero (M104) but that's only visible to me for 3.5 hours.¬†

**Status**: I am now feature complete for Greedy Scheduler version 1.0. I have been testing every night, but the weather is now bad for several days. I have refactored/commented code and removed Draft. I will follow-up with a separate MR to introduce a scheduler algorithm interface class.

**Disclaimer**: There is one change that does affect the way the classic scheduler would work. I could make this an option or tie it to the Greedy Scheduler, but I believe both schemes benefit from this change. The change relates to the way "Options::rememberJobProgress()" works. Previously that did not apply to LOOP or STOP_AT jobs. Now it applies to all stopping conditions. Previously it made no attempt to balance the various subjobs (i.e. filter captures). It will now look at the progress in the different filters/keys and attempt to equalize what's been done. That is, if one filter has gone through 10 repeats (e.g. because it's first and the job was consistently pre-empted after that filter) and another filter has only gone through 1 repeat (because of those same preemptions), the scheme will focus the captures on the more needy filter until things are balanced. I believe that's more in the spirit of "rememberJobProgress".

---
## [ishitatsuyuki/LatencyFleX](https://github.com/ishitatsuyuki/LatencyFleX)@[0d9f3f7276...](https://github.com/ishitatsuyuki/LatencyFleX/commit/0d9f3f7276199930b8ceceec8f344b98d94523a0)
#### Saturday 2022-03-05 08:48:11 by Tatsuyuki Ishi

readme: Add Apex Legends as a supported game

A huge thanks to Valve for bringing this amazing reality, EA & Respawn for their cooperation, and EAC for developing a developer friendly anti-cheat solution.

[ci skip]

---
## [Kaz205/renoir](https://github.com/Kaz205/renoir)@[e38c1c8a9a...](https://github.com/Kaz205/renoir/commit/e38c1c8a9af5dc42fd8e3485960484dc3fa26c7a)
#### Saturday 2022-03-05 10:50:12 by Peter Zijlstra

sched/core: Fix ttwu() race

Paul reported rcutorture occasionally hitting a NULL deref:

  sched_ttwu_pending()
    ttwu_do_wakeup()
      check_preempt_curr() := check_preempt_wakeup()
        find_matching_se()
          is_same_group()
            if (se->cfs_rq == pse->cfs_rq) <-- *BOOM*

Debugging showed that this only appears to happen when we take the new
code-path from commit:

  2ebb17717550 ("sched/core: Offload wakee task activation if it the wakee is descheduling")

and only when @cpu == smp_processor_id(). Something which should not
be possible, because p->on_cpu can only be true for remote tasks.
Similarly, without the new code-path from commit:

  c6e7bd7afaeb ("sched/core: Optimize ttwu() spinning on p->on_cpu")

this would've unconditionally hit:

  smp_cond_load_acquire(&p->on_cpu, !VAL);

and if: 'cpu == smp_processor_id() && p->on_cpu' is possible, this
would result in an instant live-lock (with IRQs disabled), something
that hasn't been reported.

The NULL deref can be explained however if the task_cpu(p) load at the
beginning of try_to_wake_up() returns an old value, and this old value
happens to be smp_processor_id(). Further assume that the p->on_cpu
load accurately returns 1, it really is still running, just not here.

Then, when we enqueue the task locally, we can crash in exactly the
observed manner because p->se.cfs_rq != rq->cfs_rq, because p's cfs_rq
is from the wrong CPU, therefore we'll iterate into the non-existant
parents and NULL deref.

The closest semi-plausible scenario I've managed to contrive is
somewhat elaborate (then again, actual reproduction takes many CPU
hours of rcutorture, so it can't be anything obvious):

					X->cpu = 1
					rq(1)->curr = X

	CPU0				CPU1				CPU2

					// switch away from X
					LOCK rq(1)->lock
					smp_mb__after_spinlock
					dequeue_task(X)
					  X->on_rq = 9
					switch_to(Z)
					  X->on_cpu = 0
					UNLOCK rq(1)->lock

									// migrate X to cpu 0
									LOCK rq(1)->lock
									dequeue_task(X)
									set_task_cpu(X, 0)
									  X->cpu = 0
									UNLOCK rq(1)->lock

									LOCK rq(0)->lock
									enqueue_task(X)
									  X->on_rq = 1
									UNLOCK rq(0)->lock

	// switch to X
	LOCK rq(0)->lock
	smp_mb__after_spinlock
	switch_to(X)
	  X->on_cpu = 1
	UNLOCK rq(0)->lock

	// X goes sleep
	X->state = TASK_UNINTERRUPTIBLE
	smp_mb();			// wake X
					ttwu()
					  LOCK X->pi_lock
					  smp_mb__after_spinlock

					  if (p->state)

					  cpu = X->cpu; // =? 1

					  smp_rmb()

	// X calls schedule()
	LOCK rq(0)->lock
	smp_mb__after_spinlock
	dequeue_task(X)
	  X->on_rq = 0

					  if (p->on_rq)

					  smp_rmb();

					  if (p->on_cpu && ttwu_queue_wakelist(..)) [*]

					  smp_cond_load_acquire(&p->on_cpu, !VAL)

					  cpu = select_task_rq(X, X->wake_cpu, ...)
					  if (X->cpu != cpu)
	switch_to(Y)
	  X->on_cpu = 0
	UNLOCK rq(0)->lock

However I'm having trouble convincing myself that's actually possible
on x86_64 -- after all, every LOCK implies an smp_mb() there, so if ttwu
observes ->state != RUNNING, it must also observe ->cpu != 1.

(Most of the previous ttwu() races were found on very large PowerPC)

Nevertheless, this fully explains the observed failure case.

Fix it by ordering the task_cpu(p) load after the p->on_cpu load,
which is easy since nothing actually uses @cpu before this.

Fixes: c6e7bd7afaeb ("sched/core: Optimize ttwu() spinning on p->on_cpu")
Reported-by: Paul E. McKenney <paulmck@kernel.org>
Tested-by: Paul E. McKenney <paulmck@kernel.org>
Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
Signed-off-by: Ingo Molnar <mingo@kernel.org>
Link: https://lkml.kernel.org/r/20200622125649.GC576871@hirez.programming.kicks-ass.net

---
## [elginsk8r/android_kernel_oneplus_sm4350](https://github.com/elginsk8r/android_kernel_oneplus_sm4350)@[2f23eb512f...](https://github.com/elginsk8r/android_kernel_oneplus_sm4350/commit/2f23eb512f899c9dbebe522e138176db3c4f4d69)
#### Saturday 2022-03-05 12:49:58 by alk3pInjection

disp: msm: Handle dim for udfps

* Apparently, los fod impl is better than udfps cuz it
  has onShow/HideFodView hook, which allows us to toggle
  dimlayer seamlessly.

  Since udfps only partially supports the former one,
  we'd better kill dim in kernel. This is kinda a hack
  but it works well, bringing perfect fod experience
  back to us.

Co-authored-by: Art_Chen <Chenxy0201@qq.com>
Signed-off-by: alk3pInjection <webmaster@raspii.tech>
Change-Id: I80bfd508dacac5db89f4fff0283529c256fb30ce

---
## [lllgts/android_kernel_xiaomi_polaris](https://github.com/lllgts/android_kernel_xiaomi_polaris)@[2030c31e78...](https://github.com/lllgts/android_kernel_xiaomi_polaris/commit/2030c31e78a95d0af48d6839811ddb0bffe558e5)
#### Saturday 2022-03-05 13:22:37 by Dave Chiluk

[BACKPORT v4.9.y 1/2] sched/fair: Fix low cpu usage with high throttling by removing expiration of cpu-local slices

[ Upstream commit de53fd7aedb100f03e5d2231cfce0e4993282425 ]

It has been observed, that highly-threaded, non-cpu-bound applications
running under cpu.cfs_quota_us constraints can hit a high percentage of
periods throttled while simultaneously not consuming the allocated
amount of quota. This use case is typical of user-interactive non-cpu
bound applications, such as those running in kubernetes or mesos when
run on multiple cpu cores.

This has been root caused to cpu-local run queue being allocated per cpu
bandwidth slices, and then not fully using that slice within the period.
At which point the slice and quota expires. This expiration of unused
slice results in applications not being able to utilize the quota for
which they are allocated.

The non-expiration of per-cpu slices was recently fixed by
'commit 512ac999d275 ("sched/fair: Fix bandwidth timer clock drift
condition")'. Prior to that it appears that this had been broken since
at least 'commit 51f2176d74ac ("sched/fair: Fix unlocked reads of some
cfs_b->quota/period")' which was introduced in v3.16-rc1 in 2014. That
added the following conditional which resulted in slices never being
expired.

if (cfs_rq->runtime_expires != cfs_b->runtime_expires) {
	/* extend local deadline, drift is bounded above by 2 ticks */
	cfs_rq->runtime_expires += TICK_NSEC;

Because this was broken for nearly 5 years, and has recently been fixed
and is now being noticed by many users running kubernetes
(https://github.com/kubernetes/kubernetes/issues/67577) it is my opinion
that the mechanisms around expiring runtime should be removed
altogether.

This allows quota already allocated to per-cpu run-queues to live longer
than the period boundary. This allows threads on runqueues that do not
use much CPU to continue to use their remaining slice over a longer
period of time than cpu.cfs_period_us. However, this helps prevent the
above condition of hitting throttling while also not fully utilizing
your cpu quota.

This theoretically allows a machine to use slightly more than its
allotted quota in some periods. This overflow would be bounded by the
remaining quota left on each per-cpu runqueueu. This is typically no
more than min_cfs_rq_runtime=1ms per cpu. For CPU bound tasks this will
change nothing, as they should theoretically fully utilize all of their
quota in each period. For user-interactive tasks as described above this
provides a much better user/application experience as their cpu
utilization will more closely match the amount they requested when they
hit throttling. This means that cpu limits no longer strictly apply per
period for non-cpu bound applications, but that they are still accurate
over longer timeframes.

This greatly improves performance of high-thread-count, non-cpu bound
applications with low cfs_quota_us allocation on high-core-count
machines. In the case of an artificial testcase (10ms/100ms of quota on
80 CPU machine), this commit resulted in almost 30x performance
improvement, while still maintaining correct cpu quota restrictions.
That testcase is available at https://github.com/indeedeng/fibtest.

Fixes: 512ac999d275 ("sched/fair: Fix bandwidth timer clock drift condition")
Signed-off-by: Dave Chiluk <chiluk+linux@indeed.com>
Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
Reviewed-by: Phil Auld <pauld@redhat.com>
Reviewed-by: Ben Segall <bsegall@google.com>
Cc: Ingo Molnar <mingo@redhat.com>
Cc: John Hammond <jhammond@indeed.com>
Cc: Jonathan Corbet <corbet@lwn.net>
Cc: Kyle Anderson <kwa@yelp.com>
Cc: Gabriel Munos <gmunoz@netflix.com>
Cc: Peter Oskolkov <posk@posk.io>
Cc: Cong Wang <xiyou.wangcong@gmail.com>
Cc: Brendan Gregg <bgregg@netflix.com>
Link: https://lkml.kernel.org/r/1563900266-19734-2-git-send-email-chiluk+linux@indeed.com
(cherry picked from commit 25d2df31fd426f34c18227c2cfe2d5e6d14a34fc)
Signed-off-by: Rapherion Rollerscaperers <rapherion@raphielgang.org>

---
## [LumberKing/Tianxia](https://github.com/LumberKing/Tianxia)@[e806229921...](https://github.com/LumberKing/Tianxia/commit/e806229921701824d10fe911dc4d784ea52ccd04)
#### Saturday 2022-03-05 14:45:31 by Silversweeper

Balance/optimization/polishing (part 9 of ???) + Fujiwara improvements (5 of ???)

General:
- Told the AI it can't transfer the PR under another vassal as it apparently was clever enough to come up with that.
- The FDaTK pretender emperors now work the same as normal pretender emperors in various respects.
- Hopefully fixed some insane prestige losses for the Tenno.

Bloodlines:
- Some NANDs that should have been NOTs are now NOTs.
- Added JD Chinese character spawning (with JD) to relevant bloodlines; actual spawning events TODO.
- Removed the Ancestor Veneration bloodlines tied to Jewish sympathy for Tianxia pagans; most of the functionality didn't work, and they were set to only be active if Christian.
- Added Divine Ancestry bloodlines for all currently existing reformed pagan religions. Localization TODO.

Casus Belli:
- Religious Liberation is now also blocked if your top liege would be disallowed due to their government.

Disease:
- Increased the outbreak chance of various diseases by 50 %, seeing as we've got roughly 50 % more land provinces than vanilla. Might need further tweaking.
- Updated several patterns to account for geographical region changes not previously accounted for.

Governments:
- Chinese, Eastern, Japanese, and Divine Imperial now have an inherent +10 vassal opinion to balance out the -10 vassal opinion they suffer from being locked into Imperial Administration.
- Unreformed and Reformed B√∂n now gives you Monastic Feudal regardless of culture, which should make the religion a bit more interesting with unconventional cultures.
- Bamar culture no longer unlocks Monatic Feudal for Buddhists, seeing as that goverment isn't a great fit for Bagan/etc.
- The Confucian and Japanese Bureaucracy goverments no longer have cities as preferred holdings (they are still allowed to hold them without penalties) to hopefully keep the AI from doing some stupid things.

Landed titles:
- The non-dynastic name for e_jade_gate (Xi-Xia) is now "The Great State of White and Lofty" for Tanguts.

Mercenaries:
- The Shenwu Guard is now set to not grow with time.
- The Shenwu Guard now has 1000 men; it was roughly that large by the An-Shi Rebellion.
- The Shence Guard now starts with 10k men; it reached 150k historically, but that's a truly insane number.

Modifiers:
- A forced actual regency now lowers defensive plot power, plot discovery chance, and arrest chance. Yes, this means it's an excellent chance to literally stab the Tenno/etc. in the back if he has been getting uppity.
- The MoH now impacts defensive plot power, plot discovery chance, and arrest chance if it's not at Average, being higher with higher MoH and lower with lower. Intersting times should therefore be a bit more interesting.

Nicknames:
- The "Ichi no Hito" nickname can now be earned by Yamato/Japanese/Wako Permanent Regents if they are fully empowered, Proud, and belong to a Regency bloodline, though it's unlikely to be earned.

Objectives:
- Further lowered Confucian Bureaucracy Independence faction willingness against someone with a positive MoH.
- Grand Chancellor bloodline members can now fabricate claims on Chinese Imperial empires if their liege's MoH is Average or lower.
- Grand Chancellor bloodline members are now more likely to try to fabricate clams on Chinese Imperial empires.

Religions:
- Overhauled the Shinto god name list and the Shinto evil god name list. Might give it a second look later to remove some imported gods.

Religion features:
- Added a new Reincarnation Doctrine, unlocking the Reincarnation events. Might expand a bit in the future since it currently is pretty weak.
- Updated AI weights for assorted Doctrines.
- The Religious Tax Doctrine is now incompatible with the Tolerant and Cosmopolitan Natures; treated the latter as a vanilla bug because it's rather nonsensical.
- Tolerant Nature no longer blocks Monastic.
- Spiritual Leadership no longer allows Great Holy Wars, seeing as the idea is that the head effectively ignores all temporal matters other than venerating ancestors.

Scripted triggers/etc.:
- Chinese culture group members of the WotRS (should they exist) now qualify for the Chinese martial headgear.

Societies:
- People with a Hwarang bloodline (the three royal Silla bloodlines or the refounding bloodline) now have a higher society membership score and gain some monthly society currency.
- People with Shogunate, Japanese Feudal, Warrior Bands, or Duelist bloddlines, or the Very Best bloodline now get extra society membership score and monthly society currency in the WotRS.
- Patrilineal Shinto descendants of Emperor Jimmu now gain extra society membership score and monthly society currency in the Fellowship of the Kami.
- Amaterasu Descendants now gain slightly less society membership score and monthly society currency in the Fellowship of the Kami, considering many people with this trait also are patrilineal descendants of Emperor Jimmu.

Succession voting:
- Fixed vanilla stupidity related to the holder of the "Despot" title/possessors of BitP "not judging [themself]" based on the title/trait. If you are a fancy candidate, why wouldn't you think you are a fancy candidate?
- Classified vanilla's decision to not have Saoshyant Descendants "judge" themselves more suitable for election based on the trait as a bug and fixed it, considering they judge others on it and thus could tiebreak in favour of someone else because "They're a Saoshyant Descendant!".
- Capped the number of "electors" for the Tenno's special succession law (and the knockoff) to 100, with certain things increasing the likelihood of being picked (being the PR, being a close relative, dynasty, tier, etc.).
- Incorporated Divine Ancestry bloodlines into various voting logic.

Decisions:
- Conclave and Horse Lords dynamic mercs can no longer be created by rulers with a bureaucratic (any flavour) top liege. It'd have been very frowned upon to hire out troops you were effectively borrowing from the central government.
- Updated some conversion decisions to properly consider some special governments.
- Added a decision to end a Permanent Regency if there is no landed Permanent Regent in the realm (and you're not currently waging war against them), to deal with some possible edge cases.

Events:
- Optimized MoH events a bit.
- Several MoH events should no longer fire for random rulers.
- The EoC no longer receives a bunch of free JD artefacts.
- Taoists now have a slightly harder time converting Confucian provinces, and vice versa.
- The repeating event handling setting up proper Permanent Regents should now also force them back under the proper liege if relevant. You thought you were so clever...
- The Permanent Regent should once more auto-create the Regency Loyalists whenever they gain the Regent minor title, and their AI dynasty members should auto-join the faction if appropriate.
- Improved Shinto/Japonic Buddhist pilgrimage event logic a bit.
- Members of the Imperial Family can no longer go on a pilgrimage to the Chrysanthemum Throne, seeing as there are some possible edge cases there.
- Pilgrims trying to reach Mount Fuji, Shikoku, or Mount Koya should now end up there.
- Being kind to a suicidal pilgrim is now potentially more rewarding.
- Pilgrimages to Shikoku should now be less spammy.
- Lustful AI pilgrims at Mount Koya should no longer go Celibate.
- Pilgrims visiting the Chrysanthemum Throne are no longer guaranteed the chance to ask for an audience with the Tenno unless they are the Sessho/Kampaku.
- Pilgrims visiting Ise are now less likely to get to meet the Saio unless they are a friend, lover, or close relative of the Saio.
- Removed the ability for pagans to get Jewish sympathy Ancestor Veneration bloodlines; they had effectively no functionality since pagans don't get Jewish loans or the ability to expel the Jews AND the bloodline required Christian religion to be active.
- Removed the "only_men = yes" restriction on reincarnation events; it was vanilla stupidity not accounting for stuff like Equality!
- HFP.20004 should no longer fire for homosexual characters, seeing as it makes no sense for them.
- Eunuchs without children should no longer have to deal with people suspecting them of impotence, seeing as it's pretty clear why they're not having any children and anyone attracted to them knows enough to get an attraction penalty.
- Cleaned up the disabled Indonesian events that haven't been active for several versions.
- Adjusted RIP physician spawns slightly to work better with Tianxia.
- If JD is installed people in China might get a JD Chinese physician when searching for a physician.
- Adjusted some geographical region-dependent stuff, such as the White [Animal].
- Improved Hanami logic in various places.
- It is no longer possible to get the Gardener trait during the Hanami preparations, to avoid the trait being unreasonably widespread in Japan.
- Certain decisions during the Hanami preparations now impact traits.
- Lowered the likelihood of getting no flavour event during the different stages of the Hanami.
- Lowered the likelihood of a troublesome or impressive Shirabyoshi showing up a bit (since it spawns a character), but made them more interesting if they show up.
- Women that are in the WotRS can now end up fighting against Shirabyoshi when attending someone's Hanami.
- Women are no longer restricted from fighting against Shirabyoshi if their liege has SoW 4, in addition to the previously existing permission at SoW 3.
- Shirabyoshi duels now actually look at the Shirabyoshi's PCS, rather than looking at the host's PCS.
- Chuseok religious conversion should no longer be broken.
- Cleaned up some less good Hanami events.
- Women may now also get involved in sword practice at the Hanami with SoW 3/4 or WotRS membership.
- Celibacy/Chastity is now checked and handled correctly at the Hanami.
- Hanami fireworks are now less likely to be a bad idea, though things can still go horribly wrong.

History:
- Emperor Daigo no longer has a Permanent Regency when he shouldn't have one. He's of course not alive during any playable date, but...
- Gung Ye is now scripted as a bastard.
- Spread Confucianism a bit more.
- More Fujiwara work.
- Fixed a bad id resulting in characters being generated with pretty high ids.
- Fixes to Yasovarman I, "the Leper King".
- Fixed vanilla stupidity related to d_amalfi having no de jure liege when it is scripted with a holder. All duchies go in a kingdom, vanilla devs; you should know this already!
- Certain historically disinherited characters now also have the Bastard trait to hopefully keep their descendants out of the line of succession.
- Replaced the religion of a number of previously Melanesian characters/provinces with other religions (Hindu, Buddhist, or Kaharingan). More work TODO.
- Thanbula is no longer scripted as pregnant, consistent with assorted other historical characters.
- Historical PRs (for both the Tenno and the Shogun) are now scripted with ai_flag_never_transfer when they are the PR.

Localization:
- Fixed several instances of the game being "literally unplayable".
- General polishing in various places.
- Rulers with polygamy should no longer get confused as to which wife is pestering them about appointing her "special friend" as a councillor.
- The Tanist minor title is now localized more appropriate if you are not Celtic but use Tanistry or a law based on it.
- A Buddhist temple barony is now known as a "Temple" rather than a "Vihara" for most cultures (Indo-Aryan, Dravidian, non-Viet Mon-Khmer, Tai-Kadai, and Malayo-Polynesian cultures excluded).
- Cleaned up some unused localization.
- Restructured some files a bit.

Map:
- Moved Taiwan out of the China region; aside from Penghu, China didn't control anything in the region during the era, and it had undesirable mechanical implications in various places.

Portraits:
- Buddhist members of the Fellowship of the Kami now use the society clothes worn by members of the regular Buddhist MO under the same conditions as someone in the regular Buddhist MO would.

---
## [ViktorWalter/youtube-playlist-sync-mp3](https://github.com/ViktorWalter/youtube-playlist-sync-mp3)@[27df010b3b...](https://github.com/ViktorWalter/youtube-playlist-sync-mp3/commit/27df010b3b81d42b82aaf083ca733d422dc9c762)
#### Saturday 2022-03-05 14:52:50 by Viktor Walter

Adding the --cookie option to allow for downloading 'age-restricted' videos by identifying myself with cookie file. Also, fuck youtube and everywhone creating pressure for this to be necessary. Bwecause browsing anonymously is no longer fashionable it seems.

---
## [cacogen/tgstation](https://github.com/cacogen/tgstation)@[eeb5465931...](https://github.com/cacogen/tgstation/commit/eeb546593148ce940e9adac2c663c453d6557247)
#### Saturday 2022-03-05 15:10:16 by vincentiusvin

Ordnance Content Update: Scientific Papers (#62284)

How do I play/test/operate this?

Download NT Frontier on any modular computers. It should debrief you on what experiments are available and how to publish.
If you want to do a bomb experiment, make sure it's captured by the doppler array (as usual) and then print the experiments into a disk and publish it.
If you want to do a gas experiment, make the gas and either pump it into a tank and 1) overpressurize it with a "clear" gas like N2 or 2) overpressurize tanks with the gas itself. Make sure you do the overpressurizing in the compressor machine. When tanks are destroyed/ejected leaked gas will get recorded. Print it into a disk and publish it.
For publication, the file needs to be directly present inside the computer's HDD. This means you need to copy it first with the file manager.
Fill the data (if desired, it will autofill with boiler plate if you dont) and send away!
Doing experiments unlock nodes, while doing them well unlocks boosts (which are discounts but slightly more restrictive) which are purchaseable with NT Frontier.
If you are testing this and have access to admin tools, there are various premade bombs under obj/effect/spawner/newbomb

A doc I wrote detailing the why and what part of this PR.
https://hackmd.io/JOakSYVMSh2zU2YL5ju_-Q

---

# Intro

## The Problem(s)

Ordnance, (previously toxins) seems to lack a lot of content and things to do. The gameplay loop consists of making a bomb and then sending it off for credits or using it to refine cores. Ordnance at it's inception originally relies on players experimenting and finding the perfect mix over multiple rounds, but once the recipe for a "do-everything" mix got out, the original charm of individual discoveries becomes meaningless.

Another issue with ordnance is the odd difficulty curve. As a new player, ordnance is almost impossible to decipher, but once you watch a tutorial or read a wiki and can mail a 50k into space, there pretty much isn't anything else to do. Most players will be satisfied at this point without the gameplay loop encouraging them to understand or play more. The only thing you can do afterwards is to sink your teeth in and understand why that particular mix explodes the way it does. This again has a significant difficulty curve, but if you do that, the department doesn't acknowledge or reward that in any way. There are pretty much two huge spikes, with the latter one not really existing inside the department.

TLDR:
* The content being same-y over rounds.
* Odd difficulty curve: 
    1. A new player is oblivious to everything. 
    2. Those in the middle can repeat the final goal consistently without needing to understanding why
    3. There is nothing to justify spending more time in the department after reaching the midgame.

## Abstract

Scientific Papers aim to add a framework to run multiple experiments in ordnance. Adding more experiments scattered across various atmospheric aspects might allow players of various knowledge levels to still have something engaging to do. A new player should have an easier challange than to mail a 50K. While those that already can make bombs should have an easier time understanding why their bombs explode the way it does. Once they fully understand why, they can set their sights on taking advantage of another reaction to set their bomb off or hone one particular reaction down.

## Goals

* Have some intro-level challanges for new players.
* Have some semblance of late-game challanges for more experienced players.
* Explain the mechanics better for those in the middle of the road.
* Incentivize trying new things out in the department.
* Better integrate Ordnance with Experisci

## Boundaries / Dont's

* Do not incentivize people to learn ordnance by using PvP loots.
* Do not shake or change the reaction system by a huge amount.
* Disincentivize having a single god-mix that does everything.
****

# Main design pillars

## A. Framework surrounding the experiments

### A.1. New experiments

Add new experiments to the ExperiSci module. These will come in two flavours: New explosions to do, and various gas synthesis experiments. Both of these are actually supported by the map layout of ordnance right now, but there is no reason to do anything outside of making a 50k as fast as possible.

### A.2. Rewards for experiments: Cash and Techweb Boosts.

Scientific papers will add a separate experiment handling system. A single experiment will be graded into various tiers, each tier corresponding to the explosion size or amount of gas made.  Doing any tier of a specific experiment will unlock the discount for that specific reactions. A single explosion **WILL NOT** do multiple experiments (or even tiers) at once.

On publication, a partner can be selected. A single partner only has a specific criteria of experiments they want. The experiments will then be graded on "how good they are done", with the criteria being more punishing as tier increases. Publication will then reward scientific cooperation with the partnered partner. Players can spend this cooperation on techweb boosts. Techweb boosts are meant to be subservient to discount from experiments and will not shave a node's price to be lower than 500 points.

**Experiments will only unlock nodes, discounts are handled through this boost system.**
This is more for maintainability than anything.

### A.3. On Tedium

*This is a note on implementation more than anything, but I think this helps explains why several things are done.*

Due to the nature of atmospheric reactions in the game (they're all linear), tedium is a very important thing to consider. An experiment should have a sweet spot to aim for, but there should not be a point where further mastery is stopped dead on it's track with a reward cap.

Scientific Papers attempts to discourage this behaviour by having the "maximum score" scale off to infinity but with the rewards being smaller and smaller. The sweet spot is always there to aim for and should be well communicated with players, but on their last submission of an experiment topic players should be encouraged to do their best. There should always be a reward for pushing the system to it's limit as long as it doesn't completely nullify the other subdepartments. This is the reason why there is a hard limit on the number of publications and why the score calculation is a bit more complex than it needed to be.

## B. Gas Synthesis (Early-Mid Game)

Scientific papers will add one new machine that requests a tank to release x amounts of y gas. This will be accomplished by adding a tank pumping machine which will either burst or explode a tank, releasing the gas inside. The gas currently requested are BZ, Nitryl, Halon and Nob.

The overarching goal of this compressor machine is to present a gas synthesis challange for the players and to get them more accustomed to how a tank explodes. The gas synthesis part can always be changed in order to reflect the current state of atmospheric reactions.

## C. Explosion Changes (Mid-Late Game)

### C.1 Cause and effect.

The main theme of the explosion changes is establishing cause and effect of explosions. Reactions that happens inside a tank that's going to explode will be recorded and forwarded to a doppler array. Some experiments will require only a single cause to be present (think of it as isolating a variable). This is currently implemented for nobliumformation and pressure based bombs. Having other reactions occuring besides noblium formation will fail the first one, while having any reactions at all will fail the second one. 

Adding more explosions here will be a slight challange because as of now the game has only two reactions that can reliably make an explosion.

### C.2 Tools upgrade.

Doppler array has now been retrofitted to state the probable cause of an explosion, be it reactions or just overpressurization on gas merging. These should help intermediate players figure out what is causing an explosion.

Added a new functionality to the implosion compressor:
Basically performs the gas merging and reaction that TTV does in a machine and reports the results back as if someone uses an analyzer on them. Here to give players feedback so they can try and understand what is actually going on in a bomb.

## D. Player Interaction

There should be more room for more than 1 player to play ordnance simultaneously. Previously players are also able to split tasks, but this rarely happens because tritium synthesis needs only the gas chamber to be reconfigured. Now, different players can pick different experiments and work on them. Players can also do joint tasks on one single experiment. Gases like noblium will need tritium production and also a cooling module online.

Ordnance can also coordinate with their parent department on what they really need, be it money or research bonuses.

# Potential Changes

The best-case changes that can be implemented if the current roster of content isn't enough is more reactions that can be used in bombs. Eliminating bombs entirely goes against the spirit of the subdepartment, while adding new ones will need a lot of care and consideration.

Another possible change is to implement a "gas payload" bomb. Bombs that has a set number of unreacting gas inside that will increase the heat capacity, reduce the payload, and neccesitates more bespoke mixes.

Adding more gas synthesis experiments is discouraged. The main focus of ordnance should be bombs, with gas synthesis being a side project for ordnance. These are present to ease the introduction to bombs and provide some side content. 
There should be a somewhat well-justified goal in adding new synthesis experiments: e.g. BZ is there as a "tutorial" gas, Nitryl to introduce players to cooling/heating mixes, Halon to a more efficient tritium production, and Nob as a nudge to nobformation bombs and mastery over other aspects.

# Conclusion / Summary

Add more experiments to ordnance that players can take, accomplish this by:
1. Making the players perform gas synthesis or make bombs.
2. Have them collect the data, see if it fits the criteria. Explain why if it fits and why if it doesn't.
3. Have the player publish a paper.

Reward them based on how well did they do, give players agency both on the experiment phase and also publication phase.


---
TLDR: Added new experiment to toxins, added the framework for those experiments existing. Experiments comes in gas synthesis and also bombs but with more parameters. Experiments needs to be published through papers, various choices to be made there.

Implementation notes:

Because of how paper works, ordnance experiments are handled outside of experiment_handler components. My reasoning for this is twofold:

The experiments will be completed manually on publication and if the experiment isn't unlocked yet it will still be completed.
Experiment handler datums have several procs which require an atom-level parent, and I figured this is the most sensible and cleanest way to implement this without changing the experiment handler datum too much.

Small change to /obj/machinery/proc/power_change() signal ordering to adjust the state first and then send the signal. Didn't found any other usage of this signal except mine but barge down my door if it broke something.

Rewrote the ttv merge_gases() code to be slightly more readable.
A small code improvement for thermomachine to use tofixed (my fault).

Ordnance have been updated to enable the publication of papers
Several new explosive and gas synthesis experiments have been added to ordnance
Anomaly compressor has been TGUIzed and now supports simulating the reaction of the gases inside the ttv.
New tank compressor machine for toxins. You can overpressurize tanks with exotic gases and complete experiments.
Several techweb nodes are locked and require toxin experiments to complete.
Toxins can purchase boosts for various techweb nodes.
You no longer need to anchor doppler arrays for it to work.
Doppler array and implosion compressor now supports deconstruction, implosion compressor construction added.
Doppler now emits a red light to denote it's direction and it being on. Doppler not malf.
Implosion compressor renamed to anomaly refinery.
Created a new program tab "Science" for the downloader app. Removed Robotics.
Reworked the code for bombspawner (used in the cuban pete arcade game)

---
## [safwan6363/my-files](https://github.com/safwan6363/my-files)@[4faee24d13...](https://github.com/safwan6363/my-files/commit/4faee24d138ec4eba275c891897f5ce659d20be4)
#### Saturday 2022-03-05 15:33:39 by safwan6363

holy shit a new commit!!!!

man this repo has died i don't make changes to my dot files anymore as i
used to. everything sucks. did my interest in them just died out or
something

---
## [FTC-16360-RC/FTC-16360-2022](https://github.com/FTC-16360-RC/FTC-16360-2022)@[5ce49f70b1...](https://github.com/FTC-16360-RC/FTC-16360-2022/commit/5ce49f70b10d17407a843c005d13ef43c27cbcb5)
#### Saturday 2022-03-05 15:39:56 by FTC-16360-RC

790 -> 800

It's not time to make a change
Just relax, take it easy
You're still young, that's your fault
There's so much you have to know
Find a girl, settle down
If you want you can marry
Look at me, I am old, but I'm happy
I was once like you are now
And I know that it's not easy
To be calm when you've found
Something going on
But take your time, think a lot
Think of everything you've got
For you will still be here tomorrow
But your dreams may not
How can I try to explain?
When I do he turns away again
It's always been the same, same old story
From the moment I could talk
I was ordered to listen
Now there's a way
And I know that I have to go away
I know I have to go
It's not time to make a change
Just relax, take it slowly
You're still young, that's your fault
There's so much you have to go through
Find a girl, settle down
If you want you can marry
Look at me, I am old, but I'm happy
All the times that I've cried
Keeping all the things I knew inside
It's hard, but it's harder to ignore it
If they were right I'd agree
But it's them they know, not me
Now there's a way
And I know that I have to go away
I know I have to go

---
## [leuhvraiminoryo/mechanics](https://github.com/leuhvraiminoryo/mechanics)@[b66883f945...](https://github.com/leuhvraiminoryo/mechanics/commit/b66883f9452c5941a4efdf5c5b18787762f9f06c)
#### Saturday 2022-03-05 15:55:23 by leuhvraiminoryo

draw current room

to whomever may be reading this : go fuck yourself with a banana.

---
## [mawrick26/SM8250](https://github.com/mawrick26/SM8250)@[80d77a15d3...](https://github.com/mawrick26/SM8250/commit/80d77a15d3c166dc6f012c0cfd07df6d215c91a7)
#### Saturday 2022-03-05 16:26:28 by George Spelvin

lib/sort: make swap functions more generic

Patch series "lib/sort & lib/list_sort: faster and smaller", v2.

Because CONFIG_RETPOLINE has made indirect calls much more expensive, I
thought I'd try to reduce the number made by the library sort functions.

The first three patches apply to lib/sort.c.

Patch #1 is a simple optimization.  The built-in swap has special cases
for aligned 4- and 8-byte objects.  But those are almost never used;
most calls to sort() work on larger structures, which fall back to the
byte-at-a-time loop.  This generalizes them to aligned *multiples* of 4
and 8 bytes.  (If nothing else, it saves an awful lot of energy by not
thrashing the store buffers as much.)

Patch #2 grabs a juicy piece of low-hanging fruit.  I agree that nice
simple solid heapsort is preferable to more complex algorithms (sorry,
Andrey), but it's possible to implement heapsort with far fewer
comparisons (50% asymptotically, 25-40% reduction for realistic sizes)
than the way it's been done up to now.  And with some care, the code
ends up smaller, as well.  This is the "big win" patch.

Patch #3 adds the same sort of indirect call bypass that has been added
to the net code of late.  The great majority of the callers use the
builtin swap functions, so replace the indirect call to sort_func with a
(highly preditable) series of if() statements.  Rather surprisingly,
this decreased code size, as the swap functions were inlined and their
prologue & epilogue code eliminated.

lib/list_sort.c is a bit trickier, as merge sort is already close to
optimal, and we don't want to introduce triumphs of theory over
practicality like the Ford-Johnson merge-insertion sort.

Patch #4, without changing the algorithm, chops 32% off the code size
and removes the part[MAX_LIST_LENGTH+1] pointer array (and the
corresponding upper limit on efficiently sortable input size).

Patch #5 improves the algorithm.  The previous code is already optimal
for power-of-two (or slightly smaller) size inputs, but when the input
size is just over a power of 2, there's a very unbalanced final merge.

There are, in the literature, several algorithms which solve this, but
they all depend on the "breadth-first" merge order which was replaced by
commit 835cc0c8477f with a more cache-friendly "depth-first" order.
Some hard thinking came up with a depth-first algorithm which defers
merges as little as possible while avoiding bad merges.  This saves
0.2*n compares, averaged over all sizes.

The code size increase is minimal (64 bytes on x86-64, reducing the net
savings to 26%), but the comments expanded significantly to document the
clever algorithm.

TESTING NOTES: I have some ugly user-space benchmarking code which I
used for testing before moving this code into the kernel.  Shout if you
want a copy.

I'm running this code right now, with CONFIG_TEST_SORT and
CONFIG_TEST_LIST_SORT, but I confess I haven't rebooted since the last
round of minor edits to quell checkpatch.  I figure there will be at
least one round of comments and final testing.

This patch (of 5):

Rather than having special-case swap functions for 4- and 8-byte
objects, special-case aligned multiples of 4 or 8 bytes.  This speeds up
most users of sort() by avoiding fallback to the byte copy loop.

Despite what ca96ab859ab4 ("lib/sort: Add 64 bit swap function") claims,
very few users of sort() sort pointers (or pointer-sized objects); most
sort structures containing at least two words.  (E.g.
drivers/acpi/fan.c:acpi_fan_get_fps() sorts an array of 40-byte struct
acpi_fan_fps.)

The functions also got renamed to reflect the fact that they support
multiple words.  In the great tradition of bikeshedding, the names were
by far the most contentious issue during review of this patch series.

x86-64 code size 872 -> 886 bytes (+14)

With feedback from Andy Shevchenko, Rasmus Villemoes and Geert
Uytterhoeven.

Link: http://lkml.kernel.org/r/f24f932df3a7fa1973c1084154f1cea596bcf341.1552704200.git.lkml@sdf.org
Signed-off-by: George Spelvin <lkml@sdf.org>
Acked-by: Andrey Abramov <st5pub@yandex.ru>
Acked-by: Rasmus Villemoes <linux@rasmusvillemoes.dk>
Reviewed-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Cc: Rasmus Villemoes <linux@rasmusvillemoes.dk>
Cc: Geert Uytterhoeven <geert@linux-m68k.org>
Cc: Daniel Wagner <daniel.wagner@siemens.com>
Cc: Don Mullis <don.mullis@gmail.com>
Cc: Dave Chinner <dchinner@redhat.com>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

---
## [jackmurray/broodminderexporter](https://github.com/jackmurray/broodminderexporter)@[a4e578a1f9...](https://github.com/jackmurray/broodminderexporter/commit/a4e578a1f948347a5b938de4c0539fb250149785)
#### Saturday 2022-03-05 17:00:37 by Jack Murray

add retarded intent filter to handle db3 files. a big fuck you to whatever engineer at Google wrote the pathPattern matching code

---
## [crawl/crawl](https://github.com/crawl/crawl)@[e8bc28a0cf...](https://github.com/crawl/crawl/commit/e8bc28a0cf5eb223156f893c8f47b1284931e78a)
#### Saturday 2022-03-05 18:07:02 by DreamDust

vaults: float vaults by DreamDust

dreamdust_dug_too_deep

The dwarves dug a little too deep and unearthed... a Balrug! Even a
mighty dwarf hero (with a potentially good weapon to loot!) fell in
battle to the demon. RIP. Maybe this is why we don't see deep dwarves
much anymore. Hmmmm...

The idea behind this vault is to place a single Balrug early enough that
it's a serious (but not unmanageable) threat. I added a downhatch close
by if players need to escape in a hurry. There are also warning signs in
advance (all the dwarf corpses and the suspicious volcanic floor tiles
outside the Balrug room).

[ Committer's note: Added a runed door for the balrug, adjusted
  transparency, traded volcanic floor for blood. ]

dreamdust_wu_jian_sword_trials

A Wu Jian-themed vault. Challenge three increasingly powerful
sword-wielders for their increasingly good swords.

[ Committer's note: Adjusted depth range, added monsters to the earlier
  trial, trimmed arenas, added transperency. ]

dreamdust_merry_men

Inspired by Robin Hood and his band of merry men. Features a forest with
a bunch of archers and a good bow and aides to banditry to loot in the center.

[ Committer's note: Adjusted layout to prevent teleport closets, monster
  counts, loot. ]

dreamdust_tengu_aerie

A large nest of tengus. They keep their shiny loot in the center...
along with their fledglings (wait, are we the baddies??).

[ Committer's note: moved the crystal walls to the middle, put the
  rock wall on the outside (so the reavers can bolt bounce their
  omnibolts), and thinned the monster density. ]

dreamdust_hydra_shepherd

A shepherd is raising a flock (?) of hydras down in the Depths! Some
players might regret abandoning their flaming weapons after finishing
Lair/Swamp, haha.

[ Committer's note: upgraded the cyclops to a stone giant, added a small
  chance for a really high head count. ]

dreamdust_elfheim

The home of Duvessa and Dowan.
The more-practical Duvessa has training dummies in her room, while the
vain Dowan has a large mirror to admire himself with.

[ Committer's note: cut down on custom tiling/colouring a bit. ]

---
## [crawl/crawl](https://github.com/crawl/crawl)@[eff9672185...](https://github.com/crawl/crawl/commit/eff9672185ce907904dc1b8db564e1bedcbf3977)
#### Saturday 2022-03-05 18:07:03 by Nicholas Feinberg

Improve characters' starting kits (Hellmonk)

One of the most interesting and exciting decisions in Dungeon Crawl
is when and where to use your consumable items. In the very early
game, characters may not yet have any consumables, which diminishes
the tactical aspect of the game.

So, let's try to give most characters some options which, if used
wisely, can help them with a tough situation.

- All 'mages' ('pure casters') start with a potion of magic.
- Gladiators get a throwing weapon; javelin, large rock or boomerangs.
- Monks get a potion of ambrosia. (See, it's divine.)
- Hunters get a scroll of immo.
- Brigands get an additional poisoned & curare dart.
- Artificers trade their xom piece for nine charges of iceblast.
- Wanderers get an additional random potion or scroll.
- Delvers get nothing, for now, since I'm already pretty happy with
  how they play. They're a challenge anyway, really. :)
- Berserkers and Cinder Acolytes likewise get nothing. They already
  have perfectly good early game buttons.
- Abyssal Knights start at 60 piety (just over 2*) instead of 38 (just
  over 1*). This should allow them to use Bend Space if needed.
  (I think they're still quite weak.)
- Chaos Knights get Artificer's xom chesspiece.
- Transmuters get a potion of lignification, which should work well
  with their unarmed combat focus. It's also very thematic.
- Warpers get more boomerangs of dispersal.
- Arkane Markspersons get a scroll of vulnerability.
- Enchanters get another potion of invisibility.
- Fighters are unchanged.

This should also be a nice compensation for various recent changes that
increased early game difficulty.

---
## [lynn/toadua](https://github.com/lynn/toadua)@[ab589699e7...](https://github.com/lynn/toadua/commit/ab589699e7d9a528b9cff2d24da83ebe35a16a4d)
#### Saturday 2022-03-05 18:13:53 by uakci

my god idk any more

* removed snyk, added webpack + babel + vue and a buncha scripts
* database migrated from messagepack to gzipped json
* restructured frontend/, added a library for both ends at shared/
* made entries auto-normalize themselves, finally, and painstakingly
  implemented this in the webapp
* fixed error handling / shutdown logic
* there might be other things but i can't remember at this point

---
## [imaami/linux](https://github.com/imaami/linux)@[6f3a0b2c26...](https://github.com/imaami/linux/commit/6f3a0b2c26bab9c4c10ab46d1ea78922231a0739)
#### Saturday 2022-03-05 19:09:27 by Daniel Borkmann

mm: Consider __GFP_NOWARN flag for oversized kvmalloc() calls

commit 0708a0afe291bdfe1386d74d5ec1f0c27e8b9168 upstream.

syzkaller was recently triggering an oversized kvmalloc() warning via
xdp_umem_create().

The triggered warning was added back in 7661809d493b ("mm: don't allow
oversized kvmalloc() calls"). The rationale for the warning for huge
kvmalloc sizes was as a reaction to a security bug where the size was
more than UINT_MAX but not everything was prepared to handle unsigned
long sizes.

Anyway, the AF_XDP related call trace from this syzkaller report was:

  kvmalloc include/linux/mm.h:806 [inline]
  kvmalloc_array include/linux/mm.h:824 [inline]
  kvcalloc include/linux/mm.h:829 [inline]
  xdp_umem_pin_pages net/xdp/xdp_umem.c:102 [inline]
  xdp_umem_reg net/xdp/xdp_umem.c:219 [inline]
  xdp_umem_create+0x6a5/0xf00 net/xdp/xdp_umem.c:252
  xsk_setsockopt+0x604/0x790 net/xdp/xsk.c:1068
  __sys_setsockopt+0x1fd/0x4e0 net/socket.c:2176
  __do_sys_setsockopt net/socket.c:2187 [inline]
  __se_sys_setsockopt net/socket.c:2184 [inline]
  __x64_sys_setsockopt+0xb5/0x150 net/socket.c:2184
  do_syscall_x64 arch/x86/entry/common.c:50 [inline]
  do_syscall_64+0x35/0xb0 arch/x86/entry/common.c:80
  entry_SYSCALL_64_after_hwframe+0x44/0xae

Bj√∂rn mentioned that requests for >2GB allocation can still be valid:

  The structure that is being allocated is the page-pinning accounting.
  AF_XDP has an internal limit of U32_MAX pages, which is *a lot*, but
  still fewer than what memcg allows (PAGE_COUNTER_MAX is a LONG_MAX/
  PAGE_SIZE on 64 bit systems). [...]

  I could just change from U32_MAX to INT_MAX, but as I stated earlier
  that has a hacky feeling to it. [...] From my perspective, the code
  isn't broken, with the memcg limits in consideration. [...]

Linus says:

  [...] Pretty much every time this has come up, the kernel warning has
  shown that yes, the code was broken and there really wasn't a reason
  for doing allocations that big.

  Of course, some people would be perfectly fine with the allocation
  failing, they just don't want the warning. I didn't want __GFP_NOWARN
  to shut it up originally because I wanted people to see all those
  cases, but these days I think we can just say "yeah, people can shut
  it up explicitly by saying 'go ahead and fail this allocation, don't
  warn about it'".

  So enough time has passed that by now I'd certainly be ok with [it].

Thus allow call-sites to silence such userspace triggered splats if the
allocation requests have __GFP_NOWARN. For xdp_umem_pin_pages()'s call
to kvcalloc() this is already the case, so nothing else needed there.

Fixes: 7661809d493b ("mm: don't allow oversized kvmalloc() calls")
Reported-by: syzbot+11421fbbff99b989670e@syzkaller.appspotmail.com
Suggested-by: Linus Torvalds <torvalds@linux-foundation.org>
Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
Tested-by: syzbot+11421fbbff99b989670e@syzkaller.appspotmail.com
Cc: Bj√∂rn T√∂pel <bjorn@kernel.org>
Cc: Magnus Karlsson <magnus.karlsson@intel.com>
Cc: Willy Tarreau <w@1wt.eu>
Cc: Andrew Morton <akpm@linux-foundation.org>
Cc: Alexei Starovoitov <ast@kernel.org>
Cc: Andrii Nakryiko <andrii@kernel.org>
Cc: Jakub Kicinski <kuba@kernel.org>
Cc: David S. Miller <davem@davemloft.net>
Link: https://lore.kernel.org/bpf/CAJ+HfNhyfsT5cS_U9EC213ducHs9k9zNxX9+abqC0kTrPbQ0gg@mail.gmail.com
Link: https://lore.kernel.org/bpf/20211201202905.b9892171e3f5b9a60f9da251@linux-foundation.org
Reviewed-by: Leon Romanovsky <leonro@nvidia.com>
Ackd-by: Michal Hocko <mhocko@suse.com>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

---
## [benesch/materialize](https://github.com/benesch/materialize)@[3af43e2538...](https://github.com/benesch/materialize/commit/3af43e25388609cb43b7ab352ffe03d34f89d552)
#### Saturday 2022-03-05 20:32:13 by Nikhil Benesch

coord: allow SELECTing from unmaterialized sources

This commit allows `SELECT` queries to depend, directly or indirectly,
on unmaterialized sources. This was previously disallowed because we
didn't track the `since` frontier of unmaterialized sources; now we do.

Users will no longer see errors like

    unable to automatically determine a query timestamp

which is a huge upgrade in the user experience, in my opinion. The
downside is that users are not careful, a one-off query may result in
e.g. re-reading an entire Kafka source from the upstream broker. If it
becomes a problem, we can consider introducing a "safe mode" (maybe via
a session variable) that disallows queries that would re-instantiate a
source.

This new behavior facilitates making tables unmaterialized by default
(#10883). That change goes down more easily if you can `SELECT` from an
unmaterialized table.

---
## [miloshIra/webStuff](https://github.com/miloshIra/webStuff)@[ef930e4155...](https://github.com/miloshIra/webStuff/commit/ef930e4155fda3c12ae64b741272573708ae57ca)
#### Saturday 2022-03-05 20:58:07 by miloshIra

Started the LunchIdea app,
# TODO 2: Work on weekly list of ideas and how to generate a shopping list from their ingredients.
# TODO 3: Make flask-mail work!
# TODO 4. Protect endpoints from not logged users.
# TODO 5. Enjoy life more.

Count works, get idea is a class method now, randomizing works, but I get a None value sometimes, because there is no num=0 in the database, spent hours picking a template picked one <3 ..

---
## [systemd/systemd-stable](https://github.com/systemd/systemd-stable)@[367041af81...](https://github.com/systemd/systemd-stable/commit/367041af816d48d4852140f98fd0ba78ed83f9e4)
#### Saturday 2022-03-05 21:03:36 by Lennart Poettering

pid1: set SYSTEMD_NSS_DYNAMIC_BYPASS=1 env var for dbus-daemon

There's currently a deadlock between PID 1 and dbus-daemon: in some
cases dbus-daemon will do NSS lookups (which are blocking) at the same
time PID 1 synchronously blocks on some call to dbus-daemon. Let's break
that by setting SYSTEMD_NSS_DYNAMIC_BYPASS=1 env var for dbus-daemon,
which will disable synchronously blocking varlink calls from nss-systemd
to PID 1.

In the long run we should fix this differently: remove all synchronous
calls to dbus-daemon from PID 1. This is not trivial however: so far we
had the rule that synchronous calls from PID 1 to the dbus broker are OK
as long as they only go to interfaces implemented by the broke itself
rather than services reachable through it. Given that the relationship
between PID 1 and dbus is kinda special anyway, this was considered
acceptable for the sake of simplicity, since we quite often need
metadata about bus peers from the broker, and the asynchronous logic
would substantially complicate even the simplest method handlers.

This mostly reworks the existing code that sets SYSTEMD_NSS_BYPASS_BUS=
(which is a similar hack to deal with deadlocks between nss-systemd and
dbus-daemon itself) to set SYSTEMD_NSS_DYNAMIC_BYPASS=1 instead. No code
was checking SYSTEMD_NSS_BYPASS_BUS= anymore anyway, and it used to
solve a similar problem, hence it's an obvious piece of code to rework
like this.

Issue originally tracked down by Lukas M√§rdian. This patch is inspired
and closely based on his patch:

       https://github.com/systemd/systemd/pull/22038

Fixes: #15316
Co-authored-by: Lukas M√§rdian <slyon@ubuntu.com>
(cherry picked from commit de90700f36f2126528f7ce92df0b5b5d5e277558)

---
## [prairir/Buoy](https://github.com/prairir/Buoy)@[17303fa530...](https://github.com/prairir/Buoy/commit/17303fa53019c7f33eade8584e50edaff0c9eda5)
#### Saturday 2022-03-05 21:48:24 by Ryan Prairie

Add: translation package base & (de)compression

translation package base is done. It has a translate and untranslate
function. It also has unexported functions of encrypt/decrypt and
compression/decompression.

I also changed config to have password as a byte slice. This way we can
save time by casting once on init instead of casting every packet(1/10
time).

I chose gzip as a compression algorithm because it uses deflate on the
background but is more agressive on its actual compression. We need to
save size on the larger boys, I dont care about wasting CPU cycles on
the smaller packets.

I want to avoid IP fragmentation whenever possible so Im realllllllllly
betting on gzip to take care of it. There is still the *strong* chance
that its not enough and we should embrace fragmentation. Fuck
fragmentation, its a nightmare to implement ourselves.

---
## [tgstation/event-winter-ball-2021](https://github.com/tgstation/event-winter-ball-2021)@[2b085ccc1d...](https://github.com/tgstation/event-winter-ball-2021/commit/2b085ccc1d7d0ffc74e6d05e45d72a9e8c2c0ea2)
#### Saturday 2022-03-05 23:18:57 by EOBGames

Some Last Minute Adjustments  (#14)

yuck! fuck you, wheat!

---

# [<](2022-03-04.md) 2022-03-05 [>](2022-03-06.md)

